!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";var a,r=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},s=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function o(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},a=[],r=0;r<e.length;r++){var s=e[r],l=t.base?s[0]+t.base:s[0],u=n[l]||0,h="".concat(l," ").concat(u);n[l]=u+1;var c=o(h),d={css:s[1],media:s[2],sourceMap:s[3]};-1!==c?(i[c].references++,i[c].updater(d)):i.push({identifier:h,updater:m(d,t),references:1}),a.push(h)}return a}function u(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var r=n.nc;r&&(a.nonce=r)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var i=s(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var h,c=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function d(e,t,n,a){var r=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,r);else{var s=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(s,i[t]):e.appendChild(s)}}function p(e,t,n){var a=n.css,r=n.media,s=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),s&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var f=null,v=0;function m(e,t){var n,a,r;if(t.singleton){var s=v++;n=f||(f=u(t)),a=d.bind(null,n,s,!1),r=d.bind(null,n,s,!0)}else n=u(t),a=p.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var r=o(n[a]);i[r].references--}for(var s=l(e,t),u=0;u<n.length;u++){var h=o(n[u]);0===i[h].references&&(i[h].updater(),i.splice(h,1))}n=s}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var r=(i=a,o=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(l," */")),s=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[n].concat(s).concat([r]).join("\n")}var i,o,l;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(a)for(var s=0;s<this.length;s++){var i=this[s][0];null!=i&&(r[i]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);a&&r[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},,function(e,t,n){const{VisPluginTableModel:a}=n(4),r=n(15),s={traditional:n(5),looker:n(7),contemporary:n(9),fixed:n(11),auto:n(13)},i=function(e,t,n){var a=null;(async function(){const e=document.getElementsByTagName("link");for(;e[0];)e[0].parentNode.removeChild(e[0]);Object.keys(s).forEach(async e=>await s[e].unuse())})().then(()=>{void 0!==e.customTheme&&e.customTheme&&"custom"===e.theme?function(e){const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t)}(e.customTheme):void 0!==s[e.theme]&&s[e.theme].use(),void 0!==s[e.layout]&&s[e.layout].use()});var i=r.select("#visContainer").append("table").attr("class","reportTable"),o=r.drag().on("start",(e,n)=>{if(!t.has_pivots){var a=parseFloat(r.event.x),s=parseFloat(r.event.y);r.select("#tooltip").style("left",a+"px").style("top",s+"px").html(),r.select("#tooltip").classed("hidden",!1)}}).on("drag",(e,n)=>{t.has_pivots||r.select("#tooltip").style("left",r.event.x+"px").style("top",r.event.y+"px")}).on("end",(e,s)=>{if(!t.has_pivots){r.select("#tooltip").classed("hidden",!0);var i=t.getColumnById(e.id),o=t.getColumnById(a.id),l=10*Math.floor(i.pos/10),u=10*Math.floor(o.pos/10);t.moveColumns(l,u,n)}});i.append("thead").selectAll("tr").data(t.getHeaderTiers()).enter().append("tr").selectAll("th").data((function(e,n){return t.getTableHeaders(n).map((function(a){var r={id:a.id,text:a.getLabel(n),align:a.modelField.align,colspan:t.colspan_values[a.id][e.name],type:a.modelField.type,calculation:a.modelField.is_table_calculation};return(t.useHeadings&&!t.has_pivots&&0===n||t.has_pivots&&n<t.pivots.length)&&(r.align="center",r.headerRow=!0),r}))})).enter().append("th").text(e=>e.text).attr("id",e=>e.id).attr("colspan",e=>e.colspan).attr("class",e=>{var t=["reportTable","headerCell"];return void 0!==e.align&&t.push(e.align),void 0!==e.type&&t.push(e.type),void 0!==e.calculation&&e.calculation&&t.push("calculation"),void 0!==e.headerRow&&e.headerRow&&t.push("headerRow"),t.join(" ")}).attr("draggable",!0).call(o).on("mouseover",e=>a=e).on("mouseout",()=>a=null),i.append("tbody").selectAll("tr").data(t.getDataRows()).enter().append("tr").selectAll("td").data((function(e){return t.getTableColumns(e).map(t=>{var n=e.data[t.id];return n.colid=t.id,n.rowid=e.id,n.rowspan=t.rowspan,n.align=t.modelField.align,n})})).enter().append("td").text(e=>"object"==typeof e.value?null:void 0!==e.html?(new DOMParser).parseFromString(e.html,"text/html").documentElement.textContent:void 0!==e.rendered?e.rendered:e.value).attr("rowspan",e=>e.rowspan).attr("class",e=>{var t=["reportTable","rowCell"];return"object"==typeof e.value&&t.push("cellSeries"),void 0!==e.align&&t.push(e.align),void 0!==e.cell_style&&(t=t.concat(e.cell_style)),t.join(" ")}).on("click",e=>{console.log("click d:",e),console.log("click event:",r.event),LookerCharts.Utils.openDrillMenu({links:e.links,event:r.event})})};looker.plugins.visualizations.add({options:a.getCoreConfigOptions(),create:function(e,t){this.tooltip=r.select(e).append("div").attr("class","hidden").attr("id","tooltip")},updateAsync:function(e,t,n,s,o,l){if(this.clearErrors(),s.fields.pivots.length>2)this.addError({title:"Max Two Pivots",message:"This visualization accepts no more than 2 pivot fields."});else{console.log("queryResponse",s),console.log("data",e);try{var u=document.querySelector("#visContainer");u.parentNode.removeChild(u)}catch(e){}this.container=r.select(t).append("div").attr("id","visContainer"),void 0===n.columnOrder&&this.trigger("updateConfig",[{columnOrder:{}}]);var h=new a(e,s,n);this.trigger("registerOptions",h.getConfigOptions()),i(n,h,e=>{this.trigger("updateConfig",[{columnOrder:e}])}),console.log("dataTable",h),l()}}})},function(e,t){!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){class n{constructor({vis:e,queryResponseField:t}){this.vis=e,this.name=t.name,this.view=t.view_label||"",this.label=t.label_short||t.label,this.is_numeric=t.is_numeric,this.is_array=["list","location","tier"].includes(t.type),this.value_format=t.value_format,this.geo_type="",("location"===t.type||t.map_layer)&&(this.geo_type="location"===t.type?"location":t.map_layer.name),this.hide=!1,void 0!==this.vis.config["hide|"+this.name]&&this.vis.config["hide|"+this.name]&&(this.hide=!0),this.style="";var n=this.vis.config["style|"+this.name];void 0!==n&&("hide"===n?this.hide=!0:this.style=n),this.heading="",this.short_name="",this.unit="",void 0!==t.tags&&t.tags.forEach(e=>{var t=e.split(":");if("vis-tools"===t[0])switch(t[1]){case"heading":this.heading=t[2];break;case"short_name":this.short_name=t[2];break;case"unit":this.unit=t[2];break;case"style":this.style=t[2]}})}}class a{constructor({keys:e,values:t,types:n=[]}){if(e.length===t.length){this.keys=e,this.values=t,this.types=n;var a=[],r=[];this.values.forEach((e,t)=>{this.types[t]=void 0!==n[t]?n[t]:"line_item","line_item"===this.types[t]?(a.push(e),r.push(e)):"subtotal"===this.types[t]&&r.push(e)}),this.min_for_display=Math.min(r),this.max_for_display=Math.max(r),this.min=Math.min(a),this.max=Math.max(a),this.sum=a.reduce((e,t)=>e+t,0),this.count=a.length,this.avg=a.length>0?this.sum/a.length:null}else console.log("Could not construct series, arrays were of different length.")}}t.newArray=function(e,t){for(var n=[],a=0;a<e;a++)n.push(t);return n},t.ModelDimension=class extends n{constructor({vis:e,queryResponseField:t}){super({vis:e,queryResponseField:t}),this.type="dimension",this.align="left"}},t.ModelMeasure=class extends n{constructor({vis:e,queryResponseField:t,can_pivot:n}){super({vis:e,queryResponseField:t}),this.type="measure",this.align="right",this.is_table_calculation=void 0!==t.is_table_calculation&&t.is_table_calculation,this.calculation_type=t.type,this.is_turtle=t.is_turtle,this.can_pivot=n}},t.CellSeries=class{constructor({column:e,row:t,sort_value:n,series:r}){this.column=e,this.row=t,this.sort_value=n,this.series=new a(r)}toString(){var e="";return this.series.keys.forEach((t,n)=>{e+=t+":";var a=""===this.column.modelField.value_format?this.series.values[n].toString():SSF.format(this.column.modelField.value_format,this.series.values[n]);e+=a+" "}),e}},t.ColumnSeries=class{constructor({column:e,is_numeric:t,series:n}){this.column=e,this.is_numeric=t,this.series=new a(n)}},t.HeaderField=class{constructor({vis:e,queryResponseField:t={name:"",label:"",view:""}}={vis:e,queryResponseField:t}){console.log("HeaderField()",e,t.name),this.vis=e,this.name=t.name,this.label=t.label_short?t.label_short:t.label,this.view=t.view_label}},t.Row=class{constructor(e="line_item"){this.id="",this.modelField=null,this.hide=!1,this.type=e,this.sort=[],this.data={}}},t.Column=class{constructor(e,t,n){this.id=e,this.vis=t,this.modelField=n,this.transposed=!1,this.idx=0,this.pos=0,this.levels=[],this.pivot_key="",this.unit=n.unit||"",this.hide=n.hide||!1,this.variance_type="",this.pivoted=!1,this.subtotal=!1,this.super=!1,this.series=null,this.sort_by_measure_values=[],this.sort_by_pivot_values=[],this.colspans=[];var a={};this.vis.headers.forEach(e=>{a[e.name]=-1}),this.vis.colspan_values[this.id]=a}getLabel(e){if(this.transposed)return this.labels[e];if(void 0!==this.vis.visId&&"report_table"===this.vis.visId)switch(this.variance_type){case"absolute":var t="Var #";break;case"percentage":t="Var %";break;default:t=this.vis.useShortName&&this.modelField.short_name||this.modelField.label}else t=this.modelField.label;var n;return void 0!==(n=this.vis.config["label|"+this.modelField.name])&&n!==this.modelField.label&&(t=n||t),void 0!==this.vis.useViewName&&this.vis.useViewName&&(t=[this.modelField.view,t].join(" ")),void 0!==this.vis.has_pivots&&(this.vis.has_pivots?"getSortByPivots"===this.vis.sortColsBy?e<this.levels.length&&(t=this.levels[e]):e>=1&&(t=this.levels[e-1]):this.vis.useHeadings&&0===e&&(t=void 0!==(n=this.vis.config["heading|"+this.modelField.name])&&n||this.modelField.heading)),t}getHeaderLevels(){if("getSortByPivots"===this.modelField.vis.sortColsBy)var e=[...this.levels,this.getLabel(this.levels.length)];else e=[this.getLabel(0),...this.levels];if(this.modelField.vis.useHeadings&&!this.modelField.vis.has_pivots){var t=this.modelField.heading,n=this.modelField.vis.config["heading|"+this.modelField.name];void 0!==n&&(t=n||t),e.unshift(t)}return e}getHeaderData(){var e={},t=this.getHeaderLevels();return this.modelField.vis.headers.forEach((n,a)=>{e[n.name]=t[a]}),e}updateSortByMeasures(e){1==this.sort_by_measure_values[0]&&(this.pivoted||this.subtotal||(this.sort_by_measure_values=[1,e]))}getSortByMeasures(){return this.sort_by_measure_values}getSortByPivots(){return this.sort_by_pivot_values}}},function(e,t,n){var a={};!function(e){function t(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function n(e,t){for(var n="";n.length<t;)n+=e;return n}function a(e,t){var a=""+e;return a.length>=t?a:n("0",t-a.length)+a}function r(e,t){var a=""+e;return a.length>=t?a:n(" ",t-a.length)+a}function s(e,t){var a=""+e;return a.length>=t?a:a+n(" ",t-a.length)}e.version="0.11.0";var i=Math.pow(2,32);function o(e,t){return e>i||e<-i?function(e,t){var a=""+Math.round(e);return a.length>=t?a:n("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:n("0",t-a.length)+a}(Math.round(e),t)}function l(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],h=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function c(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}var d={};function p(e,t,n){for(var a=e<0?-1:1,r=e*a,s=0,i=1,o=0,l=1,u=0,h=0,c=Math.floor(r);u<t&&(o=(c=Math.floor(r))*i+s,h=c*u+l,!(r-c<5e-8));)r=1/(r-c),s=i,i=o,l=u,u=h;if(h>t&&(u>t?(h=l,o=s):(h=u,o=i)),!n)return[0,a*o,h];var d=Math.floor(a*o/h);return[d,a*o-d*h,h]}function f(e,t,n){if(e>2958465||e<0)return null;var a=0|e,r=Math.floor(86400*(e-a)),s=0,i=[],o={D:a,T:r,u:86400*(e-a)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,86400==++r&&(o.T=r=0,++a,++o.D)),60===a)i=n?[1317,10,29]:[1900,2,29],s=3;else if(0===a)i=n?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),a<60&&(s=(s+6)%7),n&&(s=0)}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=r%60,r=Math.floor(r/60),o.M=r%60,r=Math.floor(r/60),o.H=r,o.q=s,o}c(d),e.parse_date_code=f;var v=new Date(1899,11,31,0,0,0),m=v.getTime(),g=new Date(1900,2,1,0,0,0);function b(e,t){var n=e.getTime();return t?n-=1262304e5:e>=g&&(n+=864e5),(n-(m+6e4*(e.getTimezoneOffset()-v.getTimezoneOffset())))/864e5}e._general_int=function(e){return e.toString(10)};var y=function(){var e=/\.(\d*[1-9])0+$/,t=/\.0*$/,n=/\.(\d*[1-9])0+/,a=/\.0*[Ee]/,r=/(E[+-])(\d)$/;function s(n){return n.indexOf(".")>-1?n.replace(t,"").replace(e,".$1"):n}return function(t){var i,o=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return i=o>=-4&&o<=-1?t.toPrecision(10+o):Math.abs(o)<=9?function(e){var t=e<0?12:11,n=s(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(t):10===o?t.toFixed(10).substr(0,12):function(t){var n=t.toFixed(11).replace(e,".$1");return n.length>(t<0?12:11)&&(n=t.toPrecision(6)),n}(t),s(function(e){for(var t=0;t!=e.length;++t)if(101==(32|e.charCodeAt(t)))return e.replace(n,".$1").replace(a,"E").replace("e","E").replace(r,"$10$2");return e}(i))}}();function _(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):y(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return O(14,b(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function w(e,t,n,r){var s,i="",o=0,l=0,c=n.y,d=0;switch(e){case 98:c=n.y+543;case 121:switch(t.length){case 1:case 2:s=c%100,d=2;break;default:s=c%1e4,d=4}break;case 109:switch(t.length){case 1:case 2:s=n.m,d=t.length;break;case 3:return h[n.m-1][1];case 5:return h[n.m-1][0];default:return h[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:s=n.d,d=t.length;break;case 3:return u[n.q][0];default:return u[n.q][1]}break;case 104:switch(t.length){case 1:case 2:s=1+(n.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:s=n.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:s=n.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(l=r>=2?3===r?1e3:100:1===r?10:1,(o=Math.round(l*(n.S+n.u)))>=60*l&&(o=0),"s"===t?0===o?"0":""+o/l:(i=a(o,2+r),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):a(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":s=24*n.D+n.H;break;case"[m]":case"[mm]":s=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":s=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}d=3===t.length?1:2;break;case 101:s=c,d=1}return d>0?a(s,d):""}function x(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}e._general_num=y,e._general=_;var C=function(){var e=/%/g,i=/# (\?+)( ?)\/( ?)(\d+)/,l=/^#*0*\.([0#]+)/,u=/\).*[0#]/,h=/\(###\) ###\\?-####/;function c(e){for(var t,n="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function d(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function f(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,t))}function v(m,g,b){if(40===m.charCodeAt(0)&&!g.match(u)){var y=g.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return b>=0?v("n",y,b):"("+v("n",y,-b)+")"}if(44===g.charCodeAt(g.length-1))return function(e,t,n){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return C(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}(m,g,b);if(-1!==g.indexOf("%"))return function(t,a,r){var s=a.replace(e,""),i=a.length-s.length;return C(t,s,r*Math.pow(10,2*i))+n("%",i)}(m,g,b);if(-1!==g.indexOf("E"))return function e(t,n){var a,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var s=t.indexOf(".");-1===s&&(s=t.indexOf("E"));var i=Math.floor(Math.log(n)*Math.LOG10E)%s;if(i<0&&(i+=s),-1===(a=(n/Math.pow(10,i)).toPrecision(r+1+(s+i)%s)).indexOf("e")){var o=Math.floor(Math.log(n)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+i):a+="E+"+(o-i);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,a){return t+n+a.substr(0,(s+i)%s)+"."+a.substr(i)+"E"}))}else a=n.toExponential(r);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(g,b);if(36===g.charCodeAt(0))return"$"+v(m,g.substr(" "==g.charAt(1)?2:1),b);var _,w,k,$,F=Math.abs(b),E=b<0?"-":"";if(g.match(/^00+$/))return E+o(F,g.length);if(g.match(/^[#?]+$/))return"0"===(_=o(b,0))&&(_=""),_.length>g.length?_:c(g.substr(0,g.length-_.length))+_;if(w=g.match(i))return function(e,t,s){var i=parseInt(e[4],10),o=Math.round(t*i),l=Math.floor(o/i),u=o-l*i,h=i;return s+(0===l?"":""+l)+" "+(0===u?n(" ",e[1].length+1+e[4].length):r(u,e[1].length)+e[2]+"/"+e[3]+a(h,e[4].length))}(w,F,E);if(g.match(/^#+0+$/))return E+o(F,g.length-g.indexOf("0"));if(w=g.match(l))return _=d(b,w[1].length).replace(/^([^\.]+)$/,"$1."+c(w[1])).replace(/\.$/,"."+c(w[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+n("0",c(w[1]).length-t.length)})),-1!==g.indexOf("0.")?_:_.replace(/^0\./,".");if(g=g.replace(/^#+([0.])/,"$1"),w=g.match(/^(0*)\.(#*)$/))return E+d(F,w[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,w[1].length?"0.":".");if(w=g.match(/^#{1,3},##0(\.?)$/))return E+x(o(F,0));if(w=g.match(/^#,##0\.([#0]*0)$/))return b<0?"-"+v(m,g,-b):x(""+(Math.floor(b)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(b,w[1].length)))+"."+a(f(b,w[1].length),w[1].length);if(w=g.match(/^#,#*,#0/))return v(m,g.replace(/^#,#*,/,""),b);if(w=g.match(/^([0#]+)(\\?-([0#]+))+$/))return _=t(v(m,g.replace(/[\\-]/g,""),b)),k=0,t(t(g.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return k<_.length?_.charAt(k++):"0"===e?"0":""})));if(g.match(h))return"("+(_=v(m,"##########",b)).substr(0,3)+") "+_.substr(3,3)+"-"+_.substr(6);var M="";if(w=g.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(w[4].length,7),$=p(F,Math.pow(10,k)-1,!1),_=""+E," "==(M=C("n",w[1],$[1])).charAt(M.length-1)&&(M=M.substr(0,M.length-1)+"0"),_+=M+w[2]+"/"+w[3],(M=s($[2],k)).length<w[4].length&&(M=c(w[4].substr(w[4].length-M.length))+M),_+=M;if(w=g.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(w[1].length,w[4].length),7),E+(($=p(F,Math.pow(10,k)-1,!0))[0]||($[1]?"":"0"))+" "+($[1]?r($[1],k)+w[2]+"/"+w[3]+s($[2],k):n(" ",2*k+1+w[2].length+w[3].length));if(w=g.match(/^[#0?]+$/))return _=o(b,0),g.length<=_.length?_:c(g.substr(0,g.length-_.length))+_;if(w=g.match(/^([#0?]+)\.([#0]+)$/)){_=""+b.toFixed(Math.min(w[2].length,10)).replace(/([^0])0+$/,"$1"),k=_.indexOf(".");var S=g.indexOf(".")-k,A=g.length-_.length-S;return c(g.substr(0,S)+_+g.substr(g.length-A))}if(w=g.match(/^00,000\.([#0]*0)$/))return k=f(b,w[1].length),b<0?"-"+v(m,g,-b):x(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(b)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(k,w[1].length);switch(g){case"###,##0.00":return v(m,"#,##0.00",b);case"###,###":case"##,###":case"#,###":var O=x(o(F,0));return"0"!==O?E+O:"";case"###,###.00":return v(m,"###,##0.00",b).replace(/^0\./,".");case"#,###.00":return v(m,"#,##0.00",b).replace(/^0\./,".")}throw new Error("unsupported format |"+g+"|")}function m(o,d,f){if(40===o.charCodeAt(0)&&!d.match(u)){var v=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?m("n",v,f):"("+m("n",v,-f)+")"}if(44===d.charCodeAt(d.length-1))return function(e,t,n){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return C(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}(o,d,f);if(-1!==d.indexOf("%"))return function(t,a,r){var s=a.replace(e,""),i=a.length-s.length;return C(t,s,r*Math.pow(10,2*i))+n("%",i)}(o,d,f);if(-1!==d.indexOf("E"))return function e(t,n){var a,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var s=t.indexOf(".");-1===s&&(s=t.indexOf("E"));var i=Math.floor(Math.log(n)*Math.LOG10E)%s;if(i<0&&(i+=s),!(a=(n/Math.pow(10,i)).toPrecision(r+1+(s+i)%s)).match(/[Ee]/)){var o=Math.floor(Math.log(n)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+i):a+="E+"+(o-i),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,a){return t+n+a.substr(0,(s+i)%s)+"."+a.substr(i)+"E"}))}else a=n.toExponential(r);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(d,f);if(36===d.charCodeAt(0))return"$"+m(o,d.substr(" "==d.charAt(1)?2:1),f);var g,b,y,_,w=Math.abs(f),k=f<0?"-":"";if(d.match(/^00+$/))return k+a(w,d.length);if(d.match(/^[#?]+$/))return g=""+f,0===f&&(g=""),g.length>d.length?g:c(d.substr(0,d.length-g.length))+g;if(b=d.match(i))return function(e,t,a){return a+(0===t?"":""+t)+n(" ",e[1].length+2+e[4].length)}(b,w,k);if(d.match(/^#+0+$/))return k+a(w,d.length-d.indexOf("0"));if(b=d.match(l))return g=(g=(""+f).replace(/^([^\.]+)$/,"$1."+c(b[1])).replace(/\.$/,"."+c(b[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+n("0",c(b[1]).length-t.length)})),-1!==d.indexOf("0.")?g:g.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),b=d.match(/^(0*)\.(#*)$/))return k+(""+w).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=d.match(/^#{1,3},##0(\.?)$/))return k+x(""+w);if(b=d.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+m(o,d,-f):x(""+f)+"."+n("0",b[1].length);if(b=d.match(/^#,#*,#0/))return m(o,d.replace(/^#,#*,/,""),f);if(b=d.match(/^([0#]+)(\\?-([0#]+))+$/))return g=t(m(o,d.replace(/[\\-]/g,""),f)),y=0,t(t(d.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return y<g.length?g.charAt(y++):"0"===e?"0":""})));if(d.match(h))return"("+(g=m(o,"##########",f)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var $="";if(b=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return y=Math.min(b[4].length,7),_=p(w,Math.pow(10,y)-1,!1),g=""+k," "==($=C("n",b[1],_[1])).charAt($.length-1)&&($=$.substr(0,$.length-1)+"0"),g+=$+b[2]+"/"+b[3],($=s(_[2],y)).length<b[4].length&&($=c(b[4].substr(b[4].length-$.length))+$),g+=$;if(b=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return y=Math.min(Math.max(b[1].length,b[4].length),7),k+((_=p(w,Math.pow(10,y)-1,!0))[0]||(_[1]?"":"0"))+" "+(_[1]?r(_[1],y)+b[2]+"/"+b[3]+s(_[2],y):n(" ",2*y+1+b[2].length+b[3].length));if(b=d.match(/^[#0?]+$/))return g=""+f,d.length<=g.length?g:c(d.substr(0,d.length-g.length))+g;if(b=d.match(/^([#0]+)\.([#0]+)$/)){g=""+f.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),y=g.indexOf(".");var F=d.indexOf(".")-y,E=d.length-g.length-F;return c(d.substr(0,F)+g+d.substr(d.length-E))}if(b=d.match(/^00,000\.([#0]*0)$/))return f<0?"-"+m(o,d,-f):x(""+f).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(0,b[1].length);switch(d){case"###,###":case"##,###":case"#,###":var M=x(""+w);return"0"!==M?k+M:"";default:if(d.match(/\.[0#?]*$/))return m(o,d.slice(0,d.lastIndexOf(".")),f)+c(d.slice(d.lastIndexOf(".")))}throw new Error("unsupported format |"+d+"|")}return function(e,t,n){return(0|n)===n?m(e,t,n):v(e,t,n)}}();function k(e){for(var t=[],n=!1,a=0,r=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:n=!n;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(r,a-r),r=a+1}if(t[t.length]=e.substr(r),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=k;var $=/\[[HhMmSs]*\]/;function F(e){for(var t=0,n="",a="";t<e.length;)switch(n=e.charAt(t)){case"G":l(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=n;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match($))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":default:++t}return!1}function E(e,t,n,a){for(var r,s,i,o=[],u="",h=0,c="",d="t",p="H";h<e.length;)switch(c=e.charAt(h)){case"G":if(!l(e,h))throw new Error("unrecognized character "+c+" in "+e);o[o.length]={t:"G",v:"General"},h+=7;break;case'"':for(u="";34!==(i=e.charCodeAt(++h))&&h<e.length;)u+=String.fromCharCode(i);o[o.length]={t:"t",v:u},++h;break;case"\\":var v=e.charAt(++h),m="("===v||")"===v?v:"t";o[o.length]={t:m,v:v},++h;break;case"_":o[o.length]={t:"t",v:" "},h+=2;break;case"@":o[o.length]={t:"T",v:t},++h;break;case"B":case"b":if("1"===e.charAt(h+1)||"2"===e.charAt(h+1)){if(null==r&&null==(r=f(t,n,"2"===e.charAt(h+1))))return"";o[o.length]={t:"X",v:e.substr(h,2)},d=c,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==r&&null==(r=f(t,n)))return"";for(u=c;++h<e.length&&e.charAt(h).toLowerCase()===c;)u+=c;"m"===c&&"h"===d.toLowerCase()&&(c="M"),"h"===c&&(c=p),o[o.length]={t:c,v:u},d=c;break;case"A":case"a":var g={t:c,v:c};if(null==r&&(r=f(t,n)),"A/P"===e.substr(h,3).toUpperCase()?(null!=r&&(g.v=r.H>=12?"P":"A"),g.t="T",p="h",h+=3):"AM/PM"===e.substr(h,5).toUpperCase()?(null!=r&&(g.v=r.H>=12?"PM":"AM"),g.t="T",h+=5,p="h"):(g.t="t",++h),null==r&&"T"===g.t)return"";o[o.length]=g,d=c;break;case"[":for(u=c;"]"!==e.charAt(h++)&&h<e.length;)u+=e.charAt(h);if("]"!==u.slice(-1))throw'unterminated "[" block: |'+u+"|";if(u.match($)){if(null==r&&null==(r=f(t,n)))return"";o[o.length]={t:"Z",v:u.toLowerCase()},d=u.charAt(1)}else u.indexOf("$")>-1&&(u=(u.match(/\$([^-\[\]]*)/)||[])[1]||"$",F(e)||(o[o.length]={t:"t",v:u}));break;case".":if(null!=r){for(u=c;++h<e.length&&"0"===(c=e.charAt(h));)u+=c;o[o.length]={t:"s",v:u};break}case"0":case"#":for(u=c;++h<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(h))>-1;)u+=c;o[o.length]={t:"n",v:u};break;case"?":for(u=c;e.charAt(++h)===c;)u+=c;o[o.length]={t:c,v:u},d=c;break;case"*":++h," "!=e.charAt(h)&&"*"!=e.charAt(h)||++h;break;case"(":case")":o[o.length]={t:1===a?"t":c,v:c},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(u=c;h<e.length&&"0123456789".indexOf(e.charAt(++h))>-1;)u+=e.charAt(h);o[o.length]={t:"D",v:u};break;case" ":o[o.length]={t:c,v:c},++h;break;case"$":o[o.length]={t:"t",v:"$"},++h;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c))throw new Error("unrecognized character "+c+" in "+e);o[o.length]={t:"t",v:c},++h}var b,y=0,x=0;for(h=o.length-1,d="t";h>=0;--h)switch(o[h].t){case"h":case"H":o[h].t=p,d="h",y<1&&(y=1);break;case"s":(b=o[h].v.match(/\.0+$/))&&(x=Math.max(x,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":d=o[h].t;break;case"m":"s"===d&&(o[h].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&o[h].v.match(/[Hh]/)&&(y=1),y<2&&o[h].v.match(/[Mm]/)&&(y=2),y<3&&o[h].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M),r.M>=60&&(r.M=0,++r.H);break;case 2:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M)}var k,E="";for(h=0;h<o.length;++h)switch(o[h].t){case"t":case"T":case" ":case"D":break;case"X":o[h].v="",o[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[h].v=w(o[h].t.charCodeAt(0),o[h].v,r,x),o[h].t="t";break;case"n":case"?":for(k=h+1;null!=o[k]&&("?"===(c=o[k].t)||"D"===c||(" "===c||"t"===c)&&null!=o[k+1]&&("?"===o[k+1].t||"t"===o[k+1].t&&"/"===o[k+1].v)||"("===o[h].t&&(" "===c||"n"===c||")"===c)||"t"===c&&("/"===o[k].v||" "===o[k].v&&null!=o[k+1]&&"?"==o[k+1].t));)o[h].v+=o[k].v,o[k]={v:"",t:";"},++k;E+=o[h].v,h=k-1;break;case"G":o[h].t="t",o[h].v=_(t,n)}var M,S,A="";if(E.length>0){40==E.charCodeAt(0)?(M=t<0&&45===E.charCodeAt(0)?-t:t,S=C("n",E,M)):(S=C("n",E,M=t<0&&a>1?-t:t),M<0&&o[0]&&"t"==o[0].t&&(S=S.substr(1),o[0].v="-"+o[0].v)),k=S.length-1;var O=o.length;for(h=0;h<o.length;++h)if(null!=o[h]&&"t"!=o[h].t&&o[h].v.indexOf(".")>-1){O=h;break}var T=o.length;if(O===o.length&&-1===S.indexOf("E")){for(h=o.length-1;h>=0;--h)null!=o[h]&&-1!=="n?".indexOf(o[h].t)&&(k>=o[h].v.length-1?(k-=o[h].v.length,o[h].v=S.substr(k+1,o[h].v.length)):k<0?o[h].v="":(o[h].v=S.substr(0,k+1),k=-1),o[h].t="t",T=h);k>=0&&T<o.length&&(o[T].v=S.substr(0,k+1)+o[T].v)}else if(O!==o.length&&-1===S.indexOf("E")){for(k=S.indexOf(".")-1,h=O;h>=0;--h)if(null!=o[h]&&-1!=="n?".indexOf(o[h].t)){for(s=o[h].v.indexOf(".")>-1&&h===O?o[h].v.indexOf(".")-1:o[h].v.length-1,A=o[h].v.substr(s+1);s>=0;--s)k>=0&&("0"===o[h].v.charAt(s)||"#"===o[h].v.charAt(s))&&(A=S.charAt(k--)+A);o[h].v=A,o[h].t="t",T=h}for(k>=0&&T<o.length&&(o[T].v=S.substr(0,k+1)+o[T].v),k=S.indexOf(".")+1,h=O;h<o.length;++h)if(null!=o[h]&&(-1!=="n?(".indexOf(o[h].t)||h===O)){for(s=o[h].v.indexOf(".")>-1&&h===O?o[h].v.indexOf(".")+1:0,A=o[h].v.substr(0,s);s<o[h].v.length;++s)k<S.length&&(A+=S.charAt(k++));o[h].v=A,o[h].t="t",T=h}}}for(h=0;h<o.length;++h)null!=o[h]&&"n?".indexOf(o[h].t)>-1&&(M=a>1&&t<0&&h>0&&"-"===o[h-1].v?-t:t,o[h].v=C(o[h].t,o[h].v,M),o[h].t="t");var R="";for(h=0;h!==o.length;++h)null!=o[h]&&(R+=o[h].v);return R}e.is_date=F,e._eval=E;var M=/\[[=<>]/,S=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function A(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function O(e,t,n){null==n&&(n={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":a=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:d)[e]}if(l(a,0))return _(t,n);t instanceof Date&&(t=b(t,n.date1904));var r=function(e,t){var n=k(e),a=n.length,r=n[a-1].indexOf("@");if(a<4&&r>-1&&--a,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!=typeof t)return[4,4===n.length||r>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=r>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=r>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=r>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var s=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[a,s];if(null!=n[0].match(M)||null!=n[1].match(M)){var i=n[0].match(S),o=n[1].match(S);return A(t,i)?[a,n[0]]:A(t,o)?[a,n[1]]:[a,n[null!=i&&null!=o?2:1]]}return[a,s]}(a,t);if(l(r[1]))return _(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return E(r[1],t,n,r[0])}function T(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(null!=d[n]){if(d[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return d[t]=e,t}e.load=T,e._table=d,e.get_table=function(){return d},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&T(e[t],t)},e.init_table=c,e.format=O}(a),"undefined"==typeof DO_NOT_EXPORT_SSF&&(e.exports=a)},function(e,n,a){"use strict";a.r(n);var r=a(1),s=a.n(r),i=a(0);const o={theme:{section:"Theme",type:"string",display:"select",label:"Theme",values:[{Traditional:"traditional"},{Looker:"looker"},{Contemporary:"contemporary"},{"Use custom theme":"custom"}],default:"traditional",order:1},customTheme:{section:"Theme",type:"string",label:"Load custom CSS from:",default:"",order:2},layout:{section:"Theme",type:"string",display:"select",label:"Layout",values:[{Even:"fixed"},{Auto:"auto"}],default:"fixed",order:3},columnOrder:{},rowSubtotals:{section:"Table",type:"boolean",label:"Row Subtotals",display_size:"half",default:!1,order:1},colSubtotals:{section:"Table",type:"boolean",label:"Col Subtotals",display_size:"half",default:!1,order:2},spanRows:{section:"Table",type:"boolean",label:"Merge Dims",display_size:"half",default:!0,order:3},spanCols:{section:"Table",type:"boolean",label:"Merge Headers",display_size:"half",default:!0,order:4},sortColumnsBy:{section:"Table",type:"string",display:"select",label:"Sort Columns By",values:[{Pivots:"getSortByPivots"},{Measures:"getSortByMeasures"}],default:"getSortByPivots",order:6},useViewName:{section:"Table",type:"boolean",label:"Include View Name",default:!1,order:7},useHeadings:{section:"Table",type:"boolean",label:"Use Headings (non-pivots only)",default:!1,order:8},useShortName:{section:"Table",type:"boolean",label:"Use Short Name (from model)",default:!1,order:9},groupVarianceColumns:{section:"Table",type:"boolean",label:"Group Variance Columns After Pivots",default:!1,order:10},indexColumn:{section:"Dimensions",type:"boolean",label:"Use Last Field Only",default:!1,order:0},transposeTable:{section:"Table",type:"boolean",label:"Transpose",default:!1,order:100}};t.VisPluginTableModel=class{constructor(e,t,n){this.visId="report_table",this.config=n,this.headers=[],this.dimensions=[],this.measures=[],this.columns=[],this.data=[],this.subtotals_data={},this.transposed_headers=[],this.transposed_columns=[],this.transposed_data=[],this.pivots=[],this.pivot_values=[],this.variances=[],this.column_series=[],this.colspan_values={},this.rowspan_values={},this.useIndexColumn=n.indexColumn||!1,this.useHeadings=n.useHeadings||!1,this.useShortName=n.useShortName||!1,this.useViewName=n.useViewName||!1,this.addRowSubtotals=n.rowSubtotals||!1,this.addSubtotalDepth=parseInt(n.subtotalDepth)||this.dimensions.length-1,this.addColSubtotals=n.colSubtotals||!1,this.spanRows=n.spanRows,this.spanCols=n.spanCols,this.sortColsBy=n.sortColumnsBy||"getSortByPivots",this.hasTotals=void 0!==t.totals_data,this.calculateOthers=void 0!==t.truncated&&t.truncated,this.hasSubtotals=!1,this.hasRowTotals=t.has_row_totals||!1,this.hasPivots=!1,this.hasSupers=!1,this.transposeTable=n.transposeTable,this.checkPivotsAndSupermeasures(t),this.addHeaders(),this.addDimensions(t,0),this.addMeasures(t,0),this.checkVarianceCalculations(),this.useIndexColumn&&this.buildIndexColumn(t),this.checkSubtotalsData(t),this.buildRows(e),this.addColumnSeries(),this.hasTotals&&this.buildTotals(t),this.spanRows&&this.setRowSpans(),this.addRowSubtotals&&this.addSubTotals(),this.addColSubtotals&&2===this.pivots.length&&this.addColumnSubTotals(),console.log(this),this.addVarianceColumns(),this.sortColumns(),this.spanCols&&this.setColSpans(),this.applyFormatting(),this.transposeTable&&(this.transposeColumns(),this.transposeRows()),this.validateConfig()}static getCoreConfigOptions(){return o}getConfigOptions(){var e=o,t=[];return this.dimensions.forEach((n,a)=>{if(e["label|"+n.name]={section:"Dimensions",type:"string",label:n.label,default:n.label,order:10*a+1},e["heading|"+n.name]={section:"Dimensions",type:"string",label:"Heading",default:"",order:10*a+2},e["hide|"+n.name]={section:"Dimensions",type:"boolean",label:"Hide",display_size:"third",default:!1,order:10*a+3},a<this.dimensions.length-1){var r={};r[n.label]=(a+1).toString(),t.push(r)}}),e.subtotalDepth={section:"Table",type:"string",label:"Sub Total Depth",display:"select",values:t,default:"1",order:5},this.measures.forEach((t,n)=>{e["label|"+t.name]={section:"Measures",type:"string",label:t.label,default:t.label,order:100+10*n+1},e["heading|"+t.name]={section:"Measures",type:"string",label:"Heading for "+t.label,default:"",order:100+10*n+2},e["style|"+t.name]={section:"Measures",type:"string",label:"Style",display:"select",values:[{Normal:"normal"},{"Black/Red":"black_red"},{Subtotal:"subtotal"},{Hidden:"hide"}],order:100+10*n+3};var a=[];if(t.can_pivot){var r=[];this.pivots.forEach((e,t)=>{if(1===this.pivots.length||1===t||this.config.colSubtotals){var n={};n["By "+e.label]=e.name,r.push(n)}}),a=a.concat(r)}this.measures.forEach((e,r)=>{var s=t.can_pivot===e.can_pivot||this.hasRowTotals&&!e.is_table_calculation;if(n!=r&&s){var i={};i["Vs. "+e.label]=e.name,a.push(i)}}),a.unshift({"(none)":"no_variance"}),e["comparison|"+t.name]={section:"Measures",type:"string",label:"Comparison",display:"select",values:a,order:100+10*n+5},e["switch|"+t.name]={section:"Measures",type:"boolean",label:"Switch",display_size:"third",default:!1,order:100+10*n+6},e["var_num|"+t.name]={section:"Measures",type:"boolean",label:"Var #",display_size:"third",default:!0,order:100+10*n+7},e["var_pct|"+t.name]={section:"Measures",type:"boolean",label:"Var %",display_size:"third",default:!1,order:100+10*n+8}}),e}checkPivotsAndSupermeasures(e){e.fields.pivots.forEach(e=>this.pivots.push(new i.HeaderField({vis:this,queryResponseField:e}))),void 0!==e.pivots&&(this.pivot_values=e.pivots,this.hasPivots=!0),void 0!==e.fields.supermeasure_like&&(this.hasSupers=!0)}addHeaders(){var e=new i.HeaderField({vis:this,queryResponseField:{label:"",name:"measure",view:""}});if(this.pivots.forEach(e=>{this.headers.push(e)}),"getSortByPivots"===this.sortColsBy?this.headers.push(e):this.headers.unshift(e),this.useHeadings&&!this.hasPivots){var t=new i.HeaderField({vis:this,queryResponseField:{label:"",name:"heading",view:""}});this.headers.unshift(t)}}addDimensions(e,t){e.fields.dimension_like.forEach(e=>{var n=new i.ModelDimension({vis:this,queryResponseField:e});n.hide=!!this.useIndexColumn,this.dimensions.push(n);var a=new i.Column(n.name,this,n);a.idx=t,a.levels=Object(i.newArray)(this.pivots.length,new i.HeaderField({vis:this,queryResponseField:{}})),a.sort_by_measure_values=[0,t,...Object(i.newArray)(this.pivots.length,0)],a.sort_by_pivot_values=[0,...Object(i.newArray)(this.pivots.length,0),t],this.columns.push(a),t+=10})}addMeasures(e,t){var n=this.config;e.fields.measure_like.forEach(e=>{var t=new i.ModelMeasure({vis:this,queryResponseField:e,can_pivot:!0});this.measures.push(t)}),this.hasPivots?this.pivot_values.forEach(e=>{this.measures.forEach((n,a)=>{if("$$$_row_total_$$$"!=e.key||"$$$_row_total_$$$"==e.key&&0==n.is_table_calculation){var r=e.key+"."+n.name,s=[],o=[];this.pivots.forEach(t=>{s.push(new i.HeaderField({vis:this,queryResponseField:{name:e.data[t.name],label:"",view:""}})),o.push(e.sort_values[t.name])});var l=n,u=new i.Column(r,this,l);u.idx=t,u.levels=s,u.pivoted=!0,u.pivot_key=e.key,"$$$_row_total_$$$"!==e.key?(u.sort_by_measure_values=[1,a,...o],u.sort_by_pivot_values=[1,...o,t]):(u.super=!0,u.sort_by_measure_values=[2,a,...Object(i.newArray)(this.pivots.length,0)],u.sort_by_pivot_values=[2,...Object(i.newArray)(this.pivots.length,0),t]),this.columns.push(u),t+=10}})}):this.measures.forEach(e=>{var a=new i.Column(e.name,this,e);a.idx=t;try{void 0!==n.columnOrder[a.id]?a.pos=n.columnOrder[a.id]:a.pos=t}catch{a.pos=t}a.sort_by_measure_values=[1,a.pos],a.sort_by_pivot_values=[1,a.pos],this.columns.push(a),t+=10}),void 0!==e.fields.supermeasure_like&&e.fields.supermeasure_like.forEach(e=>{var n=new i.ModelMeasure({vis:this,queryResponseField:e,can_pivot:!1});this.measures.push(n);var a=new i.Column(n.name,this,n);a.idx=t,a.levels=Object(i.newArray)(this.pivots.length,new i.HeaderField({vis:this,queryResponseField:{}})),a.super=!0,a.sort_by_measure_values=[2,t,...Object(i.newArray)(this.pivots.length,1)],a.sort_by_pivot_values=[2,...Object(i.newArray)(this.pivots.length,1),t],this.columns.push(a),t+=10})}checkVarianceCalculations(){Object.keys(this.config).forEach(e=>{if(e.startsWith("comparison")){var t=e.split("|")[1],n=!1;if(this.measures.forEach(e=>{t===e.name&&(n=!0)}),n){if(this.pivots.map(e=>e.name).includes(this.config[e]))var a="by_pivot";else a="vs_measure";if(void 0!==this.config["switch|"+t])if(this.config["switch|"+t])var r=!0;else r=!1;this.variances.push({baseline:t,comparison:this.config[e],type:a,reverse:r})}}})}buildIndexColumn(){var e=new i.Column("$$$_index_$$$",this,this.dimensions[this.dimensions.length-1]);e.levels=Object(i.newArray)(this.pivots.length,new i.HeaderField({vis:this,queryResponseField:{}})),e.sort_by_measure_values=[-1,0,...Object(i.newArray)(this.pivots.length,0)],e.sort_by_pivot_values=[-1,...Object(i.newArray)(this.pivots.length,0),0],this.columns.push(e)}checkSubtotalsData(e){void 0!==e.subtotals_data&&(this.hasSubtotals=!0,void 0!==e.subtotals_data[this.addSubtotalDepth]&&e.subtotals_data[this.addSubtotalDepth].forEach(e=>{var t=new i.Row("subtotal");t.$$$__grouping__$$$=e.$$$__grouping__$$$;var n=["Subtotal"];t.$$$__grouping__$$$.forEach(t=>{n.push(e[t].value)}),t.id=n.join("|"),this.columns.forEach(n=>{t.data[n.id]=n.pivoted?e[n.modelField.name][n.pivot_key]:e[n.id],void 0!==t.data[n.id]&&(void 0===t.data[n.id].cell_style?t.data[n.id].cell_style=["total","subtotal"]:t.data[n.id].cell_style.concat(["total","subtotal"]),void 0!==n.modelField.style&&(t.data[n.id].cell_style=t.data[n.id].cell_style.concat(n.modelField.style)),null===t.data[n.id].value&&(t.data[n.id].rendered=""))}),this.subtotals_data[t.id]=t}))}buildRows(e){e.forEach((e,t)=>{var n=new i.Row("line_item");this.columns.forEach(t=>{if(n.data[t.id]=t.pivoted?e[t.modelField.name][t.pivot_key]:e[t.id],void 0!==n.data[t.id]&&(n.data[t.id].rowspan=1,void 0===n.data[t.id].cell_style&&(n.data[t.id].cell_style=[]),void 0!==t.modelField.style&&(n.data[t.id].cell_style=n.data[t.id].cell_style.concat(t.modelField.style)),null===n.data[t.id].value&&(n.data[t.id].rendered=""),t.modelField.is_turtle)){var a=new i.CellSeries({column:t,row:n,sort_value:n.data[t.id].sort_value,series:{keys:n.data[t.id]._parsed.keys,values:n.data[t.id]._parsed.values}});n.data[t.id].value=a,n.data[t.id].rendered=a.toString()}}),n.id=this.dimensions.map(e=>n.data[e.name].value).join("|");var a=this.dimensions[this.dimensions.length-1].name;n.data.$$$_index_$$$={value:n.data[a].value,rendered:this.getRenderedFromHtml(n.data[a]),html:n.data[a].html,cell_style:["indent"]},n.sort=[0,0,t],this.data.push(n)})}addColumnSeries(){this.columns.forEach(e=>{var t=[],n=[],a=[];this.data.forEach(r=>{t.push(r.id),n.push(r.data[e.id].value),a.push(r.type)});var r=new i.ColumnSeries({column:e,is_numeric:e.modelField.is_numeric,series:{keys:t,values:n,types:a}});e.series=r,this.column_series.push(r)})}buildTotals(e){for(var t=e.totals_data,n=this.dimensions[0].name,a=0;a>this.dimensions.length;a++){var r=this.dimensions[a];if(!r.hide){n=r.name;break}}var o=new i.Row("total"),l=new i.Row("line_item");this.columns.forEach(e=>{var n=null;if(o.id="Total",l.id="Others",o.data[e.id]={value:"",cell_style:["total"]},l.data[e.id]={value:"",cell_style:[]},"measure"==e.modelField.type){var a=e.pivoted?t[e.modelField.name][e.pivot_key]:t[e.id];if(void 0===a.rendered&&void 0!==a.html&&(a.rendered=this.getRenderedFromHtml(a)),this.calculateOthers&&(n=["sum","count_distinct","count"].includes(e.modelField.calculation_type)?a.value-e.series.series.sum:(a.value+e.series.series.avg)/2),a.cell_style=["total"],o.data[e.id]=a,void 0!==o.data[e.id].links&&o.data[e.id].links.forEach(e=>{e.type="measure_default"}),this.calculateOthers&&n){var r=""===e.modelField.value_format?n.toString():s.a.format(e.modelField.value_format,n);l.data[e.id]={value:n,rendered:r}}}}),this.useIndexColumn&&(o.data.$$$_index_$$$.value="TOTAL"),o.data[n].value="TOTAL",o.sort=[1,0,0],this.calculateOthers&&(this.useIndexColumn&&(l.data.$$$_index_$$$.value="Others"),l.data[n].value="Others",l.sort=[1,-1,-1]),this.data.push(o),this.calculateOthers&&this.data.push(l),this.hasTotals=!0,this.sortData()}setRowSpans(){var e,t=[],n=this.rowspan_values,a={};e=this.data,(t=this.dimensions.filter(e=>!e.hide)).forEach(e=>{a[e.id]=1});for(var r=e.length-1;r>=0;r--){var s=e[r];if("line_item"===s.type){n[s.id]={};for(var i=0;i<t.length;i++){var o=t[i],l=s.data[o.name].value,u=r>0?e[r-1].data[o.name].value:null;if(!(r>0&&l===u)){for(var h=i;h<t.length;h++){var c=t[h];n[s.id][c.name]=a[c.name],s.data[c.name].rowspan=a[c.name],a[c.name]=1}break}n[s.id][o.name]=-1,s.data[o.name].rowspan=-1,a[o.name]+=1}}else t.forEach(e=>{a[e.name]=1})}}addSubTotals(){var e=this.addSubtotalDepth,t=[],n=[];this.data.forEach((a,r)=>{if("total"!==a.type){for(var s=[],i=0;i<e;i++){var o=this.dimensions[i].name;s.push(a.data[o].value)}s.join("|")!==n.join("|")&&(t.push(s),n=s),a.sort=[0,t.length-1,r]}});for(var a=this.dimensions[0].name,r=0;r<this.dimensions.length;r++){var o=this.dimensions[r];if(!o.hide){a=o.name;break}}t.forEach((e,t)=>{var n=new i.Row("subtotal");n.id="Subtotal|"+e.join("|"),this.columns.forEach(r=>{if(n.data[r.id]={cell_style:["total","subtotal"]},"$$$_index_$$$"===r.id||r.id===a){var i=e.join(" | ");n.data[r.id].value=i}if("measure"==r.modelField.type)if(Object.entries(this.subtotals_data).length>0)n.data[r.id]={...n.data[r.id],...this.subtotals_data[n.id].data[r.id]};else{var o=r.pivoted?[r.pivot_key,r.modelField.name].join("."):r.id,l=0,u=0,h="";this.data.forEach(e=>{if("line_item"==e.type&&e.sort[1]==t){var n=e.data[o].value;Number.isFinite(n)&&(l+=n,u++)}}),"average"===r.modelField.calculation_type&&u>0&&(l/=u),l&&(h=""===r.modelField.value_format?l.toString():s.a.format(r.modelField.value_format,l)),"string"===r.modelField.calculation_type&&(l="",h="");var c={value:l,rendered:h,cell_style:["subtotal","total"]};n.data[o]=c}}),n.sort=[0,t,9999],this.data.push(n)}),this.sortData(),this.hasSubtotals=!0}addColumnSubTotals(){var e="",t={},n=[],a=[],r=this.pivots[0].name;this.pivot_values.forEach(e=>{var t=e.data[r];null!==t&&a.push(t)}),(a=[...new Set(a)]).forEach((a,r)=>{var s=[0,""],i=null;this.measures.forEach((o,l)=>{if(o.can_pivot){var u={modelField:o,pivot:a,measure_idx:l,pivot_idx:r,columns:[],id:["$$$_subtotal_$$$",a,o.name].join("."),after:""};this.columns.forEach((e,t)=>{e.pivoted&&e.levels[0]==a&&(e.modelField.name==o.name&&u.columns.push(e.id),e.levels[0]==a&&t>s[0]&&(s=[t,e.id]))}),a!=e&&(t[a]=s[1],i=null),u.after=i||t[a],e=a,i=u.id,n.push(u)}})}),n.forEach((e,t)=>{var n=this.measures[e.measure_idx],a=new i.Column(e.id,this,n);a.levels=[new i.HeaderField({vis:this,queryResponseField:{name:this.pivots[0].name,label:e.pivot,view:""}}),new i.HeaderField({vis:this,queryResponseField:{name:"subtotal",label:"Subtotal",view:""}})];var r=a.levels.map(e=>e.label);a.sort_by_measure_values=[1,e.measure_idx,...r],r[r.length-1]="string"==typeof r[r.length-1]?r[r.length-1]="ZZZZ":r[r.length-1]=9999,a.sort_by_pivot_values=[1,...r,1e4+t],a.pivoted=!0,a.subtotal=!0,a.pivot_key=[e.pivot,"$$$_subtotal_$$$"].join("|"),this.columns.push(a)}),this.sortColumns(),this.data.forEach(e=>{n.forEach(t=>{var n=0;t.columns.forEach(t=>{n+=e.data[t].value}),e.data[t.id]={value:n,rendered:""===t.modelField.value_format?n.toString():s.a.format(t.modelField.value_format,n),align:"right",cell_style:["subtotal"]},["subtotal","total"].includes(e.type)&&e.data[t.id].cell_style.push("total")})})}calculateVariance(e,t,n,a,r){this.data.forEach(i=>{var o=i.data[a.id].value,l=i.data[r.id].value;if("absolute"===n)var u={value:o-l,rendered:""===e?(o-l).toString():s.a.format(e,o-l),cell_style:[]};else{var h=(o-l)/Math.abs(l);if(isFinite(h))u={value:h,rendered:s.a.format("#0.00%",h),cell_style:[]};else u={value:null,rendered:"∞",cell_style:[]}}"total"!=i.type&&"subtotal"!=i.type||u.cell_style.push("total"),"subtotal"===i.type&&u.cell_style.push("subtotal"),u.value<0&&u.cell_style.push("red"),i.data[t]=u})}createVarianceColumn(e){if(this.config.colSubtotals||!e.variance.baseline.startsWith("$$$_subtotal_$$$")){var t=["$$$_variance_$$$",e.calc,e.variance.baseline,e.variance.comparison].join("|"),n=this.getColumnById(e.variance.baseline),a=this.getColumnById(e.variance.comparison),r=new i.Column(t,this,n.modelField);"absolute"===e.calc?(r.variance_type="absolute",r.idx=n.idx+1,r.pos=n.pos+1,r.sort_by_measure_values=n.sort_by_measure_values.concat(1),r.sort_by_pivot_values=n.sort_by_pivot_values.concat(1),r.hide=!this.config["var_num|"+n.modelField.name]):(r.variance_type="percentage",r.idx=n.idx+2,r.pos=n.pos+2,r.sort_by_measure_values=n.sort_by_measure_values.concat(2),r.sort_by_pivot_values=n.sort_by_pivot_values.concat(2),r.unit="%",r.hide=!this.config["var_pct|"+n.modelField.name]),n.sort_by_measure_values.length<r.sort_by_measure_values.length&&n.sort_by_measure_values.push(0),n.sort_by_pivot_values.length<r.sort_by_pivot_values.length&&n.sort_by_pivot_values.push(0),void 0!==this.config.columnOrder[r.id]&&(r.pos=this.config.columnOrder[r.id]),r.pivoted=n.pivoted,r.super=n.super,r.pivot_key="",r.levels=n.levels,this.config.groupVarianceColumns&&("getSortByPivots"===this.config.sortColumnsBy&&(r.sort_by_pivot_values[0]=1.5),1===n.levels.length?r.levels=[new i.HeaderField({vis:this,queryResponseField:{name:"variance",label:"Variance"}})]:r.levels=[new i.HeaderField({vis:this,queryResponseField:{name:"variance",label:"Variance"}}),new i.HeaderField({vis:this,queryResponseField:{name:n.id,label:n.levels[1]}})]),this.columns.push(r),e.variance.reverse?this.calculateVariance(n.modelField.value_format,t,e.calc,a,n):this.calculateVariance(n.modelField.value_format,t,e.calc,n,a)}else console.log("Cannot calculate variance of column subtotals if subtotals disabled.")}addVarianceColumns(){var e=[],t=["absolute","percent"];Object.keys(this.variances).forEach(n=>{var a=this.variances[n];if("no_variance"!==a.comparison)if("vs_measure"===a.type)this.hasPivots?this.pivot_values.forEach(n=>{n.is_total||t.forEach(t=>{e.push({calc:t,variance:{baseline:[n.key,a.baseline].join("."),comparison:[n.key,a.comparison].join("."),reverse:a.reverse,type:a.type}})})}):t.forEach(t=>{e.push({variance:a,calc:t})});else if("by_pivot"===a.type)if(1===this.pivots.length||this.pivots[1].name===a.comparison)this.pivot_values.slice(1).forEach((n,r)=>{t.forEach(t=>{n.is_total||e.push({calc:t,variance:{baseline:[n.key,a.baseline].join("."),comparison:[this.pivot_values[r].key,a.baseline].join("."),reverse:a.reverse,type:a.type}})})});else{var r=[];this.pivot_values.forEach(e=>{if(!e.is_total){var t=e.data[this.pivots[0].name];r.includes(t)||r.push(t)}}),r.slice(1).forEach((n,s)=>{t.forEach(t=>{e.push({calc:t,variance:{baseline:["$$$_subtotal_$$$",n,a.baseline].join("."),comparison:["$$$_subtotal_$$$",r[s],a.baseline].join("."),reverse:a.reverse,type:a.type}})})})}}),e.forEach(e=>{this.createVarianceColumn(e)})}sortColumns(){this.columns.sort((e,t)=>{for(var n=this.sortColsBy,a=e[n]().length,r=0;r<a;r++){if(e[n]()[r]>t[n]()[r])return 1;if(e[n]()[r]<t[n]()[r])return-1}return-1})}setColSpans(){var e=[],t=[],n=this.colspan_values,a={};t.forEach(e=>{a[e.name]=1}),this.columns.filter(e=>!e.hide).forEach(t=>{var n={id:t.id,data:t.getHeaderData()};e.push(n)}),t=this.headers;for(var r=e.length-1;r>=0;r--){var s=e[r];n[s.id]={};for(var i=0;i<t.length;i++){var o=t[i],l=s.data[o.name];if(r>0)var u=e[r-1].data[o.name];if(!(r>0&&l===u)){for(var h=i;h<t.length;h++){var c=t[h];n[s.id][c.name]=a[c.name],a[c.name]=1}break}n[s.id][o.name]=-1,a[o.name]+=1}}this.columns.forEach(e=>{void 0!==n[e.id]&&(e.colspans=n[e.id])})}applyFormatting(){this.columns.forEach(e=>{var t=this.config["style|"+e.modelField.name];if(void 0!==t)switch(t){case"black_red":this.data.forEach(t=>{t.data[e.id].value<0&&t.data[e.id].cell_style.push("red")})}})}transposeColumns(){this.transposed_headers=this.columns.filter(e=>"measure"!==e.modelField.type).filter(e=>!e.hide).map(e=>new i.HeaderField({vis:this,queryResponseField:e.modelField}));var e=this.transposed_headers.map(e=>{({})[e.name]=1}),t={align:"left",type:"transposed_table_index",is_table_calculation:!1},n={align:"right",type:"transposed_table_measure",is_table_calculation:!1};this.useHeadings&&!this.hasPivots&&((r=new i.Column("header",this,t)).levels=Object(i.newArray)(this.transposed_headers.length,new i.HeaderField({vis:this,queryResponseField:{}})),r.levels[0]=new i.HeaderField({vis:this,queryResponseField:{name:"header",label:"Header"}}),r.colspans=e,r.type="dimension",this.transposed_columns.push(r)),"getSortByPivots"===this.sortColsBy?(this.pivots.forEach(n=>{var a=new i.Column(n.name,this,t);a.levels=Object(i.newArray)(this.transposed_headers.length,new i.HeaderField({vis:this,queryResponseField:{}})),a.levels[0]=new i.HeaderField({vis:this,queryResponseField:{name:n.name,label:n.label}}),a.colspans=e,this.transposed_columns.push(a)}),(r=new i.Column("measure",this,t)).levels=Object(i.newArray)(this.transposed_headers.length,new i.HeaderField({vis:this,queryResponseField:{}})),r.levels[0]=new i.HeaderField({vis:this,queryResponseField:{name:"measure",label:"Measure"}}),r.colspans=e,this.transposed_columns.push(r)):((r=new i.Column("measure",this,t)).levels=Object(i.newArray)(this.transposed_headers.length,new i.HeaderField({vis:this,queryResponseField:{}})),r.levels[0]=new i.HeaderField({vis:this,queryResponseField:{name:"measure",label:"Measure"}}),r.colspans=e,this.transposed_columns.push(r),this.pivots.forEach(n=>{var a=new i.Column(n.name,this,t);a.levels=Object(i.newArray)(this.transposed_headers.length,new i.HeaderField({vis:this,queryResponseField:{}})),a.levels[0]=new i.HeaderField({vis:this,queryResponseField:{name:n.name,label:n.label}}),a.colspans=e,this.transposed_columns.push(a)}));for(var a=0;a<this.data.length;a++){var r,s=this.data[a];if("line_item"===s.type){var o={},l=[];this.transposed_headers.forEach(e=>{o=this.rowspan_values[s.id],l.push(s.data[e.name].value)})}else"subtotal"===s.type?(o=e,(l=Object(i.newArray)(this.transposed_headers.length,new i.HeaderField({vis:this,queryResponseField:{}})))[0]=new i.HeaderField({vis:this,queryResponseField:{name:"subtotal",label:"Subtotal"}})):"total"===s.type&&(o=e,(l=Object(i.newArray)(this.transposed_headers.length,new i.HeaderField({vis:this,queryResponseField:{}})))[0]=new i.HeaderField({vis:this,queryResponseField:{name:"total",label:"Total"}}));(r=new i.Column(s.id,this,n)).transposed=!0,r.colspan_values=o,r.levels=l,this.transposed_columns.push(r)}}transposeRows(){this.columns.filter(e=>"measure"===e.modelField.type).forEach(e=>{var t={};this.data.forEach(n=>{void 0!==n.data[e.id]?(t[n.id]=n.data[e.id],t[n.id].align="right",void 0!==t[n.id].cell_style?t[n.id].cell_style.push("transposed"):t[n.id].cell_style=["transposed"]):console.log("row data does not exist for",e.id)});var n=e.modelField.heading,a=this.config["heading|"+e.modelField.name];void 0!==a&&(n=a||n),t.header={value:n,cell_style:[]},e.subtotal&&t.header.cell_style.push("subtotal");var r="getSortByPivots"===this.sortColsBy?this.pivots.length:0;this.useHeadings&&!this.hasPivots&&r++,t.measure={value:e.getLabel(r),cell_style:[]},e.subtotal&&t.measure.cell_style.push("subtotal"),e.modelField.style.includes("subtotal")&&t.measure.cell_style.push("subtotal"),this.pivots.forEach((n,a)=>{t[n.name]={value:e.levels[a],cell_style:[]},e.subtotal&&t[n.name].cell_style.push("subtotal")});var s=new i.Row("line_item");s.id=e.id,s.modelField=e.modelField,s.hide=e.hide,s.data=t,this.transposed_data.push(s)})}validateConfig(){["traditional","looker","contemporary","custom"].includes(this.config.theme)||(this.config.theme="traditional"),["fixed","auto"].includes(this.config.layout)||(this.config.layout="fixed"),void 0===this.config.transposeTable&&(this.config.transposeTable=!1),Object.entries(this.config).forEach(e=>{if("false"===e[1]?e[1]=!1:"true"===e[1]&&(e[1]=!0),2===e[0].split("|").length){var[t,n]=e[0].split("|");if(["label","heading","hide","style","switch","var_num","var_pct","comparison"].includes(t)){var a=!1;this.dimensions.forEach(e=>{e.name===n&&(a=!0)}),this.measures.forEach(e=>{e.name===n&&(a=!0)}),a||delete this.config[e[0]]}}})}getColumnById(e){var t={};return this.columns.forEach(n=>{e===n.id&&(t=n)}),t}getMeasureByName(e){var t="";return this.measures.forEach(n=>{e===n.name&&(t=n)}),t}sortData(){this.data.sort((e,t)=>{for(var n=e.sort.length,a=0;a<n;a++){if(e.sort[a]>t.sort[a])return 1;if(e.sort[a]<t.sort[a])return-1}return-1}),this.spanRows&&this.setRowSpans()}getRenderedFromHtml(e){var t=new DOMParser;if(void 0===e.html||["undefined",""].includes(e.html))n=e.value;else try{var n=t.parseFromString(e.html,"text/html").documentElement.textContent}catch(t){n=e.html}return n}getHeaderTiers(){return this.transposeTable?this.dimensions.filter(e=>!e.hide):this.headers}getTableColumnGroups(){var e=[],t=[],n=[];this.transposeTable?this.transposed_columns.forEach(a=>{"transposed_table_index"===a.modelField.type?e.push({id:a.id}):"transposed_table_measure"===a.modelField.type&&"Total"!==a.id?t.push({id:a.id}):"transposed_table_measure"===a.modelField.type&&"Total"===a.id&&n.push({id:a.id})}):this.columns.forEach(a=>{"dimension"!==a.modelField.type||this.useIndexColumn||"$$$_index_$$$"===a.id||a.hide?"dimension"===a.modelField.type&&this.useIndexColumn&&"$$$_index_$$$"===a.id?e.push({id:a.id}):"measure"!==a.modelField.type||a.super||a.hide?"measure"===a.modelField.type&&a.super&&!a.hide&&n.push({id:a.id}):t.push({id:a.id}):e.push({id:a.id})})}getTableHeaders(e){return this.transposeTable?this.transposed_columns.filter(t=>t.colspans[e]>0):this.columns.filter(t=>this.colspan_values[t.id][this.headers[e].name]>0)}getDataRows(){return this.transposeTable?this.transposed_data.filter(e=>!e.hide):this.data}getTableColumns(e){if(this.transposeTable)(t=this.transposed_columns).forEach((t,n)=>{t.rowspan=1,"transposed_table_index"===t.modelField.type&&(t.rowspan=this.colspan_values[e.id][this.headers[n].name])}),t=t.filter(e=>e.rowspan>0);else var t=this.columns.filter(e=>!e.hide).filter(t=>"measure"==t.modelField.type||e.data[t.id].rowspan>0);return t}moveColumns(e,t,n){var a=this.config;if(e!=t){var r=t-e,s=a.columnOrder;this.columns.forEach(n=>{"measure"!=n.modelField.type||n.super||(n.pos>=e&&n.pos<e+10?n.pos+=r:n.pos>=t&&n.pos<e?n.pos+=10:n.pos>=e+10&&n.pos<t+10&&(n.pos-=10),s[n.id]=n.pos)}),n(s)}}getSimpleJson(){var e=[];return this.data.forEach(t=>{if("line_item"===t.type){var n={};this.columns.forEach(e=>{n[e.id]=t.data[e.id].value}),e.push(n)}}),e}}}])},function(e,t,n){var a=n(0),r=n(6);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s,i=0,o={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return i++||(s=a(r,o)),l},l.unuse=function(){i>0&&!--i&&(s(),s=null)},e.exports=l},function(e,t,n){(t=n(1)(!1)).push([e.i,"#tooltip {\n    position: absolute;\n    width: auto;\n    height: auto;\n    padding: 5px;\n    background-color: white;\n    -webkit-border-radius: 4px;\n    -moz-border-radius: 4px;\n    border-radius: 4px;\n    -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    pointer-events: none;\n    font-family: sans-serif;\n    font-size: 12px;\n}\n\n#tooltip.hidden {\n    display: none;\n}\n\n#tooltip p {\n    margin: 0;\n    font-family: sans-serif;\n    font-size: 12px;\n    line-height: 15px;\n}\n\ntable.reportTable {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  font-size: 10px;   \n  /* border: 1px solid #CCCCCC; */\n  border-collapse: separate;\n  border-spacing: 3px;\n  table-layout: fixed;\n}\n\ntable.reportTable th {\n  /* border: 1px solid #CCCCCC; */\n  border-bottom: 1px solid #000000 !important;\n  /* font-size: 10px;  */\n  /* height: 25px; */\n  padding: 5px;\n}\n\ntable.reportTable td {\n  vertical-align: super;\n  padding-left: 5px;\n  /*background: #FFFFFF;*/\n  /* border: 1px solid #CCCCCC; */\n}\n\n.left {\n  text-align: left;\n}\n\n.right {\n  text-align: right !important;\n}\n\n.indent {\n  padding-left: 15px !important;\n}\n\n.subtotal {\n  font-style: italic;\n  font-weight: bold;\n}\n\n.total {\n  border-top: 2px solid #000000 !important;\n  font-weight: bold !important;\n}\n\n.total.transposed {\n  border-top: 0px !important;\n}\n\n.red {\n  color: red;\n}\n",""]),e.exports=t},function(e,t,n){var a=n(0),r=n(8);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s,i=0,o={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return i++||(s=a(r,o)),l},l.unuse=function(){i>0&&!--i&&(s(),s=null)},e.exports=l},function(e,t,n){(t=n(1)(!1)).push([e.i,"#tooltip {\n    position: absolute;\n    width: auto;\n    height: auto;\n    padding: 5px;\n    background-color: white;\n    -webkit-border-radius: 4px;\n    -moz-border-radius: 4px;\n    border-radius: 4px;\n    -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    pointer-events: none;\n    font-family: sans-serif;\n    font-size: 12px;\n}\n\n#tooltip.hidden {\n    display: none;\n}\n\n#tooltip p {\n    margin: 0;\n    font-family: sans-serif;\n    font-size: 12px;\n    line-height: 15px;\n}\n\n/*table.reportTable */\n.reportTable {\n  font-family: Open Sans, Helvetica,Arial,sans-serif;\n  font-size: 12px;   \n  color: #696969;\n  /* border: 1px solid #BDC3C7; */\n  border-collapse: collapse;\n  border-spacing: 3px;\n  table-layout: fixed;\n}\n\n/*table.reportTable th */\nth.headerCell {\n  background-color: #ccd8e4;\n  /*border-bottom: 1px solid #000000 !important;*/\n  /* font-size: 10px;  */\n  /* height: 25px; */\n  padding: 5px;\n}\n\n/*table.reportTable tr */\nth.rowCell {\n  vertical-align: super;\n  padding-left: 5px;\n  border-bottom: 1px solid #BDC3C7; \n}\n\nth.headerCell.dimension {\n  background-color: #e4ecf3;\n  border-right: 1px solid #BDC3C7; \n  border-bottom: 1px solid #BDC3C7; \n}\n\nth.headerCell.measure {\n  background-color: #e4d0bd;\n  border-left: 1px solid #BDC3C7; \n  border-bottom: 1px solid #BDC3C7; \n}\n\nth.headerCell.measure.calculation {\n  background-color: #c9dfc5;\n  border-left: 1px solid #BDC3C7;\n  border-bottom: 1px solid #BDC3C7; \n}\n\nth.headerCell.dimension.headerRow {\n  background-color: #ccd8e4;\n  border-right: 1px solid #BDC3C7;\n  border-bottom: 1px solid #BDC3C7; \n}\n\nth.headerCell.measure.headerRow {\n  background-color: #ccd8e4;\n  border-left: 1px solid #BDC3C7;\n  border-bottom: 1px solid #BDC3C7; \n}\n\n.left {\n  text-align: left;\n}\n\n.right {\n  text-align: right !important;\n}\n\n.indent {\n  padding-left: 15px !important;\n}\n\n.subtotal {\n  font-style: italic;\n  font-weight: bold;\n  background: #D3D3D3;\n}\n\n.total {\n  border-top: 2px solid #696969 !important;\n  font-weight: bold !important;\n}\n\n.total.transposed {\n  border-top: 0px !important;\n  background: #D3D3D3;\n}\n\n.red {\n  color: red;\n}\n\n\n\n/* https://github.com/looker/custom_visualizations_v2/blob/master/src/examples/advanced_table/ag-theme-looker.css */\n\n/* header (dimension/group) background-color: #ccd8e4 */\n/* th.measure background-color: #e4d0bd */\n/* on hover: background-color: #e6e8ec */\n/* odd measure rows (.ag-row-odd) background-color: #f7f2ee */\n/* row number color #c2c2c2 */\n\n/* Looker header cells */\n.ag-theme-looker .ag-header-cell {\n  background-color: #e4ecf3;\n}\n\n.ag-theme-looker .ag-header-cell.measure {\n  background-color: #e4d0bd;\n}\n\n.ag-theme-looker .ag-header-cell.tableCalc {\n  background-color: #c9dfc5;\n}\n\n\n.ag-theme-looker .ag-header-row.pivotHeaderRow {\n  background-color: #ccd8e4;\n}\n\n\n.ag-theme-looker .ag-row-odd {\n  background-color: #f6f8fa; /* default odd row color */\n}\n\n.ag-theme-looker .ag-row-odd .ag-cell.measure {\n  background-color: #f7f2ee;\n}\n\n.ag-theme-looker .ag-row-odd .ag-cell.tableCalc {\n  background-color: #eef7ee;\n}\n\n.ag-theme-looker .ag-row-odd .ag-cell.groupCell {\n  background-color: #f6f8fa;\n}",""]),e.exports=t},function(e,t,n){var a=n(0),r=n(10);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s,i=0,o={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return i++||(s=a(r,o)),l},l.unuse=function(){i>0&&!--i&&(s(),s=null)},e.exports=l},function(e,t,n){(t=n(1)(!1)).push([e.i,"#tooltip {\n    position: absolute;\n    width: auto;\n    height: auto;\n    padding: 5px;\n    background-color: white;\n    -webkit-border-radius: 4px;\n    -moz-border-radius: 4px;\n    border-radius: 4px;\n    -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    pointer-events: none;\n    font-family: sans-serif;\n    font-size: 12px;\n}\n\n#tooltip.hidden {\n    display: none;\n}\n\n#tooltip p {\n    margin: 0;\n    font-family: sans-serif;\n    font-size: 12px;\n    line-height: 15px;\n}\n\ntable.reportTable {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  font-size: 12px;   \n  border: 1px solid #CCCCCC; \n  border-collapse: collapse;\n  border-spacing: 3px;\n}\n\ntable.reportTable th {\n  border: 1px solid #CCCCCC; \n  border-bottom: 1px solid #000000 !important;\n  /* font-size: 10px;  */\n  /* height: 25px; */\n  padding: 5px;\n}\n\ntable.reportTable td {\n  vertical-align: super;\n  padding: 5px;\n  /*background: #FFFFFF;*/\n  border: 1px solid #CCCCCC; \n  border-collapse: collapse;\n}\n\n.left {\n  text-align: left;\n}\n\n.right {\n  text-align: right !important;\n}\n\n.indent {\n  padding-left: 15px !important;\n}\n\n.subtotal {\n  font-style: italic;\n  font-weight: bold;\n  background: #D3D3D3;\n}\n\n.total {\n  border-top: 2px solid #000000 !important;\n  font-weight: bold !important;\n}\n\n.total.transposed {\n  border-top: 0px !important;\n  background: #D3D3D3;\n}\n\n.red {\n  color: red;\n}\n",""]),e.exports=t},function(e,t,n){var a=n(0),r=n(12);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s,i=0,o={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return i++||(s=a(r,o)),l},l.unuse=function(){i>0&&!--i&&(s(),s=null)},e.exports=l},function(e,t,n){(t=n(1)(!1)).push([e.i,"table.reportTable {\n  width: 100%;\n  table-layout: fixed;\n}\n\ntable.reportTable th {\n  max-width: 0px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\ntable.reportTable td {\n  max-width: 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}",""]),e.exports=t},function(e,t,n){var a=n(0),r=n(14);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var s,i=0,o={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return i++||(s=a(r,o)),l},l.unuse=function(){i>0&&!--i&&(s(),s=null)},e.exports=l},function(e,t,n){(t=n(1)(!1)).push([e.i,"table.reportTable { \n  width: 100%;\n  table-layout: auto;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";function a(){}n.r(t),n.d(t,"select",(function(){return ce})),n.d(t,"event",(function(){return K})),n.d(t,"drag",(function(){return Te}));var r=function(e){return null==e?a:function(){return this.querySelector(e)}};function s(){return[]}var i=function(e){return new Array(e.length)};function o(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}o.prototype={constructor:o,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function l(e,t,n,a,r,s){for(var i,l=0,u=t.length,h=s.length;l<h;++l)(i=t[l])?(i.__data__=s[l],a[l]=i):n[l]=new o(e,s[l]);for(;l<u;++l)(i=t[l])&&(r[l]=i)}function u(e,t,n,a,r,s,i){var l,u,h,c={},d=t.length,p=s.length,f=new Array(d);for(l=0;l<d;++l)(u=t[l])&&(f[l]=h="$"+i.call(u,u.__data__,l,t),h in c?r[l]=u:c[h]=u);for(l=0;l<p;++l)(u=c[h="$"+i.call(e,s[l],l,s)])?(a[l]=u,u.__data__=s[l],c[h]=null):n[l]=new o(e,s[l]);for(l=0;l<d;++l)(u=t[l])&&c[f[l]]===u&&(r[l]=u)}function h(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var c="http://www.w3.org/1999/xhtml",d={svg:"http://www.w3.org/2000/svg",xhtml:c,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},p=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),d.hasOwnProperty(t)?{space:d[t],local:e}:e};function f(e){return function(){this.removeAttribute(e)}}function v(e){return function(){this.removeAttributeNS(e.space,e.local)}}function m(e,t){return function(){this.setAttribute(e,t)}}function g(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function b(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function y(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}var _=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function w(e){return function(){this.style.removeProperty(e)}}function x(e,t,n){return function(){this.style.setProperty(e,t,n)}}function C(e,t,n){return function(){var a=t.apply(this,arguments);null==a?this.style.removeProperty(e):this.style.setProperty(e,a,n)}}function k(e,t){return e.style.getPropertyValue(t)||_(e).getComputedStyle(e,null).getPropertyValue(t)}function $(e){return function(){delete this[e]}}function F(e,t){return function(){this[e]=t}}function E(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function M(e){return e.trim().split(/^|\s+/)}function S(e){return e.classList||new A(e)}function A(e){this._node=e,this._names=M(e.getAttribute("class")||"")}function O(e,t){for(var n=S(e),a=-1,r=t.length;++a<r;)n.add(t[a])}function T(e,t){for(var n=S(e),a=-1,r=t.length;++a<r;)n.remove(t[a])}function R(e){return function(){O(this,e)}}function D(e){return function(){T(this,e)}}function H(e,t){return function(){(t.apply(this,arguments)?O:T)(this,e)}}A.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function j(){this.textContent=""}function P(e){return function(){this.textContent=e}}function B(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function q(){this.innerHTML=""}function N(e){return function(){this.innerHTML=e}}function z(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function L(){this.nextSibling&&this.parentNode.appendChild(this)}function V(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function I(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===c&&t.documentElement.namespaceURI===c?t.createElement(e):t.createElementNS(n,e)}}function U(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var G=function(e){var t=p(e);return(t.local?U:I)(t)};function J(){return null}function X(){var e=this.parentNode;e&&e.removeChild(this)}function Y(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Z(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}var W={},K=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(W={mouseenter:"mouseover",mouseleave:"mouseout"}));function Q(e,t,n){return e=ee(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function ee(e,t,n){return function(a){var r=K;K=a;try{e.call(this,this.__data__,t,n)}finally{K=r}}}function te(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function ne(e){return function(){var t=this.__on;if(t){for(var n,a=0,r=-1,s=t.length;a<s;++a)n=t[a],e.type&&n.type!==e.type||n.name!==e.name?t[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?t.length=r:delete this.__on}}}function ae(e,t,n){var a=W.hasOwnProperty(e.type)?Q:ee;return function(r,s,i){var o,l=this.__on,u=a(t,s,i);if(l)for(var h=0,c=l.length;h<c;++h)if((o=l[h]).type===e.type&&o.name===e.name)return this.removeEventListener(o.type,o.listener,o.capture),this.addEventListener(o.type,o.listener=u,o.capture=n),void(o.value=t);this.addEventListener(e.type,u,n),o={type:e.type,name:e.name,value:t,listener:u,capture:n},l?l.push(o):this.__on=[o]}}function re(e,t,n,a){var r=K;e.sourceEvent=K,K=e;try{return t.apply(n,a)}finally{K=r}}function se(e,t,n){var a=_(e),r=a.CustomEvent;"function"==typeof r?r=new r(t,n):(r=a.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function ie(e,t){return function(){return se(this,e,t)}}function oe(e,t){return function(){return se(this,e,t.apply(this,arguments))}}var le=[null];function ue(e,t){this._groups=e,this._parents=t}function he(){return new ue([[document.documentElement]],le)}ue.prototype=he.prototype={constructor:ue,select:function(e){"function"!=typeof e&&(e=r(e));for(var t=this._groups,n=t.length,a=new Array(n),s=0;s<n;++s)for(var i,o,l=t[s],u=l.length,h=a[s]=new Array(u),c=0;c<u;++c)(i=l[c])&&(o=e.call(i,i.__data__,c,l))&&("__data__"in i&&(o.__data__=i.__data__),h[c]=o);return new ue(a,this._parents)},selectAll:function(e){var t;"function"!=typeof e&&(e=null==(t=e)?s:function(){return this.querySelectorAll(t)});for(var n=this._groups,a=n.length,r=[],i=[],o=0;o<a;++o)for(var l,u=n[o],h=u.length,c=0;c<h;++c)(l=u[c])&&(r.push(e.call(l,l.__data__,c,u)),i.push(l));return new ue(r,i)},filter:function(e){var t;"function"!=typeof e&&(t=e,e=function(){return this.matches(t)});for(var n=this._groups,a=n.length,r=new Array(a),s=0;s<a;++s)for(var i,o=n[s],l=o.length,u=r[s]=[],h=0;h<l;++h)(i=o[h])&&e.call(i,i.__data__,h,o)&&u.push(i);return new ue(r,this._parents)},data:function(e,t){if(!e)return m=new Array(this.size()),d=-1,this.each((function(e){m[++d]=e})),m;var n,a=t?u:l,r=this._parents,s=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var i=s.length,o=new Array(i),h=new Array(i),c=new Array(i),d=0;d<i;++d){var p=r[d],f=s[d],v=f.length,m=e.call(p,p&&p.__data__,d,r),g=m.length,b=h[d]=new Array(g),y=o[d]=new Array(g);a(p,f,b,y,c[d]=new Array(v),m,t);for(var _,w,x=0,C=0;x<g;++x)if(_=b[x]){for(x>=C&&(C=x+1);!(w=y[C])&&++C<g;);_._next=w||null}}return(o=new ue(o,r))._enter=h,o._exit=c,o},enter:function(){return new ue(this._enter||this._groups.map(i),this._parents)},exit:function(){return new ue(this._exit||this._groups.map(i),this._parents)},join:function(e,t,n){var a=this.enter(),r=this,s=this.exit();return a="function"==typeof e?e(a):a.append(e+""),null!=t&&(r=t(r)),null==n?s.remove():n(s),a&&r?a.merge(r).order():r},merge:function(e){for(var t=this._groups,n=e._groups,a=t.length,r=n.length,s=Math.min(a,r),i=new Array(a),o=0;o<s;++o)for(var l,u=t[o],h=n[o],c=u.length,d=i[o]=new Array(c),p=0;p<c;++p)(l=u[p]||h[p])&&(d[p]=l);for(;o<a;++o)i[o]=t[o];return new ue(i,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var a,r=e[t],s=r.length-1,i=r[s];--s>=0;)(a=r[s])&&(i&&4^a.compareDocumentPosition(i)&&i.parentNode.insertBefore(a,i),i=a);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=h);for(var n=this._groups,a=n.length,r=new Array(a),s=0;s<a;++s){for(var i,o=n[s],l=o.length,u=r[s]=new Array(l),c=0;c<l;++c)(i=o[c])&&(u[c]=i);u.sort(t)}return new ue(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a=e[t],r=0,s=a.length;r<s;++r){var i=a[r];if(i)return i}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,a=t.length;n<a;++n)for(var r,s=t[n],i=0,o=s.length;i<o;++i)(r=s[i])&&e.call(r,r.__data__,i,s);return this},attr:function(e,t){var n=p(e);if(arguments.length<2){var a=this.node();return n.local?a.getAttributeNS(n.space,n.local):a.getAttribute(n)}return this.each((null==t?n.local?v:f:"function"==typeof t?n.local?y:b:n.local?g:m)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?w:"function"==typeof t?C:x)(e,t,null==n?"":n)):k(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?$:"function"==typeof t?E:F)(e,t)):this.node()[e]},classed:function(e,t){var n=M(e+"");if(arguments.length<2){for(var a=S(this.node()),r=-1,s=n.length;++r<s;)if(!a.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?H:t?R:D)(n,t))},text:function(e){return arguments.length?this.each(null==e?j:("function"==typeof e?B:P)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?q:("function"==typeof e?z:N)(e)):this.node().innerHTML},raise:function(){return this.each(L)},lower:function(){return this.each(V)},append:function(e){var t="function"==typeof e?e:G(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:G(e),a=null==t?J:"function"==typeof t?t:r(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),a.apply(this,arguments)||null)}))},remove:function(){return this.each(X)},clone:function(e){return this.select(e?Z:Y)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var a,r,s=te(e+""),i=s.length;if(!(arguments.length<2)){for(o=t?ae:ne,null==n&&(n=!1),a=0;a<i;++a)this.each(o(s[a],t,n));return this}var o=this.node().__on;if(o)for(var l,u=0,h=o.length;u<h;++u)for(a=0,l=o[u];a<i;++a)if((r=s[a]).type===l.type&&r.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?oe:ie)(e,t))}};var ce=function(e){return"string"==typeof e?new ue([[document.querySelector(e)]],[document.documentElement]):new ue([[e]],le)},de={value:function(){}};function pe(){for(var e,t=0,n=arguments.length,a={};t<n;++t){if(!(e=arguments[t]+"")||e in a||/[\s.]/.test(e))throw new Error("illegal type: "+e);a[e]=[]}return new fe(a)}function fe(e){this._=e}function ve(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",a=e.indexOf(".");if(a>=0&&(n=e.slice(a+1),e=e.slice(0,a)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function me(e,t){for(var n,a=0,r=e.length;a<r;++a)if((n=e[a]).name===t)return n.value}function ge(e,t,n){for(var a=0,r=e.length;a<r;++a)if(e[a].name===t){e[a]=de,e=e.slice(0,a).concat(e.slice(a+1));break}return null!=n&&e.push({name:t,value:n}),e}fe.prototype=pe.prototype={constructor:fe,on:function(e,t){var n,a=this._,r=ve(e+"",a),s=-1,i=r.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++s<i;)if(n=(e=r[s]).type)a[n]=ge(a[n],e.name,t);else if(null==t)for(n in a)a[n]=ge(a[n],e.name,null);return this}for(;++s<i;)if((n=(e=r[s]).type)&&(n=me(a[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new fe(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,a,r=new Array(n),s=0;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=0,n=(a=this._[e]).length;s<n;++s)a[s].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],r=0,s=a.length;r<s;++r)a[r].value.apply(t,n)}};var be=pe,ye=function(){for(var e,t=K;e=t.sourceEvent;)t=e;return t},_e=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var a=n.createSVGPoint();return a.x=t.clientX,a.y=t.clientY,[(a=a.matrixTransform(e.getScreenCTM().inverse())).x,a.y]}var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]},we=function(e){var t=ye();return t.changedTouches&&(t=t.changedTouches[0]),_e(e,t)},xe=function(e,t,n){arguments.length<3&&(n=t,t=ye().changedTouches);for(var a,r=0,s=t?t.length:0;r<s;++r)if((a=t[r]).identifier===n)return _e(e,a);return null};function Ce(){K.stopImmediatePropagation()}var ke=function(){K.preventDefault(),K.stopImmediatePropagation()},$e=function(e){var t=e.document.documentElement,n=ce(e).on("dragstart.drag",ke,!0);"onselectstart"in t?n.on("selectstart.drag",ke,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")};var Fe=function(e){return function(){return e}};function Ee(e,t,n,a,r,s,i,o,l,u){this.target=e,this.type=t,this.subject=n,this.identifier=a,this.active=r,this.x=s,this.y=i,this.dx=o,this.dy=l,this._=u}function Me(){return!K.ctrlKey&&!K.button}function Se(){return this.parentNode}function Ae(e){return null==e?{x:K.x,y:K.y}:e}function Oe(){return navigator.maxTouchPoints||"ontouchstart"in this}Ee.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Te=function(){var e,t,n,a,r=Me,s=Se,i=Ae,o=Oe,l={},u=be("start","drag","end"),h=0,c=0;function d(e){e.on("mousedown.drag",p).filter(o).on("touchstart.drag",m).on("touchmove.drag",g).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(){if(!a&&r.apply(this,arguments)){var i=y("mouse",s.apply(this,arguments),we,this,arguments);i&&(ce(K.view).on("mousemove.drag",f,!0).on("mouseup.drag",v,!0),$e(K.view),Ce(),n=!1,e=K.clientX,t=K.clientY,i("start"))}}function f(){if(ke(),!n){var a=K.clientX-e,r=K.clientY-t;n=a*a+r*r>c}l.mouse("drag")}function v(){var e,t,a,r;ce(K.view).on("mousemove.drag mouseup.drag",null),e=K.view,t=n,a=e.document.documentElement,r=ce(e).on("dragstart.drag",null),t&&(r.on("click.drag",ke,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in a?r.on("selectstart.drag",null):(a.style.MozUserSelect=a.__noselect,delete a.__noselect),ke(),l.mouse("end")}function m(){if(r.apply(this,arguments)){var e,t,n=K.changedTouches,a=s.apply(this,arguments),i=n.length;for(e=0;e<i;++e)(t=y(n[e].identifier,a,xe,this,arguments))&&(Ce(),t("start"))}}function g(){var e,t,n=K.changedTouches,a=n.length;for(e=0;e<a;++e)(t=l[n[e].identifier])&&(ke(),t("drag"))}function b(){var e,t,n=K.changedTouches,r=n.length;for(a&&clearTimeout(a),a=setTimeout((function(){a=null}),500),e=0;e<r;++e)(t=l[n[e].identifier])&&(Ce(),t("end"))}function y(e,t,n,a,r){var s,o,c,p=n(t,e),f=u.copy();if(re(new Ee(d,"beforestart",s,e,h,p[0],p[1],0,0,f),(function(){return null!=(K.subject=s=i.apply(a,r))&&(o=s.x-p[0]||0,c=s.y-p[1]||0,!0)})))return function i(u){var v,m=p;switch(u){case"start":l[e]=i,v=h++;break;case"end":delete l[e],--h;case"drag":p=n(t,e),v=h}re(new Ee(d,u,s,e,v,p[0]+o,p[1]+c,p[0]-m[0],p[1]-m[1],f),f.apply,f,[u,a,r])}}return d.filter=function(e){return arguments.length?(r="function"==typeof e?e:Fe(!!e),d):r},d.container=function(e){return arguments.length?(s="function"==typeof e?e:Fe(e),d):s},d.subject=function(e){return arguments.length?(i="function"==typeof e?e:Fe(e),d):i},d.touchable=function(e){return arguments.length?(o="function"==typeof e?e:Fe(!!e),d):o},d.on=function(){var e=u.on.apply(u,arguments);return e===u?d:e},d.clickDistance=function(e){return arguments.length?(c=(e=+e)*e,d):Math.sqrt(c)},d}}]);
//# sourceMappingURL=report_table.js.map