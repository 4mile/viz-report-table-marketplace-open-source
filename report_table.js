!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=18)}([,function(e,t,n){var a={};!function(e){function t(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function n(e,t){for(var n="";n.length<t;)n+=e;return n}function a(e,t){var a=""+e;return a.length>=t?a:n("0",t-a.length)+a}function r(e,t){var a=""+e;return a.length>=t?a:n(" ",t-a.length)+a}function i(e,t){var a=""+e;return a.length>=t?a:a+n(" ",t-a.length)}e.version="0.11.2";var o=Math.pow(2,32);function s(e,t){return e>o||e<-o?function(e,t){var a=""+Math.round(e);return a.length>=t?a:n("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:n("0",t-a.length)+a}(Math.round(e),t)}function l(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],c=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "'}var h={};d(h);var f=[],p=0;for(p=5;p<=8;++p)f[p]=32+p;for(p=23;p<=26;++p)f[p]=0;for(p=27;p<=31;++p)f[p]=14;for(p=50;p<=58;++p)f[p]=14;for(p=59;p<=62;++p)f[p]=p-58;for(p=67;p<=68;++p)f[p]=p-58;for(p=72;p<=75;++p)f[p]=p-58;for(p=67;p<=68;++p)f[p]=p-57;for(p=76;p<=78;++p)f[p]=p-56;for(p=79;p<=81;++p)f[p]=p-34;var m=[];function v(e,t,n){for(var a=e<0?-1:1,r=e*a,i=0,o=1,s=0,l=1,u=0,c=0,d=Math.floor(r);u<t&&(s=(d=Math.floor(r))*o+i,c=d*u+l,!(r-d<5e-8));)r=1/(r-d),i=o,o=s,l=u,u=c;if(c>t&&(u>t?(c=l,s=i):(c=u,s=o)),!n)return[0,a*s,c];var h=Math.floor(a*s/c);return[h,a*s-h*c,c]}function g(e,t,n){if(e>2958465||e<0)return null;var a=0|e,r=Math.floor(86400*(e-a)),i=0,o=[],s={D:a,T:r,u:86400*(e-a)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(a+=1462),s.u>.9999&&(s.u=0,86400==++r&&(s.T=r=0,++a,++s.D)),60===a)o=n?[1317,10,29]:[1900,2,29],i=3;else if(0===a)o=n?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),a<60&&(i=(i+6)%7),n&&(i=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=r%60,r=Math.floor(r/60),s.M=r%60,r=Math.floor(r/60),s.H=r,s.q=i,s}m[5]=m[63]='"$"#,##0_);\\("$"#,##0\\)',m[6]=m[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',m[7]=m[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',m[8]=m[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',m[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',m[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',m[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',m[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)',e.parse_date_code=g;var y=new Date(1899,11,31,0,0,0),b=y.getTime(),_=new Date(1900,2,1,0,0,0);function w(e,t){var n=e.getTime();return t?n-=1262304e5:e>=_&&(n+=864e5),(n-(b+6e4*(e.getTimezoneOffset()-y.getTimezoneOffset())))/864e5}e._general_int=function(e){return e.toString(10)};var x=function(){var e=/(?:\.0*|(\.\d*[1-9])0+)$/;function t(t){return-1==t.indexOf(".")?t:t.replace(e,"$1")}var n=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,a=/(E[+-])(\d)$/;return function(e){var r,i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return r=i>=-4&&i<=-1?e.toPrecision(10+i):Math.abs(i)<=9?function(e){var n=e<0?12:11,a=t(e.toFixed(12));return a.length<=n||(a=e.toPrecision(10)).length<=n?a:e.toExponential(5)}(e):10===i?e.toFixed(10).substr(0,12):function(e){var n=t(e.toFixed(11));return n.length>(e<0?12:11)||"0"===n||"-0"===n?e.toPrecision(6):n}(e),t(function(e){return-1==e.indexOf("E")?e:e.replace(n,"$1E").replace(a,"$10$2")}(r.toUpperCase()))}}();function C(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):x(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return D(14,w(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}e._general_num=x,e._general=C;"๐๑๒๓๔๕๖๗๘๙".split("");function k(e,t,n,r){var i,o="",s=0,l=0,d=n.y,h=0;switch(e){case 98:d=n.y+543;case 121:switch(t.length){case 1:case 2:i=d%100,h=2;break;default:i=d%1e4,h=4}break;case 109:switch(t.length){case 1:case 2:i=n.m,h=t.length;break;case 3:return c[n.m-1][1];case 5:return c[n.m-1][0];default:return c[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=n.d,h=t.length;break;case 3:return u[n.q][0];default:return u[n.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(n.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=n.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=n.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(l=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(l*(n.S+n.u)))>=60*l&&(s=0),"s"===t?0===s?"0":""+s/l:(o=a(s,2+r),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):a(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*n.D+n.H;break;case"[m]":case"[mm]":i=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":i=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}h=3===t.length?1:2;break;case 101:i=d,h=1}return h>0?a(i,h):""}function $(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var E=function(){var e=/%/g;var o=/# (\?+)( ?)\/( ?)(\d+)/;var l=/^#*0*\.([0#]+)/,u=/\).*[0#]/,c=/\(###\) ###\\?-####/;function d(e){for(var t,n="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function h(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function f(e,t){var n=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(n*a)).length?0:Math.round(n*a)}function p(m,g,y){if(40===m.charCodeAt(0)&&!g.match(u)){var b=g.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return y>=0?p("n",b,y):"("+p("n",b,-y)+")"}if(44===g.charCodeAt(g.length-1))return function(e,t,n){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return E(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}(m,g,y);if(-1!==g.indexOf("%"))return function(t,a,r){var i=a.replace(e,""),o=a.length-i.length;return E(t,i,r*Math.pow(10,2*o))+n("%",o)}(m,g,y);if(-1!==g.indexOf("E"))return function e(t,n){var a,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var i=t.indexOf(".");-1===i&&(i=t.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),-1===(a=(n/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).indexOf("e")){var s=Math.floor(Math.log(n)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(s-a.length+o):a+="E+"+(s-o);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,i)+"."+a.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,a){return t+n+a.substr(0,(i+o)%i)+"."+a.substr(o)+"E"}))}else a=n.toExponential(r);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(g,y);if(36===g.charCodeAt(0))return"$"+p(m,g.substr(" "==g.charAt(1)?2:1),y);var _,w,x,C,k=Math.abs(y),S=y<0?"-":"";if(g.match(/^00+$/))return S+s(k,g.length);if(g.match(/^[#?]+$/))return"0"===(_=s(y,0))&&(_=""),_.length>g.length?_:d(g.substr(0,g.length-_.length))+_;if(w=g.match(o))return function(e,t,i){var o=parseInt(e[4],10),s=Math.round(t*o),l=Math.floor(s/o),u=s-l*o,c=o;return i+(0===l?"":""+l)+" "+(0===u?n(" ",e[1].length+1+e[4].length):r(u,e[1].length)+e[2]+"/"+e[3]+a(c,e[4].length))}(w,k,S);if(g.match(/^#+0+$/))return S+s(k,g.length-g.indexOf("0"));if(w=g.match(l))return _=h(y,w[1].length).replace(/^([^\.]+)$/,"$1."+d(w[1])).replace(/\.$/,"."+d(w[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+n("0",d(w[1]).length-t.length)})),-1!==g.indexOf("0.")?_:_.replace(/^0\./,".");if(g=g.replace(/^#+([0.])/,"$1"),w=g.match(/^(0*)\.(#*)$/))return S+h(k,w[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,w[1].length?"0.":".");if(w=g.match(/^#{1,3},##0(\.?)$/))return S+$(s(k,0));if(w=g.match(/^#,##0\.([#0]*0)$/))return y<0?"-"+p(m,g,-y):$(""+(Math.floor(y)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(y,w[1].length)))+"."+a(f(y,w[1].length),w[1].length);if(w=g.match(/^#,#*,#0/))return p(m,g.replace(/^#,#*,/,""),y);if(w=g.match(/^([0#]+)(\\?-([0#]+))+$/))return _=t(p(m,g.replace(/[\\-]/g,""),y)),x=0,t(t(g.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return x<_.length?_.charAt(x++):"0"===e?"0":""})));if(g.match(c))return"("+(_=p(m,"##########",y)).substr(0,3)+") "+_.substr(3,3)+"-"+_.substr(6);var F="";if(w=g.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(w[4].length,7),C=v(k,Math.pow(10,x)-1,!1),_=""+S," "==(F=E("n",w[1],C[1])).charAt(F.length-1)&&(F=F.substr(0,F.length-1)+"0"),_+=F+w[2]+"/"+w[3],(F=i(C[2],x)).length<w[4].length&&(F=d(w[4].substr(w[4].length-F.length))+F),_+=F;if(w=g.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(Math.max(w[1].length,w[4].length),7),S+((C=v(k,Math.pow(10,x)-1,!0))[0]||(C[1]?"":"0"))+" "+(C[1]?r(C[1],x)+w[2]+"/"+w[3]+i(C[2],x):n(" ",2*x+1+w[2].length+w[3].length));if(w=g.match(/^[#0?]+$/))return _=s(y,0),g.length<=_.length?_:d(g.substr(0,g.length-_.length))+_;if(w=g.match(/^([#0?]+)\.([#0]+)$/)){_=""+y.toFixed(Math.min(w[2].length,10)).replace(/([^0])0+$/,"$1"),x=_.indexOf(".");var T=g.indexOf(".")-x,M=g.length-_.length-T;return d(g.substr(0,T)+_+g.substr(g.length-M))}if(w=g.match(/^00,000\.([#0]*0)$/))return x=f(y,w[1].length),y<0?"-"+p(m,g,-y):$(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(y)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(x,w[1].length);switch(g){case"###,##0.00":return p(m,"#,##0.00",y);case"###,###":case"##,###":case"#,###":var A=$(s(k,0));return"0"!==A?S+A:"";case"###,###.00":return p(m,"###,##0.00",y).replace(/^0\./,".");case"#,###.00":return p(m,"#,##0.00",y).replace(/^0\./,".")}throw new Error("unsupported format |"+g+"|")}function m(s,h,f){if(40===s.charCodeAt(0)&&!h.match(u)){var p=h.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?m("n",p,f):"("+m("n",p,-f)+")"}if(44===h.charCodeAt(h.length-1))return function(e,t,n){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return E(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}(s,h,f);if(-1!==h.indexOf("%"))return function(t,a,r){var i=a.replace(e,""),o=a.length-i.length;return E(t,i,r*Math.pow(10,2*o))+n("%",o)}(s,h,f);if(-1!==h.indexOf("E"))return function e(t,n){var a,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var i=t.indexOf(".");-1===i&&(i=t.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),!(a=(n/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).match(/[Ee]/)){var s=Math.floor(Math.log(n)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(s-a.length+o):a+="E+"+(s-o),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,a){return t+n+a.substr(0,(i+o)%i)+"."+a.substr(o)+"E"}))}else a=n.toExponential(r);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(h,f);if(36===h.charCodeAt(0))return"$"+m(s,h.substr(" "==h.charAt(1)?2:1),f);var g,y,b,_,w=Math.abs(f),x=f<0?"-":"";if(h.match(/^00+$/))return x+a(w,h.length);if(h.match(/^[#?]+$/))return g=""+f,0===f&&(g=""),g.length>h.length?g:d(h.substr(0,h.length-g.length))+g;if(y=h.match(o))return function(e,t,a){return a+(0===t?"":""+t)+n(" ",e[1].length+2+e[4].length)}(y,w,x);if(h.match(/^#+0+$/))return x+a(w,h.length-h.indexOf("0"));if(y=h.match(l))return g=(g=(""+f).replace(/^([^\.]+)$/,"$1."+d(y[1])).replace(/\.$/,"."+d(y[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+n("0",d(y[1]).length-t.length)})),-1!==h.indexOf("0.")?g:g.replace(/^0\./,".");if(h=h.replace(/^#+([0.])/,"$1"),y=h.match(/^(0*)\.(#*)$/))return x+(""+w).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,y[1].length?"0.":".");if(y=h.match(/^#{1,3},##0(\.?)$/))return x+$(""+w);if(y=h.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+m(s,h,-f):$(""+f)+"."+n("0",y[1].length);if(y=h.match(/^#,#*,#0/))return m(s,h.replace(/^#,#*,/,""),f);if(y=h.match(/^([0#]+)(\\?-([0#]+))+$/))return g=t(m(s,h.replace(/[\\-]/g,""),f)),b=0,t(t(h.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return b<g.length?g.charAt(b++):"0"===e?"0":""})));if(h.match(c))return"("+(g=m(s,"##########",f)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var C="";if(y=h.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(y[4].length,7),_=v(w,Math.pow(10,b)-1,!1),g=""+x," "==(C=E("n",y[1],_[1])).charAt(C.length-1)&&(C=C.substr(0,C.length-1)+"0"),g+=C+y[2]+"/"+y[3],(C=i(_[2],b)).length<y[4].length&&(C=d(y[4].substr(y[4].length-C.length))+C),g+=C;if(y=h.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(y[1].length,y[4].length),7),x+((_=v(w,Math.pow(10,b)-1,!0))[0]||(_[1]?"":"0"))+" "+(_[1]?r(_[1],b)+y[2]+"/"+y[3]+i(_[2],b):n(" ",2*b+1+y[2].length+y[3].length));if(y=h.match(/^[#0?]+$/))return g=""+f,h.length<=g.length?g:d(h.substr(0,h.length-g.length))+g;if(y=h.match(/^([#0]+)\.([#0]+)$/)){g=""+f.toFixed(Math.min(y[2].length,10)).replace(/([^0])0+$/,"$1"),b=g.indexOf(".");var k=h.indexOf(".")-b,S=h.length-g.length-k;return d(h.substr(0,k)+g+h.substr(h.length-S))}if(y=h.match(/^00,000\.([#0]*0)$/))return f<0?"-"+m(s,h,-f):$(""+f).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(0,y[1].length);switch(h){case"###,###":case"##,###":case"#,###":var F=$(""+w);return"0"!==F?x+F:"";default:if(h.match(/\.[0#?]*$/))return m(s,h.slice(0,h.lastIndexOf(".")),f)+d(h.slice(h.lastIndexOf(".")))}throw new Error("unsupported format |"+h+"|")}return function(e,t,n){return(0|n)===n?m(e,t,n):p(e,t,n)}}();function S(e){for(var t=[],n=!1,a=0,r=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:n=!n;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(r,a-r),r=a+1}if(t[t.length]=e.substr(r),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=S;var F=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function T(e){for(var t=0,n="",a="";t<e.length;)switch(n=e.charAt(t)){case"G":l(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=n;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(F))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":default:++t}return!1}function M(e,t,n,a){for(var r,i,o,s=[],u="",c=0,d="",h="t",f="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!l(e,c))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(u="";34!==(o=e.charCodeAt(++c))&&c<e.length;)u+=String.fromCharCode(o);s[s.length]={t:"t",v:u},++c;break;case"\\":var p=e.charAt(++c),m="("===p||")"===p?p:"t";s[s.length]={t:m,v:p},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==r&&null==(r=g(t,n,"2"===e.charAt(c+1))))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==r&&null==(r=g(t,n)))return"";for(u=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)u+=d;"m"===d&&"h"===h.toLowerCase()&&(d="M"),"h"===d&&(d=f),s[s.length]={t:d,v:u},h=d;break;case"A":case"a":case"上":var v={t:d,v:d};if(null==r&&(r=g(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=r&&(v.v=r.H>=12?"P":"A"),v.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=r&&(v.v=r.H>=12?"PM":"AM"),v.t="T",c+=5,f="h"):"上午/下午"===e.substr(c,5).toUpperCase()?(null!=r&&(v.v=r.H>=12?"下午":"上午"),v.t="T",c+=5,f="h"):(v.t="t",++c),null==r&&"T"===v.t)return"";s[s.length]=v,h=d;break;case"[":for(u=d;"]"!==e.charAt(c++)&&c<e.length;)u+=e.charAt(c);if("]"!==u.slice(-1))throw'unterminated "[" block: |'+u+"|";if(u.match(F)){if(null==r&&null==(r=g(t,n)))return"";s[s.length]={t:"Z",v:u.toLowerCase()},h=u.charAt(1)}else u.indexOf("$")>-1&&(u=(u.match(/\$([^-\[\]]*)/)||[])[1]||"$",T(e)||(s[s.length]={t:"t",v:u}));break;case".":if(null!=r){for(u=d;++c<e.length&&"0"===(d=e.charAt(c));)u+=d;s[s.length]={t:"s",v:u};break}case"0":case"#":for(u=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)u+=d;s[s.length]={t:"n",v:u};break;case"?":for(u=d;e.charAt(++c)===d;)u+=d;s[s.length]={t:d,v:u},h=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":s[s.length]={t:1===a?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(u=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)u+=e.charAt(c);s[s.length]={t:"D",v:u};break;case" ":s[s.length]={t:d,v:d},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++c}var y,b=0,_=0;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=f,h="h",b<1&&(b=1);break;case"s":(y=s[c].v.match(/\.0+$/))&&(_=Math.max(_,y[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":"s"===h&&(s[c].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&s[c].v.match(/[Hh]/)&&(b=1),b<2&&s[c].v.match(/[Mm]/)&&(b=2),b<3&&s[c].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M),r.M>=60&&(r.M=0,++r.H);break;case 2:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M)}var w,x="";for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=k(s[c].t.charCodeAt(0),s[c].v,r,_),s[c].t="t";break;case"n":case"?":for(w=c+1;null!=s[w]&&("?"===(d=s[w].t)||"D"===d||(" "===d||"t"===d)&&null!=s[w+1]&&("?"===s[w+1].t||"t"===s[w+1].t&&"/"===s[w+1].v)||"("===s[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===s[w].v||" "===s[w].v&&null!=s[w+1]&&"?"==s[w+1].t));)s[c].v+=s[w].v,s[w]={v:"",t:";"},++w;x+=s[c].v,c=w-1;break;case"G":s[c].t="t",s[c].v=C(t,n)}var $,S,M="";if(x.length>0){40==x.charCodeAt(0)?($=t<0&&45===x.charCodeAt(0)?-t:t,S=E("n",x,$)):(S=E("n",x,$=t<0&&a>1?-t:t),$<0&&s[0]&&"t"==s[0].t&&(S=S.substr(1),s[0].v="-"+s[0].v)),w=S.length-1;var A=s.length;for(c=0;c<s.length;++c)if(null!=s[c]&&"t"!=s[c].t&&s[c].v.indexOf(".")>-1){A=c;break}var O=s.length;if(A===s.length&&-1===S.indexOf("E")){for(c=s.length-1;c>=0;--c)null!=s[c]&&-1!=="n?".indexOf(s[c].t)&&(w>=s[c].v.length-1?(w-=s[c].v.length,s[c].v=S.substr(w+1,s[c].v.length)):w<0?s[c].v="":(s[c].v=S.substr(0,w+1),w=-1),s[c].t="t",O=c);w>=0&&O<s.length&&(s[O].v=S.substr(0,w+1)+s[O].v)}else if(A!==s.length&&-1===S.indexOf("E")){for(w=S.indexOf(".")-1,c=A;c>=0;--c)if(null!=s[c]&&-1!=="n?".indexOf(s[c].t)){for(i=s[c].v.indexOf(".")>-1&&c===A?s[c].v.indexOf(".")-1:s[c].v.length-1,M=s[c].v.substr(i+1);i>=0;--i)w>=0&&("0"===s[c].v.charAt(i)||"#"===s[c].v.charAt(i))&&(M=S.charAt(w--)+M);s[c].v=M,s[c].t="t",O=c}for(w>=0&&O<s.length&&(s[O].v=S.substr(0,w+1)+s[O].v),w=S.indexOf(".")+1,c=A;c<s.length;++c)if(null!=s[c]&&(-1!=="n?(".indexOf(s[c].t)||c===A)){for(i=s[c].v.indexOf(".")>-1&&c===A?s[c].v.indexOf(".")+1:0,M=s[c].v.substr(0,i);i<s[c].v.length;++i)w<S.length&&(M+=S.charAt(w++));s[c].v=M,s[c].t="t",O=c}}}for(c=0;c<s.length;++c)null!=s[c]&&"n?".indexOf(s[c].t)>-1&&($=a>1&&t<0&&c>0&&"-"===s[c-1].v?-t:t,s[c].v=E(s[c].t,s[c].v,$),s[c].t="t");var N="";for(c=0;c!==s.length;++c)null!=s[c]&&(N+=s[c].v);return N}e.is_date=T,e._eval=M;var A=/\[[=<>]/,O=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function N(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function D(e,t,n){null==n&&(n={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(a=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:h)[e])&&(a=n.table&&n.table[f[e]]||h[f[e]]),null==a&&(a=m[e]||"General")}if(l(a,0))return C(t,n);t instanceof Date&&(t=w(t,n.date1904));var r=function(e,t){var n=S(e),a=n.length,r=n[a-1].indexOf("@");if(a<4&&r>-1&&--a,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!=typeof t)return[4,4===n.length||r>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=r>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=r>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=r>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[a,i];if(null!=n[0].match(A)||null!=n[1].match(A)){var o=n[0].match(O),s=n[1].match(O);return N(t,o)?[a,n[0]]:N(t,s)?[a,n[1]]:[a,n[null!=o&&null!=s?2:1]]}return[a,i]}(a,t);if(l(r[1]))return C(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return M(r[1],t,n,r[0])}function R(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(null!=h[n]){if(h[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return h[t]=e,t}e.load=R,e._table=h,e.get_table=function(){return h},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&R(e[t],t)},e.init_table=d,e.format=D}(a),"undefined"==typeof DO_NOT_EXPORT_SSF&&(e.exports=a)},function(e,t,n){"use strict";var a,r=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function s(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},a=[],r=0;r<e.length;r++){var i=e[r],l=t.base?i[0]+t.base:i[0],u=n[l]||0,c="".concat(l," ").concat(u);n[l]=u+1;var d=s(c),h={css:i[1],media:i[2],sourceMap:i[3]};-1!==d?(o[d].references++,o[d].updater(h)):o.push({identifier:c,updater:v(h,t),references:1}),a.push(c)}return a}function u(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var r=n.nc;r&&(a.nonce=r)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,d=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function h(e,t,n,a){var r=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=d(t,r);else{var i=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function f(e,t,n){var a=n.css,r=n.media,i=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),i&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var p=null,m=0;function v(e,t){var n,a,r;if(t.singleton){var i=m++;n=p||(p=u(t)),a=h.bind(null,n,i,!1),r=h.bind(null,n,i,!0)}else n=u(t),a=f.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var r=s(n[a]);o[r].references--}for(var i=l(e,t),u=0;u<n.length;u++){var c=s(n[u]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}n=i}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var r=(o=a,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),i=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[n].concat(i).concat([r]).join("\n")}var o,s,l;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&r[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},,,,,function(e,t,n){var a=n(2),r=n(9);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i,o=0,s={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return o++||(i=a(r,s)),l},l.unuse=function(){o>0&&!--o&&(i(),i=null)},e.exports=l},function(e,t,n){(t=n(3)(!1)).push([e.i,"#tooltip {\n    position: absolute;\n    width: auto;\n    height: auto;\n    padding: 5px;\n    background-color: white;\n    -webkit-border-radius: 4px;\n    -moz-border-radius: 4px;\n    border-radius: 4px;\n    -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    pointer-events: none;\n    font-family: sans-serif;\n    font-size: 12px;\n    z-index: 2;\n}\n\n.tooltipTable {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  border: 0px;\n  border-collapse: collapse;\n  table-layout: auto;\n}\n\n.focus {\n  font-weight: bold;\n}\n\n.hidden {\n    display: none;\n}\n\n.hover {\n  background-color: #ffffbb;\n}\n\n.reportTable {\n  font-family: Open Sans,Helvetica,Arial,Noto Sans SC,Noto Sans TC,sans-serif;\n  border-collapse: separate;\n  border-spacing: 3px;\n  table-layout: fixed;\n}\n\nth.headerCell {\n  border-bottom: 1px solid #000000 !important;\n  font-weight: bold;\n  padding: 5px;\n}\n\n.headerCell.merged {\n  text-align: center !important;\n  background-color: #ffffff !important;\n}\n\n.headerCell.transposed.dimension.merged {\n  text-align: center !important;\n  background-color: #ffffff !important;\n}\n\n.indexCell.transposed {\n  font-weight: bold;\n}\n\n.indexCell.transposed.merged {\n  background-color: #ffffff !important;\n}\n\n.rowCell {\n  vertical-align: super;\n  padding-left: 5px;\n}\n\n.rowCell.merged {\n  background-color: #ffffff !important;\n}\n\n.rowCell.transposed.dimension.merged {\n  background-color: #ffffff !important;\n}\n\n.nonNumeric {\n  text-align: left;\n}\n\n.numeric {\n  text-align: right;\n}\n\n.negative {\n  color: red;\n}\n\n.estimate {\n  color: darkgray !important;\n}\n\n.singleIndex {\n  padding-left: 15px !important;\n}\n\n.subtotal {\n  font-style: italic;\n  font-weight: bold !important;\n}\n\n.total {\n  border-top: 2px solid #000000;\n  font-weight: bold !important;\n}\n\n.total.transposed {\n  border-top: 0px !important;\n}\n\n.dimension.transposed {\n  font-weight: bold;\n}\n\n.rectElem.animated {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  padding: 4px;\n}\n\n.headerCell.animated {\n  border-bottom: 4px solid #ffffff;\n  box-shadow: inset 0px -1px 0px 0px #000000 !important;\n  font-weight: bold;\n  padding: 5px;\n  box-sizing: border-box;\n}",""]),e.exports=t},function(e,t,n){var a=n(2),r=n(11);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i,o=0,s={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return o++||(i=a(r,s)),l},l.unuse=function(){o>0&&!--o&&(i(),i=null)},e.exports=l},function(e,t,n){(t=n(3)(!1)).push([e.i,"#tooltip {\n    position: absolute;\n    width: auto;\n    height: auto;\n    padding: 5px;\n    background-color: white;\n    -webkit-border-radius: 4px;\n    -moz-border-radius: 4px;\n    border-radius: 4px;\n    -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    pointer-events: none;\n    font-family: sans-serif;\n    font-size: 12px;\n    z-index: 2;\n}\n\n.tooltipTable {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  border: 0px;\n  border-collapse: collapse;\n  table-layout: auto;\n}\n\n.focus {\n  font-weight: bold;\n}\n\n.hidden {\n    display: none;\n}\n\n.hover {\n  background-color: #ffffbb;\n}\n\n.reportTable {\n  font-family: Open Sans,Helvetica,Arial,Noto Sans SC,Noto Sans TC,sans-serif;\n  color: #696969;\n  border-collapse: collapse;\n  border-spacing: 3px;\n  table-layout: fixed;\n}\n\nth.headerCell {\n  background-color: #ccd8e4;\n  padding: 5px;\n  border-bottom: 1px solid #BDC3C7;\n}\n\n.headerCell.dimension {\n  background-color: #e4ecf3;\n  border-right: 1px solid #BDC3C7; \n}\n\n.headerCell.pivot {\n  background-color: #ccd8e4;\n  border-right: 1px solid #BDC3C7; \n}\n\n.headerCell.measure {\n  background-color: #e4d0bd;\n  border-left: 1px solid #BDC3C7; \n}\n\n.headerCell.measure.calculation {\n  background-color: #c9dfc5;\n  border-left: 1px solid #BDC3C7;\n}\n\n.headerCell.transposed.dimension {\n  background-color: #e4ecf3;\n}\n\n.headerCell.transposed.dimension.merged {\n  background-color: #e4ecf3 !important;\n}\n\n/* .headerCell.dimension.headerRow {\n  background-color: #ccd8e4;\n  border-right: 1px solid #BDC3C7;\n}\n\n.headerCell.pivot.headerRow {\n  background-color: #ccd8e4;\n  border-right: 1px solid #BDC3C7;\n}\n\n.headerCell.measure.headerRow {\n  background-color: #ccd8e4;\n  border-left: 1px solid #BDC3C7;\n} */\n\n.rowCell {\n  vertical-align: super;\n  padding-left: 5px;\n  border-bottom: 1px solid #BDC3C7; \n}\n\n.rowCell.merged {\n  background-color: #ffffff !important;\n}\n\n.indexCell.transposed {\n  font-weight: bold;\n}\n\n.indexCell.transposed.pivot {\n  background-color: #ccd8e4;\n}\n\n.indexCell.transposed.dimension {\n  background-color: #e4ecf3;\n}\n\n.indexCell.transposed.measure {\n  background-color: #e4d0bd;\n}\n\n.indexCell.transposed.calculation {\n  background-color: #c9dfc5;\n}\n\n.indexCell.transposed.pivot.merged {\n  background-color: #ccd8e4 !important;\n}\n\n.indexCell.transposed.dimension.merged {\n  background-color: #e4ecf3 !important;\n}\n\n.indexCell.transposed.measure.merged {\n  background-color: #e4d0bd !important;\n}\n\n.indexCell.transposed.calculation.merged {\n  background-color: #c9dfc5 !important;\n}\n\n.nonNumeric {\n  text-align: left;\n}\n\n.numeric {\n  text-align: right;\n}\n\n.negative {\n  color: red;\n}\n\n.estimate {\n  color: darkgray !important;\n}\n\n.singleIndex {\n  padding-left: 15px !important;\n}\n\n.subtotal {\n  font-style: italic;\n  font-weight: bold;\n  background: #D3D3D3;\n}\n\n.total {\n  border-top: 2px solid #696969 !important;\n  font-weight: bold !important;\n}\n\n.total.transposed {\n  border-top: 0px !important;\n  background: #D3D3D3;\n}\n\n.rectElem.animated {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  margin: 4px;\n}",""]),e.exports=t},function(e,t,n){var a=n(2),r=n(13);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i,o=0,s={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return o++||(i=a(r,s)),l},l.unuse=function(){o>0&&!--o&&(i(),i=null)},e.exports=l},function(e,t,n){(t=n(3)(!1)).push([e.i,"#tooltip {\n    position: absolute;\n    width: auto;\n    height: auto;\n    padding: 5px;\n    background-color: white;\n    -webkit-border-radius: 4px;\n    -moz-border-radius: 4px;\n    border-radius: 4px;\n    -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);\n    pointer-events: none;\n    font-family: sans-serif;\n    font-size: 12px;\n    z-index: 2;\n}\n\n.tooltipTable {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  border: 0px;\n  border-collapse: collapse;\n  table-layout: auto;\n}\n\n.focus {\n  font-weight: bold;\n}\n\n.hidden {\n    display: none;\n}\n\n.hover {\n  background-color: #ffffbb;\n}\n\n.reportTable {\n  font-family: Open Sans,Helvetica,Arial,Noto Sans SC,Noto Sans TC,sans-serif;\n  border: 1px solid #CCCCCC; \n  border-collapse: collapse;\n  border-spacing: 3px;\n}\n\ntable.reportTable th {\n  border: 1px solid #CCCCCC; \n  border-bottom: 1px solid #000000 !important;\n  padding: 5px;\n}\n\ntable.reportTable td {\n  vertical-align: super;\n  padding: 5px;\n  border: 1px solid #CCCCCC; \n  border-collapse: collapse;\n}\n\n.headerCell {\n  border-bottom: 1px solid #000000 !important;\n  font-weight: bold;\n  padding: 5px;\n}\n\n.indexCell.transposed {\n  font-weight: bold;\n}\n\n.indexCell.transposed.merged {\n  background-color: #ffffff !important;\n}\n\n.rowCell {\n  vertical-align: super;\n  padding-left: 5px;\n}\n\n.nonNumeric {\n  text-align: left;\n}\n\n.numeric {\n  text-align: right;\n}\n\n.negative {\n  color: red;\n}\n\n.estimate {\n  color: darkgray !important;\n}\n\n.singleIndex {\n  padding-left: 15px !important;\n}\n\n.subtotal {\n  font-style: italic;\n  font-weight: bold;\n  background: #D3D3D3;\n}\n\n.total {\n  border-top: 2px solid #000000 !important;\n  font-weight: bold !important;\n}\n\n.total.transposed {\n  border-top: 0px !important;\n  background: #D3D3D3;\n}\n\n.rectElem.animated {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  margin: 4px;\n}",""]),e.exports=t},function(e,t,n){var a=n(2),r=n(15);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i,o=0,s={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return o++||(i=a(r,s)),l},l.unuse=function(){o>0&&!--o&&(i(),i=null)},e.exports=l},function(e,t,n){(t=n(3)(!1)).push([e.i,"#visContainer {\n  position: absolute;\n  z-index: 0;\n}\n\n#visSvg {\n  position: absolute;\n  z-index: 1;\n}\n\ntable.reportTable {\n  width: 100%;\n  table-layout: fixed;\n  opacity: 0;\n  transition: opacity 1000ms;\n}\n\ntable.reportTable.reveal {\n  opacity: 1;\n  transition: opacity 1000ms;\n}\n\ntable.reportTable th {\n  max-width: 0px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\ntable.reportTable td {\n  max-width: 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.rectElem.animated {\n  font-family: Open Sans,Helvetica,Arial,sans-serif;\n  margin: 4px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n",""]),e.exports=t},function(e,t,n){var a=n(2),r=n(17);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i,o=0,s={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};l.locals=r.locals||{},l.use=function(){return o++||(i=a(r,s)),l},l.unuse=function(){o>0&&!--o&&(i(),i=null)},e.exports=l},function(e,t,n){(t=n(3)(!1)).push([e.i,"#visContainer {\n  position: absolute;\n  z-index: 0;\n}\n\n#visSvg {\n  position: absolute;\n  z-index: 1;\n}\n\ntable.reportTable { \n  width: 100%;\n  table-layout: auto;\n  opacity: 0;\n  transition: opacity 1000ms;\n}\n\ntable.reportTable.reveal {\n  opacity: 1;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a);class i{constructor({vis:e,queryResponseField:t}){this.vis=e,this.name=t.name,this.view=t.view_label||"",this.label=t.field_group_variant||t.label_short||t.label,this.is_numeric=void 0!==t.is_numeric&&t.is_numeric,this.is_array=["list","number_list","location","tier"].includes(t.type),this.value_format=t.value_format?t.value_format:"",this.geo_type="",("location"===t.type||t.map_layer)&&(this.geo_type="location"===t.type?"location":t.map_layer.name),this.hide=!1,void 0!==this.vis.config["hide|"+this.name]&&this.vis.config["hide|"+this.name]&&(this.hide=!0),this.style="";var n=this.vis.config["style|"+this.name];void 0!==n&&("hide"===n?this.hide=!0:this.style=n),this.heading="",this.short_name="",this.unit="",void 0!==t.tags&&t.tags.forEach(e=>{var t=e.split(":");if("vis-tools"===t[0])switch(t[1]){case"heading":this.heading=t[2];break;case"short_name":this.short_name=t[2];break;case"unit":this.unit=t[2];break;case"style":this.style=t[2]}})}}class o extends i{constructor({vis:e,queryResponseField:t}){super({vis:e,queryResponseField:t}),this.type="dimension",this.align="left"}}class s extends i{constructor({vis:e,queryResponseField:t}){super({vis:e,queryResponseField:t}),this.type="pivot",this.align="center"}}class l extends i{constructor({vis:e,queryResponseField:t,can_pivot:n}){super({vis:e,queryResponseField:t}),this.type="measure",this.align="right",this.is_table_calculation=void 0!==t.is_table_calculation&&t.is_table_calculation,this.calculation_type=t.type,this.is_turtle=void 0!==t.is_turtle&&t.is_turtle,this.can_pivot=n}}class u{constructor({column:e,type:t,label:n=null,align:a="",cell_style:r=[],modelField:i={name:"",label:"",view:""},pivotData:o={}}={column:e,type:t,label:n,align:a,cell_style:r,modelField:i,pivotData:o}){this.id=[e.id,t].join("."),this.column=e,this.type=t,this.colspan=1,this.rowspan=1,this.headerRow=!0,this.cell_style=["headerCell"].concat(r),this.label=n,this.align=a||(this.column.modelField.is_numeric?"right":"left"),this.modelField=i,this.pivotData=o,i.type&&this.cell_style.push(i.type),i.is_table_calculation&&this.cell_style.push("calculation")}}class c{constructor({keys:e,values:t,types:n=[]}){if(e.length===t.length){this.keys=e,this.values=t,this.types=n;var a=[],r=[];this.values.forEach((e,t)=>{this.types[t]=void 0!==n[t]?n[t]:"line_item","line_item"===this.types[t]?(a.push(e),r.push(e)):"subtotal"===this.types[t]&&r.push(e)}),this.min_for_display=Math.min(...r),this.max_for_display=Math.max(...r),this.min=Math.min(...a),this.max=Math.max(...a),this.sum=a.reduce((e,t)=>e+t,0),this.count=a.length,this.avg=a.length>0?this.sum/a.length:null}else console.log("Could not construct series, arrays were of different length.")}}class d{constructor({column:e,row:t,sort_value:n,series:a}){this.column=e,this.row=t,this.sort_value=n,this.series=new c(a)}toString(){var e="";return this.series.keys.forEach((t,n)=>{e+=t+":";var a=""===this.column.modelField.value_format?this.series.values[n].toString():SSF.format(this.column.modelField.value_format,this.series.values[n]);e+=a+" "}),e}}class h{constructor({column:e,is_numeric:t,series:n}){this.column=e,this.is_numeric=t,this.series=new c(n)}}class f{constructor({value:e,rendered:t=null,html:n=null,links:a=[],cell_style:r=[],align:i="right",rowspan:o=1,colspan:s=1,rowid:l="",colid:u=""}={}){this.value=e,this.rendered=t,this.html=n,this.links=a,this.cell_style=["rowCell"].concat(r),this.align=i,this.rowspan=o,this.colspan=s,this.colid=u,this.rowid=l,this.id=u&&l?[u,l].join("."):null,null===this.value&&"∞"!==this.rendered&&(this.rendered="∅")}}class p{constructor(e="line_item"){this.id="",this.hide=!1,this.type=e,this.sort=[],this.data={}}sortArray(){return this.sort}}class m{constructor(e,t,n){this.id=e,this.vis=t,this.modelField=n,this.transposed=!1,this.idx=0,this.pos=0,this.levels=[],this.pivot_key="",this.unit=n.unit||"",this.hide=n.hide||!1,this.isVariance=!1,this.variance_type=null,this.pivoted=!1,this.isRowTotal=!1,this.super=!1,this.subtotal=!1,this.subtotal_data={},this.series=null,this.sort=[],this.colspans=[]}getHeaderCellLabel(e){var t=this.levels[e];if(null!==t.label)var n=t.label;else{n=t.modelField.label;var a=this.vis.config["heading|"+t.modelField.name],r=this.vis.config["label|"+t.modelField.name];if("heading"===t.type)return n=void 0!==a&&a||t.modelField.heading;"field"===t.type&&(n=this.vis.useShortName&&t.modelField.short_name||t.modelField.label,void 0!==r&&r!==this.modelField.label&&(n=r||n),this.isVariance&&(n=this.vis.groupVarianceColumns?2===this.vis.pivot_values.length?"absolute"===this.variance_type?n+" #":n+" %":"absolute"===this.variance_type?n+" Var #":n+" Var %":"absolute"===this.variance_type?"Var #":"Var %"),void 0!==this.vis.useViewName&&this.vis.useViewName&&(n=[this.modelField.view,n].join(" "))),"pivot"===t.type&&this.isVariance&&this.vis.groupVarianceColumns&&(n=2===this.vis.pivot_values.length?"Variance":"Var "+n)}return n}getHeaderCellLabelByType(e){for(var t=0;t<this.vis.headers.length;t++)if(e===this.vis.headers[t].type)return this.getHeaderCellLabel(t);return null}setHeaderCellLabels(){this.levels.forEach((e,t)=>{e.label=null===e.label?this.getHeaderCellLabel(t):e.label})}getHeaderData(){var e={};return this.modelField.vis.headers.forEach((t,n)=>{e[t.type]=this.levels[n]}),e}}const v={theme:{section:"Theme",type:"string",display:"select",label:"Theme",values:[{Traditional:"traditional"},{Looker:"looker"},{Contemporary:"contemporary"},{"Use custom theme":"custom"}],default:"traditional",order:1},customTheme:{section:"Theme",type:"string",label:"Load custom CSS from:",default:"",order:2},layout:{section:"Theme",type:"string",display:"select",label:"Layout",values:[{Even:"fixed"},{Auto:"auto"}],default:"fixed",order:3},minWidthForIndexColumns:{section:"Theme",type:"boolean",label:"Automatic column width on index",default:!0,order:3.5},headerFontSize:{section:"Theme",type:"number",display_size:"half",label:"Header Size",default:12,order:4},bodyFontSize:{section:"Theme",type:"number",display_size:"half",label:"Body Size",default:12,order:5},showTooltip:{section:"Theme",type:"boolean",display_size:"half",label:"Show tooltip",default:!0,order:6},showHighlight:{section:"Theme",type:"boolean",display_size:"half",label:"Show highlight",default:!0,order:7},columnOrder:{},rowSubtotals:{section:"Table",type:"boolean",label:"Row Subtotals",display_size:"half",default:!1,order:1},colSubtotals:{section:"Table",type:"boolean",label:"Col Subtotals",display_size:"half",default:!1,order:2},spanRows:{section:"Table",type:"boolean",label:"Merge Dims",display_size:"half",default:!0,order:3},spanCols:{section:"Table",type:"boolean",label:"Merge Headers",display_size:"half",default:!0,order:4},calculateOthers:{section:"Table",type:"boolean",label:"Calculate Others Row",default:!0,order:4.5},sortColumnsBy:{section:"Table",type:"string",display:"select",label:"Sort Columns By",values:[{Pivots:"pivots"},{Measures:"measures"}],default:"pivots",order:6},useViewName:{section:"Table",type:"boolean",label:"Include View Name",default:!1,order:7},useHeadings:{section:"Table",type:"boolean",label:"Use Headings",default:!1,order:8},useShortName:{section:"Table",type:"boolean",label:"Use Short Name (from model tags)",default:!1,order:9},useUnit:{section:"Table",type:"boolean",label:"Use Unit (when reporting in 000s)",default:!1,order:9.5},groupVarianceColumns:{section:"Table",type:"boolean",label:"Group Variance Columns",default:!1,order:10},genericLabelForSubtotals:{section:"Table",type:"boolean",label:"Label all subtotal rows as 'Subtotal'",default:!1,order:11},indexColumn:{section:"Dimensions",type:"boolean",label:"Use Last Field Only",default:!1,order:0},transposeTable:{section:"Table",type:"boolean",label:"Transpose Table",default:!1,order:100}};class g{constructor(e,t,n){this.visId="report_table",this.config=n,this.headers=[],this.dimensions=[],this.measures=[],this.columns=[],this.data=[],this.subtotals_data={},this.transposed_headers=[],this.transposed_columns=[],this.transposed_data=[],this.pivot_fields=[],this.pivot_values=void 0!==t.pivots?t.pivots:[],this.variances=[],this.column_series=[],this.firstVisibleDimension="",this.useIndexColumn=n.indexColumn||!1,this.useHeadings=n.useHeadings||!1,this.useShortName=n.useShortName||!1,this.useViewName=n.useViewName||!1,this.addRowSubtotals=n.rowSubtotals||!1,this.addSubtotalDepth=parseInt(n.subtotalDepth)||this.dimensions.length-1,this.addColSubtotals=n.colSubtotals||!1,this.spanRows=n.spanRows,this.spanCols=n.spanCols,this.sortColsBy=n.sortColumnsBy||"pivots",this.fieldLevel=0,this.groupVarianceColumns=n.groupVarianceColumns||!1,this.minWidthForIndexColumns=n.minWidthForIndexColumns||!1,this.showTooltip=n.showTooltip||!1,this.showHighlight=n.showHighlight||!1,this.genericLabelForSubtotals=n.genericLabelForSubtotals||!1,this.sorts=t.sorts,this.hasTotals=void 0!==t.totals_data,this.calculateOthers=void 0!==t.truncated&&(t.truncated&&n.calculateOthers),this.hasSubtotals=void 0!==t.subtotals_data,this.hasRowTotals=t.has_row_totals||!1,this.hasPivots=void 0!==t.pivots,this.hasSupers=void 0!==t.fields.supermeasure_like&&Boolean(t.fields.supermeasure_like.length),this.transposeTable=n.transposeTable||!1;this.addPivotsAndHeaders(t),this.addDimensions(t,0),this.addMeasures(t,0),this.checkVarianceCalculations(),this.useIndexColumn&&this.addIndexColumn(t),this.hasSubtotals&&this.checkSubtotalsData(t),this.addRows(e),this.addColumnSeries(),this.hasTotals&&this.buildTotals(t),this.spanRows&&this.setRowSpans(),this.addRowSubtotals&&this.addSubTotals(),this.addColSubtotals&&2===this.pivot_fields.length&&this.addColumnSubTotals(),this.variances&&this.addVarianceColumns(),this.sortColumns(),this.columns.forEach(e=>e.setHeaderCellLabels()),this.spanCols&&this.setColSpans(),this.applyFormatting(),this.transposeTable&&(this.transposeDimensionsIntoHeaders(),this.transposeRowsIntoColumns(),this.transposeColumnsIntoRows()),this.validateConfig(),this.getTableColumnGroups()}static getCoreConfigOptions(){return v}getConfigOptions(){var e=v,t=[];return this.dimensions.forEach((n,a)=>{if(e["label|"+n.name]={section:"Dimensions",type:"string",label:n.label,default:n.label,order:10*a+1},e["heading|"+n.name]={section:"Dimensions",type:"string",label:"Heading",default:"",order:10*a+2},e["hide|"+n.name]={section:"Dimensions",type:"boolean",label:"Hide",display_size:"third",default:!1,order:10*a+3},a<this.dimensions.length-1){var r={};r[n.label]=(a+1).toString(),t.push(r)}}),e.subtotalDepth={section:"Table",type:"string",label:"Sub Total Depth",display:"select",values:t,default:"1",order:5},this.measures.forEach((t,n)=>{e["label|"+t.name]={section:"Measures",type:"string",label:t.label,default:t.label,order:100+10*n+1},e["heading|"+t.name]={section:"Measures",type:"string",label:"Heading for "+t.label,default:"",order:100+10*n+2},e["style|"+t.name]={section:"Measures",type:"string",label:"Style",display:"select",display_size:"third",values:[{Normal:"normal"},{"Black/Red":"black_red"},{Subtotal:"subtotal"},{Hidden:"hide"}],default:"normal",order:100+10*n+3},e["reportIn|"+t.name]={section:"Measures",type:"string",label:"Report In",display:"select",display_size:"third",values:[{"Absolute Figures":"1"},{Thousands:"1000"},{Millions:"1000000"},{Billions:"1000000000"}],default:"1",order:100+10*n+3.5},e["unit|"+t.name]={section:"Measures",type:"string",label:"Unit",display_size:"third",default:"",order:100+10*n+3.7};var a=[];if(t.can_pivot){var r=[];this.pivot_fields.forEach((e,t)=>{if(1===this.pivot_fields.length||1===t||this.config.colSubtotals){var n={};n["By "+e.label]=e.name,r.push(n)}}),a=a.concat(r)}this.measures.forEach((e,r)=>{var i=t.can_pivot===e.can_pivot||this.hasRowTotals&&!e.is_table_calculation;if(n!=r&&i){var o={};o["Vs. "+e.label]=e.name,a.push(o)}}),a.unshift({"(none)":"no_variance"}),e["comparison|"+t.name]={section:"Measures",type:"string",label:"Comparison",display:"select",values:a,default:"no_variance",order:100+10*n+5},e["switch|"+t.name]={section:"Measures",type:"boolean",label:"Switch",display_size:"third",default:!1,order:100+10*n+6},e["var_num|"+t.name]={section:"Measures",type:"boolean",label:"Var #",display_size:"third",default:!0,order:100+10*n+7},e["var_pct|"+t.name]={section:"Measures",type:"boolean",label:"Var %",display_size:"third",default:!1,order:100+10*n+8}}),e}addPivotsAndHeaders(e){e.fields.pivots.forEach((e,t)=>{var n=new s({vis:this,queryResponseField:e});this.pivot_fields.push(n),this.headers.push({type:"pivot"+t,modelField:n})});var t=this.useHeadings?[{type:"heading",modelField:{label:"(will be replaced by header for column)s"}}]:[];t.push({type:"field",modelField:{label:"(will be replaced by field for column)"}}),"pivots"===this.sortColsBy?this.headers.push(...t):this.headers.unshift(...t);for(var n=0;n<this.headers.length;n++)if("field"===!this.headers[n]){this.fieldLevel=n;break}}addDimensions(e,t){e.fields.dimension_like.forEach(e=>{var n=new o({vis:this,queryResponseField:e});n.hide=!!this.useIndexColumn||n.hide,this.dimensions.push(n);var a=new m(n.name,this,n);a.idx=t,a.sort.push({name:"section",value:0}),this.headers.forEach(e=>{switch(e.type){case"pivot0":case"pivot1":var r=new s({vis:this,queryResponseField:e.modelField}),i=new u({column:a,type:e.type,modelField:r});i.label="",a.levels.push(i),a.sort.push({name:e.type,value:0});break;case"heading":a.levels.push(new u({column:a,type:"heading",modelField:n}));break;case"field":a.levels.push(new u({column:a,type:"field",modelField:n})),a.sort.push({name:"col_idx",value:t})}}),this.columns.push(a),t+=10});for(var n=0;n<this.dimensions.length;n++){var a=this.dimensions[n];if(!a.hide){this.firstVisibleDimension=a.name;break}}}addMeasures(e,t){e.fields.measure_like.forEach(e=>{var t=new l({vis:this,queryResponseField:e,can_pivot:!0}),n=this.config["reportIn|"+e.name],a=this.config["unit|"+e.name];void 0!==n&&"1"!==n&&(t.value_format="#,##0",void 0!==a&&""!==a&&(t.unit=a)),this.measures.push(t)}),this.hasPivots?this.pivot_values.forEach(e=>{var n="$$$_row_total_$$$"===e.key;this.measures.forEach((a,r)=>{if(!n||n&&!a.is_table_calculation){var i=new m([e.key,a.name].join("."),this,a);i.pivoted=!n,i.isRowTotal=n,i.pivot_key=e.key,i.idx=t;var o=[],s=[];this.headers.forEach(t=>{switch(t.type){case"pivot0":case"pivot1":var r=n?"":e.metadata[t.modelField.name].rendered||e.metadata[t.modelField.name].value;n&&t.type.startsWith("pivot")&&t.type==="pivot"+(this.pivot_fields.length-1)&&(r="Row Total"),i.levels.push(new u({column:i,type:t.type,modelField:{label:r},pivotData:e})),s.push(e.sort_values[t.modelField.name]),i.pivoted?o.push({name:t.modelField.name,value:e.sort_values[t.modelField.name]}):o.push({name:t.modelField.name,value:0});break;case"heading":i.levels.push(new u({column:i,type:"heading",modelField:a}));break;case"field":i.levels.push(new u({column:i,type:"field",modelField:a}))}});var l=[];if(l.push({name:"section",value:n?2:1}),console.log("sortColsBy",this.sortColsBy),"measures"===this.sortColsBy&&(console.log("sort by measures, assigning measure_idx"),l.push({name:"measure_idx",value:r})),2===this.pivot_fields.length)if(this.addColSubtotals)l=l.concat(o);else{var c=[];this.sorts.forEach(e=>{this.pivot_fields.forEach(t=>{t.name===e.name&&o.forEach(e=>{e.name===t.name&&c.push(e.name)})})}),l=c[0]===this.pivot_fields[0].name?l.concat(o):l.concat(o.reverse())}else l.push(o[0]);"pivots"===this.sortColsBy&&(console.log("sort by pivots, assigning measure_idx"),l.push({name:"measure_idx",value:r})),i.sort=l,this.columns.push(i),t+=10}})}):this.measures.forEach(e=>{var n=new m(e.name,this,e);n.sort.push({name:"section",value:1}),n.idx=t;try{void 0!==this.config.columnOrder[n.id]?n.pos=this.config.columnOrder[n.id]:n.pos=t}catch{n.pos=t}this.headers.forEach(t=>{switch(t.type){case"heading":n.levels.push(new u({column:n,type:"heading",modelField:e}));break;case"field":n.levels.push(new u({column:n,type:"field",modelField:e})),n.sort.push({name:"column.pos",value:n.pos})}}),this.columns.push(n),t+=10}),void 0!==e.fields.supermeasure_like&&e.fields.supermeasure_like.forEach(e=>{var n=new l({vis:this,queryResponseField:e,can_pivot:!1}),a=this.config["reportIn|"+e.name],r=this.config["unit|"+e.name];void 0!==a&&"1"!==a&&(n.value_format="#,##0",void 0!==r&&""!==r&&(n.unit=r)),this.measures.push(n);var i=new m(n.name,this,n);i.sort.push({name:"section",value:2}),this.headers.forEach(e=>{switch(e.type){case"pivot0":case"pivot1":i.levels.push(new u({column:i,type:e.type,modelField:{label:""}})),i.sort.push({name:e.type,value:0});break;case"heading":i.levels.push(new u({column:i,type:"heading",modelField:n}));break;case"field":i.levels.push(new u({column:i,type:"field",modelField:n})),i.sort.push({name:"col_idx",value:t})}}),i.idx=t,i.super=!0,this.columns.push(i),t+=10})}checkVarianceCalculations(){Object.keys(this.config).forEach(e=>{if(e.startsWith("comparison")){var t=e.split("|")[1],n=this.config[e],a=!1;this.measures.forEach(e=>{t===e.name&&(a=!0)});var r=!1;if([...this.measures.map(e=>e.name),...this.pivot_fields.map(e=>e.name)].forEach(e=>{n===e&&(r=!0)}),a&&r){if(this.pivot_fields.map(e=>e.name).includes(this.config[e]))var i="by_pivot";else i="no_variance"===this.config[e]?"no_variance":"vs_measure";if(void 0!==this.config["switch|"+t])if(this.config["switch|"+t])var o=!0;else o=!1;this.variances.push({baseline:t,comparison:this.config[e],type:i,reverse:o})}else a?this.config[e]="no_variance":delete this.config[e]}})}addIndexColumn(){var e=this.dimensions[this.dimensions.length-1],t=this.config["hide|"+e.name],n=new m("$$$_index_$$$",this,e);n.sort.push({name:"section",value:-1}),n.hide=!0===t&&t,this.headers.forEach(t=>{switch(t.type){case"pivot0":case"pivot1":var a=new s({vis:this,queryResponseField:t.modelField}),r=new u({column:n,type:t.type,modelField:a});r.label="",n.levels.push(r),n.sort.push({name:t.type,value:0});break;case"heading":n.levels.push(new u({column:n,type:"heading",modelField:e}));break;case"field":n.levels.push(new u({column:n,type:"field",modelField:e})),n.sort.push({name:n.id,value:0})}}),this.columns.push(n)}checkSubtotalsData(e){void 0!==e.subtotals_data[this.addSubtotalDepth]&&e.subtotals_data[this.addSubtotalDepth].forEach(e=>{var t=new p("subtotal");t.$$$__grouping__$$$=e.$$$__grouping__$$$;var n=["Subtotal"];t.$$$__grouping__$$$.forEach(t=>{n.push(e[t].value)}),t.id=n.join("|"),this.columns.forEach(n=>{t.data[n.id]=n.pivoted||n.isRowTotal?e[n.modelField.name][n.pivot_key]:e[n.id];var a=t.data[n.id];if(void 0!==a){void 0===a.cell_style?a.cell_style=["total","subtotal"]:a.cell_style=a.cell_style.concat(["total","subtotal"]),void 0!==n.modelField.style&&(a.cell_style=a.cell_style.concat(n.modelField.style)),null===a.value&&(a.rendered="");var i=this.config["reportIn|"+n.modelField.name];if(void 0!==i&&"1"!==i){var o=this.config.useUnit&&"#"!==n.modelField.unit?n.modelField.unit:"";a.html=null,a.value=Math.round(a.value/parseInt(i)),a.rendered=""===n.modelField.value_format?a.value.toString():o+r.a.format(n.modelField.value_format,a.value)}}}),this.subtotals_data[t.id]=t})}addRows(e){e.forEach((e,t)=>{var n=new p("line_item");if(n.id=this.dimensions.map(t=>e[t.name].value).join("|"),this.columns.forEach(t=>{var a=t.pivoted||t.isRowTotal?e[t.modelField.name][t.pivot_key]:e[t.id],i=new f({...a,cell_style:[t.modelField.type],colid:t.id,rowid:n.id});t.modelField.is_numeric?(i.cell_style.push("numeric"),i.align="right"):(i.cell_style.push("nonNumeric"),i.align="left"),void 0!==t.modelField.style&&(i.cell_style=i.cell_style.concat(t.modelField.style));var o=this.config["reportIn|"+t.modelField.name];if(void 0!==o&&"1"!==o){var s=this.config.useUnit&&"#"!==t.modelField.unit?t.modelField.unit:"";i.html=null,i.value=Math.round(i.value/parseInt(o)),i.rendered=""===t.modelField.value_format?i.value.toString():s+r.a.format(t.modelField.value_format,i.value)}if(t.modelField.is_turtle){var l=new d({column:t,row:n,sort_value:i.sort_value,series:{keys:n.data[t.id]._parsed.keys,values:n.data[t.id]._parsed.values}});i.value=l,i.rendered=l.toString()}n.data[t.id]=i}),this.useIndexColumn){var a=this.dimensions[this.dimensions.length-1].name,i=n.data[a];n.data.$$$_index_$$$=new f({value:i.value,rendered:i.rendered,html:i.html,cell_style:["singleIndex","dimension"],align:this.dimensions[this.dimensions.length-1].is_numeric?"right":"left",colid:"$$$_index_$$$",rowid:i.rowid})}n.sort=[{name:"section",value:0},{name:"unknown",value:0},{name:"original_row",value:t}],this.data.push(n)})}addColumnSeries(){this.columns.forEach(e=>{var t=[],n=[],a=[];this.data.forEach(r=>{t.push(r.id),n.push(r.data[e.id].value),a.push(r.type)});var r=new h({column:e,is_numeric:e.modelField.is_numeric,series:{keys:t,values:n,types:a}});e.series=r,this.column_series.push(r)})}buildTotals(e){var t=e.totals_data,n=new p("total");if(this.columns.forEach(e=>{if(n.id="Total","dimension"===e.modelField.type){if([this.firstVisibleDimension,"$$$_index_$$$"].includes(e.id))var a=1,i=this.useIndexColumn?1:this.dimensions.filter(e=>!e.hide).length;else a=-1,i=-1;n.data[e.id]=new f({value:"",cell_style:["total","dimension"],rowspan:a,colspan:i,colid:e.id,align:e.modelField.is_numeric?"right":"left",rowid:"Total"})}else a=1,i=1;if("measure"===e.modelField.type){var o=e.modelField.is_numeric?["total","numeric","measure"]:["total","nonNumeric","measure"],s=e.pivoted||e.isRowTotal?t[e.modelField.name][e.pivot_key]:t[e.id];void 0===(s=new f({...s,cell_style:o,rowspan:a,colspan:i,colid:e.id,align:e.modelField.is_numeric?"right":"left",rowid:"Total"})).rendered&&void 0!==s.html&&(s.rendered=this.getRenderedFromHtml(s));var l=this.config["reportIn|"+e.modelField.name];if(void 0!==l&&"1"!==l){var u=this.config.useUnit&&"#"!==e.modelField.unit?e.modelField.unit:"";s.html=void 0,s.value=Math.round(s.value/parseInt(l)),s.rendered=""===e.modelField.value_format?s.value.toString():u+r.a.format(e.modelField.value_format,s.value)}n.data[e.id]=s,void 0!==n.data[e.id].links&&n.data[e.id].links.forEach(e=>{e.type="measure_default"})}}),this.useIndexColumn?(n.data.$$$_index_$$$.value="TOTAL",n.data.$$$_index_$$$.align="left",n.data.$$$_index_$$$.colspan=this.dimensions.filter(e=>!e.hide).length):this.firstVisibleDimension&&(n.data[this.firstVisibleDimension].value="TOTAL",n.data[this.firstVisibleDimension].align="left"),n.sort=[{name:"section",value:1},{name:"unknown",value:0},{name:"original_row",value:0}],this.data.push(n),this.calculateOthers){var a=new p("line_item");a.id="Others",this.columns.forEach(e=>{var t=null,i=e.modelField.is_numeric?["numeric"]:["nonNumeric"],o=n.data[e.id];if("measure"===e.modelField.type?(t=["sum","count"].includes(e.modelField.calculation_type))?(t=o.value-e.series.series.sum,i.push("measure")):(t=(o.value+e.series.series.avg)/2,i=i.concat(["estimate","measure"]),["count","count_distinct"].includes(e.modelField.calculation_type)&&(t=Math.round(t))):i.push("dimension"),t){var s=""===e.modelField.value_format?t.toString():r.a.format(e.modelField.value_format,t);a.data[e.id]=new f({value:t,rendered:s,cell_style:i,align:e.modelField.is_numeric?"right":"left",colid:e.id,rowid:"Others"})}else a.data[e.id]=new f({rendered:"",cell_style:i,colid:e.id,rowid:"Others"})}),this.useIndexColumn?(a.data.$$$_index_$$$.value="Others",a.data.$$$_index_$$$.rendered="Others",a.data.$$$_index_$$$.align="left",a.data.$$$_index_$$$.cell_style.push("singleIndex")):this.firstVisibleDimension&&(a.data[this.firstVisibleDimension].value="Others",a.data[this.firstVisibleDimension].rendered="Others",a.data[this.firstVisibleDimension].align="left"),a.sort=[{name:"section",value:1},{name:"unknown",value:-1},{name:"original_row",value:-1}],this.data.push(a)}this.sortData()}setRowSpans(){var e,t=[],n={};e=this.data,(t=this.dimensions.filter(e=>!e.hide)).forEach(e=>{n[e.name]=1});for(var a=e.length-1;a>=0;a--){var r=e[a];if("line_item"===r.type)for(var i=0;i<t.length;i++){var o=t[i],s=r.data[o.name].value,l=a>0?e[a-1].data[o.name].value:null;if(!(a>0&&s===l)){for(var u=i;u<t.length;u++){var c=t[u];r.data[c.name].rowspan=n[c.name],r.data[c.name].rowspan>1&&r.data[c.name].cell_style.push("merged"),n[c.name]=1}break}r.data[o.name].rowspan=-1,r.data[o.name].colspan=-1,n[o.name]+=1}else t.forEach(e=>{n[e.name]=1})}}addSubTotals(){var e=this.addSubtotalDepth,t=[],n=[];this.data.forEach((a,r)=>{if("total"!==a.type){for(var i=[],o=0;o<e;o++){var s=this.dimensions[o].name;i.push(a.data[s].value)}i.join("|")!==n.join("|")&&(t.push(i),n=i),a.sort=[{name:"section",value:0},{name:"subtotal",value:t.length-1},{name:"original_row",value:r}]}"Others"===a.id&&"line_item"===a.type&&(a.hide=!0)}),t.forEach((e,t)=>{var n=new p("subtotal"),a=e.join("|")?e.join("|"):"Others";n.id=["Subtotal",a].join("|"),this.columns.forEach(a=>{if("dimension"===a.modelField.type){if([this.firstVisibleDimension,"$$$_index_$$$"].includes(a.id))var i=1,o=this.useIndexColumn?1:this.dimensions.filter(e=>!e.hide).length;else i=-1,o=-1;var s=a.modelField.is_numeric?["total","subtotal","numeric","dimension"]:["total","subtotal","nonNumeric","dimension"],l=new f({cell_style:s,align:a.modelField.is_numeric?"right":"left",rowspan:i,colspan:o,colid:a.id,rowid:n.id});"$$$_index_$$$"!==a.id&&a.id!==this.firstVisibleDimension||(this.genericLabelForSubtotals?(l.value="Subtotal",l.rendered="Subtotal"):(l.value=e.join(" | ")?e.join(" | "):"Others",l.rendered=l.value)),n.data[a.id]=l}if("measure"==a.modelField.type){s=a.modelField.is_numeric?["total","subtotal","numeric","measure"]:["total","subtotal","nonNumeric","measure"];var u=a.modelField.is_numeric?"right":"left";if(Object.entries(this.subtotals_data).length>0&&!n.id.startsWith("Subtotal|Others")){l=new f({...n.data[a.id],...this.subtotals_data[n.id].data[a.id],cell_style:s,align:u,colid:a.id,rowid:n.id});n.data[a.id]=l}else{var c=0,d=0,h="";if(this.data.forEach(e=>{if("line_item"==e.type&&e.sort[1].value==t){var n=e.data[a.id].value;Number.isFinite(n)&&(c+=n,d++)}}),"average"===a.modelField.calculation_type&&d>0&&(c/=d),c){var p=this.config.useUnit&&"#"!==a.modelField.unit?a.modelField.unit:"";h=""===a.modelField.value_format?c.toString():p+r.a.format(a.modelField.value_format,c)}"string"===a.modelField.calculation_type&&(c="",h="");l=new f({value:c,rendered:h,cell_style:s,align:u,colid:a.id,rowid:n.id});n.data[a.id]=l}}}),n.sort=[{name:"section",value:0},{name:"subtotal",value:t},{name:"original_row",value:9999}],this.data.push(n)}),this.sortData(),this.hasSubtotals=!0}addColumnSubTotals(){var e=[],t=[],n=this.pivot_fields[0].name;this.pivot_values.forEach(e=>{var a=e.data[n];null!==a&&t.push(a)}),(t=[...new Set(t)]).forEach(t=>{this.measures.forEach((n,a)=>{if(n.can_pivot){var r=new m(["$$$_subtotal_$$$",t,n.name].join("."),this,n);r.pivoted=!0,r.subtotal=!0,r.pivot_key=[t,"$$$_subtotal_$$$"].join("|"),r.subtotal_data={pivot:t,measure_idx:a,columns:[]},this.columns.forEach((e,a)=>{var i=null;for(a=0;a<e.levels.length;a++)if(e.levels[a].type.startsWith("pivot")){i=e.levels[a].modelField.label;break}e.pivoted&&i===t&&e.modelField.name===n.name&&r.subtotal_data.columns.push(e)}),e.push(r)}})}),e.forEach((e,t)=>{e.sort.push({name:"section",value:1}),this.headers.forEach((t,n)=>{switch(t.type){case"pivot0":var a=e.subtotal_data.columns[0].levels[n].pivotData.sort_values[t.modelField.name];e.levels.push(new u({column:e,type:t.type,modelField:{name:t.modelField.name,label:e.subtotal_data.pivot}})),e.sort.push({name:t.modelField.name,value:a});break;case"pivot1":e.levels.push(new u({column:e,type:t.type,modelField:{name:"subtotal",label:"Subtotal"}}));var r=this.sorts.find(e=>e.name===t.modelField.name);if(void 0===r||void 0===r.desc)var i=!1;else i=Boolean(r.desc);if(i)var o="string"==typeof this.pivot_values[0].sort_values[t.modelField.name]?"aaaaaaaa":Number.NEGATIVE_INFINITY;else o="string"==typeof this.pivot_values[0].sort_values[t.modelField.name]?"ZZZZZZZZ":Number.POSITIVE_INFINITY;e.sort.push({name:t.modelField.name,value:o});break;case"heading":e.levels.push(new u({column:e,type:"heading",modelField:e.modelField}));break;case"field":e.levels.push(new u({column:e,type:"field",modelField:e.modelField})),e.sort.push({name:"measure_idx",value:e.subtotal_data.measure_idx})}}),this.columns.push(e)}),this.data.forEach(t=>{e.forEach(e=>{var n=e.modelField.is_numeric?["subtotal","numeric","measure"]:["subtotal","nonNumeric","measure"],a=0;e.subtotal_data.columns.forEach(e=>{a+=t.data[e.id].value}),t.data[e.id]=new f({value:a,rendered:""===e.modelField.value_format?a.toString():r.a.format(e.modelField.value_format,a),cell_style:n,colid:e.id,rowid:t.id}),["subtotal","total"].includes(t.type)&&t.data[e.id].cell_style.push("total")})})}calculateVariance(e,t,n,a,i){this.data.forEach(o=>{var s=o.data[a.id].value,l=o.data[i.id].value;if("absolute"===n)var u=new f({value:s-l,rendered:""===e?(s-l).toString():r.a.format(e,s-l),cell_style:["numeric","measure","variance","varianceAbsolute"],colid:t,rowid:o.id});else{var c=(s-l)/Math.abs(l);if(isFinite(c))u=new f({value:c,rendered:r.a.format("#0.00%",c),cell_style:["numeric","measure","variance","variancePercent"],colid:t,rowid:o.id});else var u=new f({value:null,rendered:"∞",cell_style:["numeric","measure","variance","variancePercent"],colid:t,rowid:o.id})}"total"!=o.type&&"subtotal"!=o.type||u.cell_style.push("total"),"subtotal"===o.type&&u.cell_style.push("subtotal"),u.value<0&&u.cell_style.push("negative"),o.data[t]=u})}createVarianceColumn(e){if(this.config.colSubtotals||!e.variance.baseline.startsWith("$$$_subtotal_$$$")){var t=["$$$_variance_$$$",e.calc,e.variance.baseline,e.variance.comparison].join("|"),n=this.getColumnById(e.variance.baseline),a=this.getColumnById(e.variance.comparison),r=new m(t,this,n.modelField);if(r.isVariance=!0,"absolute"===e.calc){r.variance_type="absolute",r.idx=n.idx+1,r.pos=n.pos+1;var i=JSON.parse(JSON.stringify(n.sort));r.sort=[...i,{name:"variance_absolute",value:1}],r.hide=!this.config["var_num|"+n.modelField.name]}else{r.variance_type="percentage",r.idx=n.idx+2,r.pos=n.pos+2;i=JSON.parse(JSON.stringify(n.sort));r.sort=[...i,{name:"variance_percentage",value:2}],r.unit="%",r.hide=!this.config["var_pct|"+n.modelField.name]}void 0!==this.config.columnOrder[r.id]&&(r.pos=this.config.columnOrder[r.id]),r.pivoted=n.pivoted,r.super=n.super,r.pivot_key=n.pivot_key,this.groupVarianceColumns&&(r.sort[0].value=1.5),this.headers.forEach((e,t)=>{switch(e.type){case"pivot0":case"pivot1":var a=n.getHeaderCellLabelByType(e.type);if(this.groupVarianceColumns&&"pivot0"===e.type)a=2===this.pivot_values.length?"Variance":"Variance: "+a;var i=new u({column:r,type:e.type,modelField:{label:a}});r.levels[t]=i;break;case"heading":i=new u({column:r,type:"heading",modelField:n.modelField});r.levels[t]=i;break;case"field":i=new u({column:r,type:"field",modelField:n.modelField});r.levels[t]=i}}),this.columns.push(r),e.variance.reverse?this.calculateVariance(n.modelField.value_format,t,e.calc,a,n):this.calculateVariance(n.modelField.value_format,t,e.calc,n,a)}else console.log("Cannot calculate variance of column subtotals if subtotals disabled.")}addVarianceColumns(){var e=[],t=["absolute","percent"];Object.keys(this.variances).forEach(n=>{var a=this.variances[n];if("no_variance"!==a.comparison)if("vs_measure"===a.type)this.hasPivots?this.pivot_values.forEach(n=>{n.is_total||t.forEach(t=>{e.push({calc:t,variance:{baseline:[n.key,a.baseline].join("."),comparison:[n.key,a.comparison].join("."),reverse:a.reverse,type:a.type}})})}):t.forEach(t=>{e.push({variance:a,calc:t})});else if("by_pivot"===a.type)if(1===this.pivot_fields.length||this.pivot_fields[1].name===a.comparison)this.pivot_values.slice(1).forEach((n,r)=>{t.forEach(t=>{n.is_total||e.push({calc:t,variance:{baseline:[n.key,a.baseline].join("."),comparison:[this.pivot_values[r].key,a.baseline].join("."),reverse:a.reverse,type:a.type}})})});else{var r=[];this.pivot_values.forEach(e=>{if(!e.is_total){var t=e.data[this.pivot_fields[0].name];r.includes(t)||r.push(t)}}),r.slice(1).forEach((n,i)=>{t.forEach(t=>{e.push({calc:t,variance:{baseline:["$$$_subtotal_$$$",n,a.baseline].join("."),comparison:["$$$_subtotal_$$$",r[i],a.baseline].join("."),reverse:a.reverse,type:a.type}})})})}}),e.forEach(e=>{this.createVarianceColumn(e)})}compareSortArrays(e){return function(t,n){for(var a=Math.max(t.sort.length,n.sort.length),r=0;r<a;r++){var i=void 0!==t.sort[r].name?t.sort[r].name:"",o=e.sorts.find(e=>e.name===i),s=void 0!==o&&o.desc,l=void 0!==t.sort[r]?t.sort[r].value:0,u=void 0!==n.sort[r]?n.sort[r].value:0;if(s){if(l<u)return 1;if(l>u)return-1}else{if(l>u)return 1;if(l<u)return-1}}return-1}}sortData(){this.data.sort(this.compareSortArrays(this)),this.spanRows&&this.setRowSpans()}sortColumns(){this.columns.sort(this.compareSortArrays(this))}setColSpans(){var e=[],t=[],n={};this.columns.filter(e=>!e.hide).forEach(t=>{var n={id:t.id,data:t.getHeaderData()};e.push(n)}),(t=this.headers).forEach(e=>{n[e.type]=1});for(var a=e.length-1;a>=0;a--)for(var r=e[a],i=0;i<t.length;i++){var o=t[i],s=r.data[o.type].label,l=a>0?e[a-1].data[o.type].label:null;if(!(a>0&&s===l)){for(var u=i;u<t.length;u++){var c=t[u];r.data[c.type].colspan=n[c.type],r.data[c.type].colspan>1&&(r.data[c.type].align="center",r.data[c.type].cell_style.push("merged")),n[c.type]=1}break}r.data[o.type].colspan=-1,r.data[o.type].rowspan=-1,n[o.type]+=1}}applyFormatting(){this.columns.forEach(e=>{var t=this.config["style|"+e.modelField.name];if(void 0!==t)switch(t){case"black_red":this.data.forEach(t=>{t.data[e.id].value<0&&t.data[e.id].cell_style.push("negative")})}})}transposeDimensionsIntoHeaders(){this.transposed_headers=this.columns.filter(e=>"dimension"===e.modelField.type).filter(e=>!e.hide).map(e=>({type:"field",modelField:e.modelField}))}transposeRowsIntoColumns(){var e={align:"left",type:"transposed_table_index",is_table_calculation:!1};this.headers.forEach((t,n)=>{var a=new m(t.type,this,e);this.transposed_headers.forEach((e,t)=>{var r=this.columns[t].levels[n],i=new u({column:a,type:r.type,label:r.label,cell_style:r.cell_style,align:r.align,modelField:r.modelField});i.rowspan=r.colspan,i.colspan=r.rowspan,i.id=[r.modelField.name,r.type].join("."),i.cell_style.push("transposed"),i.colspan>0&&i.cell_style.push("merged"),a.levels.push(i)}),this.transposed_columns.push(a)});var t={align:"right",type:"transposed_table_measure",is_table_calculation:!1};this.data.forEach(e=>{var n=new m(e.id,this,t);this.transposed_headers.forEach(t=>{var a=this.useIndexColumn&&["subtotal","total"].includes(e.type)?"$$$_index_$$$":t.modelField.name,r=e.data[a],i=new u({column:n,type:t.type,label:""===r.rendered?r.rendered:r.rendered||r.value,align:"center",cell_style:r.cell_style});i.colspan=r.rowspan,i.rowspan=r.colspan,i.id=[r.colid,r.rowid].join("."),i.cell_style.push("transposed"),n.levels.push(i)}),this.transposed_columns.push(n)})}transposeColumnsIntoRows(){this.columns.filter(e=>"measure"===e.modelField.type).forEach(e=>{var t={};e.levels.forEach((n,a)=>{var r=new f({value:n.label,rendered:n.label,rowspan:n.colspan,colspan:n.rowspan,cell_style:["indexCell","transposed"],align:"left",colid:e.id,rowid:n.type});switch(n.type){case"pivot0":case"pivot1":r.cell_style.push("pivot");break;case"heading":case"field":var i=e.modelField.is_table_calculation?"calculation":"measure";r.cell_style.push(i)}r.rowspan>1&&r.cell_style.push("merged"),t[n.type]=r}),this.data.forEach(n=>{if(void 0!==n.data[e.id]){var a=n.data[e.id];t[n.id]=n.data[e.id],t[n.id].id=[a.colid,a.rowid].join("."),t[n.id].cell_style.push("transposed")}});var n=new p("line_item");n.id=e.id,n.modelField=e.modelField,n.hide=e.hide,n.data=t,this.transposed_data.push(n)})}validateConfig(){["traditional","looker","contemporary","custom"].includes(this.config.theme)||(this.config.theme="traditional"),["fixed","auto"].includes(this.config.layout)||(this.config.layout="fixed"),void 0===this.config.transposeTable&&(this.config.transposeTable=!1),Object.entries(this.config).forEach(e=>{if("false"===e[1]?e[1]=!1:"true"===e[1]&&(e[1]=!0),2===e[0].split("|").length){var[t,n]=e[0].split("|");if(["label","heading","hide","style","switch","var_num","var_pct","comparison"].includes(t)){var a=!1;this.dimensions.forEach(e=>{e.name===n&&(a=!0)}),this.measures.forEach(e=>{e.name===n&&(a=!0)}),a||delete this.config[e[0]]}}})}getColumnById(e){var t={};return this.columns.forEach(n=>{e===n.id&&(t=n)}),t}getRowById(e){var t={};return this.data.forEach(n=>{e===n.id&&(t=n)}),t}getMeasureByName(e){var t="";return this.measures.forEach(n=>{e===n.name&&(t=n)}),t}getRenderedFromHtml(e){var t=new DOMParser;if(void 0===e.html||["undefined",""].includes(e.html))n=e.value;else try{var n=t.parseFromString(e.html,"text/html").documentElement.textContent}catch(t){var n=e.html}return n}getHeaderTiers(){return this.transposeTable?this.transposed_headers:this.headers}getTableHeaderCells(e){return this.transposeTable?this.transposed_columns.filter(t=>t.levels[e].colspan>0):this.columns.filter(e=>!e.hide).filter(t=>t.levels[e].colspan>0)}getDataRows(){if(this.transposeTable)e=this.transposed_data.filter(e=>!e.hide);else var e=this.data.filter(e=>!e.hide);return e}getTableRowColumns(e){if(this.transposeTable)t=this.transposed_columns.filter(e=>!e.hide).filter(t=>e.data[t.id].rowspan>0);else var t=this.columns.filter(e=>!e.hide).filter(t=>e.data[t.id].rowspan>0);return t}moveColumns(e,t,n){var a=this.config;if(e!=t){var r=t-e,i=a.columnOrder;this.columns.forEach(n=>{"measure"!=n.modelField.type||n.super||(n.pos>=e&&n.pos<e+10?n.pos+=r:n.pos>=t&&n.pos<e?n.pos+=10:n.pos>=e+10&&n.pos<t+10&&(n.pos-=10),i[n.id]=n.pos)}),n(i)}}getSimpleJson(){var e=[];return this.data.forEach(t=>{if("line_item"===t.type){var n={};this.columns.forEach(e=>{n[e.id]=t.data[e.id].value}),e.push(n)}}),e}getTableColumnGroups(){var e=[],t=[],n=[];this.transposeTable?this.transposed_columns.forEach(a=>{"transposed_table_index"===a.modelField.type?e.push({id:a.id,type:"index"}):"transposed_table_measure"===a.modelField.type&&"Total"!==a.id?t.push({id:a.id,type:"dataCell"}):"transposed_table_measure"===a.modelField.type&&"Total"===a.id&&n.push({id:a.id,type:"dataCell"})}):this.columns.forEach(a=>{"dimension"!==a.modelField.type||a.hide?"measure"!==a.modelField.type||a.isRowTotal||a.super||a.hide?"measure"!==a.modelField.type||!a.isRowTotal&&!a.super||a.hide||n.push({id:a.id,type:"dataCell"}):t.push({id:a.id,type:"dataCell"}):e.push({id:a.id,type:"index"})});var a=[];return e.length>0&&a.push(e),t.length>0&&a.push(t),n.length>0&&a.push(n),a}getCellToolTip(e,t){var n="<table><tbody>",a=this.getRowById(e),r=this.getColumnById(t),i=r.modelField;if("total"===a.type)n+=['<tr class="',s="focus",'"><td><span style="float:left"><em>',o="TOTAL",':</em></td><td></span><span style="float:left"> ',u="","</span></td></tr>"].join("");else if(a.id.startsWith("Others")){n+=['<tr class="',s="focus",'"><td><span style="float:left"><em>',o="Others",':</em></td><td></span><span style="float:left"> ',u="","</span></td></tr>"].join("")}else if("subtotal"===a.type){var o="SUBTOTAL",s="focus",l=this.columns.filter(e=>!e.hide).filter(e=>"dimension"===e.modelField.type)[0],u=a.data[l.id].render||a.data[l.id].value;n+=['<tr class="',s,'"><td><span style="float:left"><em>',o,':</em></td><td></span><span style="float:left"> ',u,"</span></td></tr>"].join("")}else{this.columns.filter(e=>"$$$_index_$$$"!==e.id).filter(e=>"dimension"===e.modelField.type).forEach(e=>{var t=e.getHeaderCellLabelByType("field"),i=a.data[e.id].rendered||a.data[e.id].value,o=e.id===r.id?"focus":"";n+=['<tr class="',o,'"><td><span style="float:left"><em>',t,':</em></td><td></span><span style="float:left"> ',i,"</span></td></tr>"].join("")})}n+='<tr style="height:10px"></tr>';var c=!1,d="";this.columns.filter(e=>"measure"===e.modelField.type).filter(e=>e.modelField===i).forEach(e=>{if(e.isVariance||(d=e.getHeaderCellLabelByType("field")),!e.pivoted&&!e.isRowTotal||e.pivot_key===r.pivot_key){var t=e.getHeaderCellLabelByType("field"),i=e.id===r.id?"focus":"",o=a.data[e.id],s=o.rendered||o.value;if(o.html)s=(new DOMParser).parseFromString(o.html,"text/html").documentElement.textContent;o.cell_style.includes("estimate")&&(c=!0),n+=['<tr class="',i,'"><td><span style="float:left"><em>',t,':</em></td><td></span><span style="float:right"> ',s,"</span></td></tr>"].join("")}});var h=null,f=this.config["reportIn|"+r.modelField.name];return void 0!==f&&"1"!==f&&(h=d+" reported in "+{1e3:"000s",1e6:"Millions",1e9:"Billions"}[f]),(h||c)&&(n+='<tr style="height:10px"></tr>'),h&&(n+='<tr><td colspan=2><span style="color:darkgrey">'+h+".</span></td></tr>"),c&&(n+='<tr><td colspan=2><span style="color:red">Estimated figure due to query exceeding row limit.</span></td></tr>',n+='<tr><td colspan=2><span style="color:red">Consider increasing the row limit or using an alternative measure.</span></td></tr>'),n+="</tbody><table>"}}function y(){}var b=function(e){return null==e?y:function(){return this.querySelector(e)}};function _(){return[]}var w=function(e){return null==e?_:function(){return this.querySelectorAll(e)}},x=function(e){return function(){return this.matches(e)}},C=function(e){return new Array(e.length)};function k(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}k.prototype={constructor:k,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function $(e,t,n,a,r,i){for(var o,s=0,l=t.length,u=i.length;s<u;++s)(o=t[s])?(o.__data__=i[s],a[s]=o):n[s]=new k(e,i[s]);for(;s<l;++s)(o=t[s])&&(r[s]=o)}function E(e,t,n,a,r,i,o){var s,l,u,c={},d=t.length,h=i.length,f=new Array(d);for(s=0;s<d;++s)(l=t[s])&&(f[s]=u="$"+o.call(l,l.__data__,s,t),u in c?r[s]=l:c[u]=l);for(s=0;s<h;++s)(l=c[u="$"+o.call(e,i[s],s,i)])?(a[s]=l,l.__data__=i[s],c[u]=null):n[s]=new k(e,i[s]);for(s=0;s<d;++s)(l=t[s])&&c[f[s]]===l&&(r[s]=l)}function S(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var F="http://www.w3.org/1999/xhtml",T={svg:"http://www.w3.org/2000/svg",xhtml:F,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},M=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),T.hasOwnProperty(t)?{space:T[t],local:e}:e};function A(e){return function(){this.removeAttribute(e)}}function O(e){return function(){this.removeAttributeNS(e.space,e.local)}}function N(e,t){return function(){this.setAttribute(e,t)}}function D(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function R(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function I(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}var H=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function j(e){return function(){this.style.removeProperty(e)}}function z(e,t,n){return function(){this.style.setProperty(e,t,n)}}function B(e,t,n){return function(){var a=t.apply(this,arguments);null==a?this.style.removeProperty(e):this.style.setProperty(e,a,n)}}function L(e,t){return e.style.getPropertyValue(t)||H(e).getComputedStyle(e,null).getPropertyValue(t)}function V(e){return function(){delete this[e]}}function P(e,t){return function(){this[e]=t}}function q(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function U(e){return e.trim().split(/^|\s+/)}function X(e){return e.classList||new G(e)}function G(e){this._node=e,this._names=U(e.getAttribute("class")||"")}function Y(e,t){for(var n=X(e),a=-1,r=t.length;++a<r;)n.add(t[a])}function J(e,t){for(var n=X(e),a=-1,r=t.length;++a<r;)n.remove(t[a])}function W(e){return function(){Y(this,e)}}function Z(e){return function(){J(this,e)}}function K(e,t){return function(){(t.apply(this,arguments)?Y:J)(this,e)}}G.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Q(){this.textContent=""}function ee(e){return function(){this.textContent=e}}function te(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function ne(){this.innerHTML=""}function ae(e){return function(){this.innerHTML=e}}function re(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ie(){this.nextSibling&&this.parentNode.appendChild(this)}function oe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function se(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===F&&t.documentElement.namespaceURI===F?t.createElement(e):t.createElementNS(n,e)}}function le(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var ue=function(e){var t=M(e);return(t.local?le:se)(t)};function ce(){return null}function de(){var e=this.parentNode;e&&e.removeChild(this)}function he(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}var pe={},me=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(pe={mouseenter:"mouseover",mouseleave:"mouseout"}));function ve(e,t,n){return e=ge(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function ge(e,t,n){return function(a){var r=me;me=a;try{e.call(this,this.__data__,t,n)}finally{me=r}}}function ye(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function be(e){return function(){var t=this.__on;if(t){for(var n,a=0,r=-1,i=t.length;a<i;++a)n=t[a],e.type&&n.type!==e.type||n.name!==e.name?t[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?t.length=r:delete this.__on}}}function _e(e,t,n){var a=pe.hasOwnProperty(e.type)?ve:ge;return function(r,i,o){var s,l=this.__on,u=a(t,i,o);if(l)for(var c=0,d=l.length;c<d;++c)if((s=l[c]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=t);this.addEventListener(e.type,u,n),s={type:e.type,name:e.name,value:t,listener:u,capture:n},l?l.push(s):this.__on=[s]}}function we(e,t,n,a){var r=me;e.sourceEvent=me,me=e;try{return t.apply(n,a)}finally{me=r}}function xe(e,t,n){var a=H(e),r=a.CustomEvent;"function"==typeof r?r=new r(t,n):(r=a.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Ce(e,t){return function(){return xe(this,e,t)}}function ke(e,t){return function(){return xe(this,e,t.apply(this,arguments))}}var $e=[null];function Ee(e,t){this._groups=e,this._parents=t}function Se(){return new Ee([[document.documentElement]],$e)}Ee.prototype=Se.prototype={constructor:Ee,select:function(e){"function"!=typeof e&&(e=b(e));for(var t=this._groups,n=t.length,a=new Array(n),r=0;r<n;++r)for(var i,o,s=t[r],l=s.length,u=a[r]=new Array(l),c=0;c<l;++c)(i=s[c])&&(o=e.call(i,i.__data__,c,s))&&("__data__"in i&&(o.__data__=i.__data__),u[c]=o);return new Ee(a,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=w(e));for(var t=this._groups,n=t.length,a=[],r=[],i=0;i<n;++i)for(var o,s=t[i],l=s.length,u=0;u<l;++u)(o=s[u])&&(a.push(e.call(o,o.__data__,u,s)),r.push(o));return new Ee(a,r)},filter:function(e){"function"!=typeof e&&(e=x(e));for(var t=this._groups,n=t.length,a=new Array(n),r=0;r<n;++r)for(var i,o=t[r],s=o.length,l=a[r]=[],u=0;u<s;++u)(i=o[u])&&e.call(i,i.__data__,u,o)&&l.push(i);return new Ee(a,this._parents)},data:function(e,t){if(!e)return p=new Array(this.size()),c=-1,this.each((function(e){p[++c]=e})),p;var n,a=t?E:$,r=this._parents,i=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var o=i.length,s=new Array(o),l=new Array(o),u=new Array(o),c=0;c<o;++c){var d=r[c],h=i[c],f=h.length,p=e.call(d,d&&d.__data__,c,r),m=p.length,v=l[c]=new Array(m),g=s[c]=new Array(m);a(d,h,v,g,u[c]=new Array(f),p,t);for(var y,b,_=0,w=0;_<m;++_)if(y=v[_]){for(_>=w&&(w=_+1);!(b=g[w])&&++w<m;);y._next=b||null}}return(s=new Ee(s,r))._enter=l,s._exit=u,s},enter:function(){return new Ee(this._enter||this._groups.map(C),this._parents)},exit:function(){return new Ee(this._exit||this._groups.map(C),this._parents)},join:function(e,t,n){var a=this.enter(),r=this,i=this.exit();return a="function"==typeof e?e(a):a.append(e+""),null!=t&&(r=t(r)),null==n?i.remove():n(i),a&&r?a.merge(r).order():r},merge:function(e){for(var t=this._groups,n=e._groups,a=t.length,r=n.length,i=Math.min(a,r),o=new Array(a),s=0;s<i;++s)for(var l,u=t[s],c=n[s],d=u.length,h=o[s]=new Array(d),f=0;f<d;++f)(l=u[f]||c[f])&&(h[f]=l);for(;s<a;++s)o[s]=t[s];return new Ee(o,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var a,r=e[t],i=r.length-1,o=r[i];--i>=0;)(a=r[i])&&(o&&4^a.compareDocumentPosition(o)&&o.parentNode.insertBefore(a,o),o=a);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=S);for(var n=this._groups,a=n.length,r=new Array(a),i=0;i<a;++i){for(var o,s=n[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(t)}return new Ee(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a=e[t],r=0,i=a.length;r<i;++r){var o=a[r];if(o)return o}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,a=t.length;n<a;++n)for(var r,i=t[n],o=0,s=i.length;o<s;++o)(r=i[o])&&e.call(r,r.__data__,o,i);return this},attr:function(e,t){var n=M(e);if(arguments.length<2){var a=this.node();return n.local?a.getAttributeNS(n.space,n.local):a.getAttribute(n)}return this.each((null==t?n.local?O:A:"function"==typeof t?n.local?I:R:n.local?D:N)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?j:"function"==typeof t?B:z)(e,t,null==n?"":n)):L(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?V:"function"==typeof t?q:P)(e,t)):this.node()[e]},classed:function(e,t){var n=U(e+"");if(arguments.length<2){for(var a=X(this.node()),r=-1,i=n.length;++r<i;)if(!a.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?K:t?W:Z)(n,t))},text:function(e){return arguments.length?this.each(null==e?Q:("function"==typeof e?te:ee)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ne:("function"==typeof e?re:ae)(e)):this.node().innerHTML},raise:function(){return this.each(ie)},lower:function(){return this.each(oe)},append:function(e){var t="function"==typeof e?e:ue(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:ue(e),a=null==t?ce:"function"==typeof t?t:b(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),a.apply(this,arguments)||null)}))},remove:function(){return this.each(de)},clone:function(e){return this.select(e?fe:he)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var a,r,i=ye(e+""),o=i.length;if(!(arguments.length<2)){for(s=t?_e:be,null==n&&(n=!1),a=0;a<o;++a)this.each(s(i[a],t,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(a=0,l=s[u];a<o;++a)if((r=i[a]).type===l.type&&r.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?ke:Ce)(e,t))}};var Fe=Se,Te=function(e){return"string"==typeof e?new Ee([[document.querySelector(e)]],[document.documentElement]):new Ee([[e]],$e)},Me=function(e){return"string"==typeof e?new Ee([document.querySelectorAll(e)],[document.documentElement]):new Ee([null==e?[]:e],$e)},Ae={value:function(){}};function Oe(){for(var e,t=0,n=arguments.length,a={};t<n;++t){if(!(e=arguments[t]+"")||e in a||/[\s.]/.test(e))throw new Error("illegal type: "+e);a[e]=[]}return new Ne(a)}function Ne(e){this._=e}function De(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",a=e.indexOf(".");if(a>=0&&(n=e.slice(a+1),e=e.slice(0,a)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function Re(e,t){for(var n,a=0,r=e.length;a<r;++a)if((n=e[a]).name===t)return n.value}function Ie(e,t,n){for(var a=0,r=e.length;a<r;++a)if(e[a].name===t){e[a]=Ae,e=e.slice(0,a).concat(e.slice(a+1));break}return null!=n&&e.push({name:t,value:n}),e}Ne.prototype=Oe.prototype={constructor:Ne,on:function(e,t){var n,a=this._,r=De(e+"",a),i=-1,o=r.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(n=(e=r[i]).type)a[n]=Ie(a[n],e.name,t);else if(null==t)for(n in a)a[n]=Ie(a[n],e.name,null);return this}for(;++i<o;)if((n=(e=r[i]).type)&&(n=Re(a[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ne(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,a,r=new Array(n),i=0;i<n;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(a=this._[e]).length;i<n;++i)a[i].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)}};var He,je,ze=Oe,Be=0,Le=0,Ve=0,Pe=0,qe=0,Ue=0,Xe="object"==typeof performance&&performance.now?performance:Date,Ge="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ye(){return qe||(Ge(Je),qe=Xe.now()+Ue)}function Je(){qe=0}function We(){this._call=this._time=this._next=null}function Ze(e,t,n){var a=new We;return a.restart(e,t,n),a}function Ke(){qe=(Pe=Xe.now())+Ue,Be=Le=0;try{!function(){Ye(),++Be;for(var e,t=He;t;)(e=qe-t._time)>=0&&t._call.call(null,e),t=t._next;--Be}()}finally{Be=0,function(){var e,t,n=He,a=1/0;for(;n;)n._call?(a>n._time&&(a=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:He=t);je=e,et(a)}(),qe=0}}function Qe(){var e=Xe.now(),t=e-Pe;t>1e3&&(Ue-=t,Pe=e)}function et(e){Be||(Le&&(Le=clearTimeout(Le)),e-qe>24?(e<1/0&&(Le=setTimeout(Ke,e-Xe.now()-Ue)),Ve&&(Ve=clearInterval(Ve))):(Ve||(Pe=Xe.now(),Ve=setInterval(Qe,1e3)),Be=1,Ge(Ke)))}We.prototype=Ze.prototype={constructor:We,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?Ye():+n)+(null==t?0:+t),this._next||je===this||(je?je._next=this:He=this,je=this),this._call=e,this._time=n,et()},stop:function(){this._call&&(this._call=null,this._time=1/0,et())}};var tt=function(e,t,n){var a=new We;return t=null==t?0:+t,a.restart((function(n){a.stop(),e(n+t)}),t,n),a},nt=ze("start","end","cancel","interrupt"),at=[],rt=function(e,t,n,a,r,i){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var a,r=e.__transition;function i(l){var u,c,d,h;if(1!==n.state)return s();for(u in r)if((h=r[u]).name===n.name){if(3===h.state)return tt(i);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(tt((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(l))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,a=new Array(d=n.tween.length),u=0,c=-1;u<d;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(a[++c]=h);a.length=c+1}}function o(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),i=-1,o=a.length;++i<o;)a[i].call(e,r);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var a in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}r[t]=n,n.timer=Ze((function(e){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=e&&i(e-n.delay)}),0,n.time)}(e,n,{name:t,index:a,group:r,on:nt,tween:at,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})};function it(e,t){var n=st(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function ot(e,t){var n=st(e,t);if(n.state>3)throw new Error("too late; already running");return n}function st(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var lt,ut,ct,dt,ht=function(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}},ft=180/Math.PI,pt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},mt=function(e,t,n,a,r,i){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*a)&&(n-=e*l,a-=t*l),(s=Math.sqrt(n*n+a*a))&&(n/=s,a/=s,l/=s),e*a<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*ft,skewX:Math.atan(l)*ft,scaleX:o,scaleY:s}};function vt(e,t,n,a){function r(e){return e.length?e.pop()+" ":""}return function(i,o){var s=[],l=[];return i=e(i),o=e(o),function(e,a,r,i,o,s){if(e!==r||a!==i){var l=o.push("translate(",null,t,null,n);s.push({i:l-4,x:ht(e,r)},{i:l-2,x:ht(a,i)})}else(r||i)&&o.push("translate("+r+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,s,l),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(r(n)+"rotate(",null,a)-2,x:ht(e,t)})):t&&n.push(r(n)+"rotate("+t+a)}(i.rotate,o.rotate,s,l),function(e,t,n,i){e!==t?i.push({i:n.push(r(n)+"skewX(",null,a)-2,x:ht(e,t)}):t&&n.push(r(n)+"skewX("+t+a)}(i.skewX,o.skewX,s,l),function(e,t,n,a,i,o){if(e!==n||t!==a){var s=i.push(r(i)+"scale(",null,",",null,")");o.push({i:s-4,x:ht(e,n)},{i:s-2,x:ht(t,a)})}else 1===n&&1===a||i.push(r(i)+"scale("+n+","+a+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,s,l),i=o=null,function(e){for(var t,n=-1,a=l.length;++n<a;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var gt=vt((function(e){return"none"===e?pt:(lt||(lt=document.createElement("DIV"),ut=document.documentElement,ct=document.defaultView),lt.style.transform=e,e=ct.getComputedStyle(ut.appendChild(lt),null).getPropertyValue("transform"),ut.removeChild(lt),e=e.slice(7,-1).split(","),mt(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}),"px, ","px)","deg)"),yt=vt((function(e){return null==e?pt:(dt||(dt=document.createElementNS("http://www.w3.org/2000/svg","g")),dt.setAttribute("transform",e),(e=dt.transform.baseVal.consolidate())?(e=e.matrix,mt(e.a,e.b,e.c,e.d,e.e,e.f)):pt)}),", ",")",")");function bt(e,t){var n,a;return function(){var r=ot(this,e),i=r.tween;if(i!==n)for(var o=0,s=(a=n=i).length;o<s;++o)if(a[o].name===t){(a=a.slice()).splice(o,1);break}r.tween=a}}function _t(e,t,n){var a,r;if("function"!=typeof n)throw new Error;return function(){var i=ot(this,e),o=i.tween;if(o!==a){r=(a=o).slice();for(var s={name:t,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===t){r[l]=s;break}l===u&&r.push(s)}i.tween=r}}function wt(e,t,n){var a=e._id;return e.each((function(){var e=ot(this,a);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return st(e,a).value[t]}}var xt=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function Ct(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function kt(){}var $t="\\s*([+-]?\\d+)\\s*",Et="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",St="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ft=/^#([0-9a-f]{3,8})$/,Tt=new RegExp("^rgb\\("+[$t,$t,$t]+"\\)$"),Mt=new RegExp("^rgb\\("+[St,St,St]+"\\)$"),At=new RegExp("^rgba\\("+[$t,$t,$t,Et]+"\\)$"),Ot=new RegExp("^rgba\\("+[St,St,St,Et]+"\\)$"),Nt=new RegExp("^hsl\\("+[Et,St,St]+"\\)$"),Dt=new RegExp("^hsla\\("+[Et,St,St,Et]+"\\)$"),Rt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function It(){return this.rgb().formatHex()}function Ht(){return this.rgb().formatRgb()}function jt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ft.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?zt(t):3===n?new Pt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Bt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Bt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Tt.exec(e))?new Pt(t[1],t[2],t[3],1):(t=Mt.exec(e))?new Pt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=At.exec(e))?Bt(t[1],t[2],t[3],t[4]):(t=Ot.exec(e))?Bt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Nt.exec(e))?Gt(t[1],t[2]/100,t[3]/100,1):(t=Dt.exec(e))?Gt(t[1],t[2]/100,t[3]/100,t[4]):Rt.hasOwnProperty(e)?zt(Rt[e]):"transparent"===e?new Pt(NaN,NaN,NaN,0):null}function zt(e){return new Pt(e>>16&255,e>>8&255,255&e,1)}function Bt(e,t,n,a){return a<=0&&(e=t=n=NaN),new Pt(e,t,n,a)}function Lt(e){return e instanceof kt||(e=jt(e)),e?new Pt((e=e.rgb()).r,e.g,e.b,e.opacity):new Pt}function Vt(e,t,n,a){return 1===arguments.length?Lt(e):new Pt(e,t,n,null==a?1:a)}function Pt(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function qt(){return"#"+Xt(this.r)+Xt(this.g)+Xt(this.b)}function Ut(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function Xt(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Gt(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Jt(e,t,n,a)}function Yt(e){if(e instanceof Jt)return new Jt(e.h,e.s,e.l,e.opacity);if(e instanceof kt||(e=jt(e)),!e)return new Jt;if(e instanceof Jt)return e;var t=(e=e.rgb()).r/255,n=e.g/255,a=e.b/255,r=Math.min(t,n,a),i=Math.max(t,n,a),o=NaN,s=i-r,l=(i+r)/2;return s?(o=t===i?(n-a)/s+6*(n<a):n===i?(a-t)/s+2:(t-n)/s+4,s/=l<.5?i+r:2-i-r,o*=60):s=l>0&&l<1?0:o,new Jt(o,s,l,e.opacity)}function Jt(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function Wt(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Zt(e,t,n,a,r){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*a+o*r)/6}xt(kt,jt,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:It,formatHex:It,formatHsl:function(){return Yt(this).formatHsl()},formatRgb:Ht,toString:Ht}),xt(Pt,Vt,Ct(kt,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Pt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qt,formatHex:qt,formatRgb:Ut,toString:Ut})),xt(Jt,(function(e,t,n,a){return 1===arguments.length?Yt(e):new Jt(e,t,n,null==a?1:a)}),Ct(kt,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Jt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Jt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,r=2*n-a;return new Pt(Wt(e>=240?e-240:e+120,r,a),Wt(e,r,a),Wt(e<120?e+240:e-120,r,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var Kt=function(e){return function(){return e}};function Qt(e,t){return function(n){return e+n*t}}function en(e){return 1==(e=+e)?tn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}(t,n,e):Kt(isNaN(t)?n:t)}}function tn(e,t){var n=t-e;return n?Qt(e,n):Kt(isNaN(e)?t:e)}var nn=function e(t){var n=en(t);function a(e,t){var a=n((e=Vt(e)).r,(t=Vt(t)).r),r=n(e.g,t.g),i=n(e.b,t.b),o=tn(e.opacity,t.opacity);return function(t){return e.r=a(t),e.g=r(t),e.b=i(t),e.opacity=o(t),e+""}}return a.gamma=e,a}(1);function an(e){return function(t){var n,a,r=t.length,i=new Array(r),o=new Array(r),s=new Array(r);for(n=0;n<r;++n)a=Vt(t[n]),i[n]=a.r||0,o[n]=a.g||0,s[n]=a.b||0;return i=e(i),o=e(o),s=e(s),a.opacity=1,function(e){return a.r=i(e),a.g=o(e),a.b=s(e),a+""}}}an((function(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[a],i=e[a+1],o=a>0?e[a-1]:2*r-i,s=a<t-1?e[a+2]:2*i-r;return Zt((n-a/t)*t,o,r,i,s)}})),an((function(e){var t=e.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*t),r=e[(a+t-1)%t],i=e[a%t],o=e[(a+1)%t],s=e[(a+2)%t];return Zt((n-a/t)*t,r,i,o,s)}}));var rn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(rn.source,"g");var sn=function(e,t){var n,a,r,i=rn.lastIndex=on.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=rn.exec(e))&&(a=on.exec(t));)(r=a.index)>i&&(r=t.slice(i,r),s[o]?s[o]+=r:s[++o]=r),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,l.push({i:o,x:ht(n,a)})),i=on.lastIndex;return i<t.length&&(r=t.slice(i),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,a=0;a<t;++a)s[(n=l[a]).i]=n.x(e);return s.join("")})},ln=function(e,t){var n;return("number"==typeof t?ht:t instanceof jt?nn:(n=jt(t))?(t=n,nn):sn)(e,t)};function un(e){return function(){this.removeAttribute(e)}}function cn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function dn(e,t,n){var a,r,i=n+"";return function(){var o=this.getAttribute(e);return o===i?null:o===a?r:r=t(a=o,n)}}function hn(e,t,n){var a,r,i=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===a?r:r=t(a=o,n)}}function fn(e,t,n){var a,r,i;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(e))===(s=l+"")?null:o===a&&s===r?i:(r=s,i=t(a=o,l));this.removeAttribute(e)}}function pn(e,t,n){var a,r,i;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:o===a&&s===r?i:(r=s,i=t(a=o,l));this.removeAttributeNS(e.space,e.local)}}function mn(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function vn(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function gn(e,t){var n,a;function r(){var r=t.apply(this,arguments);return r!==a&&(n=(a=r)&&vn(e,r)),n}return r._value=t,r}function yn(e,t){var n,a;function r(){var r=t.apply(this,arguments);return r!==a&&(n=(a=r)&&mn(e,r)),n}return r._value=t,r}function bn(e,t){return function(){it(this,e).delay=+t.apply(this,arguments)}}function _n(e,t){return t=+t,function(){it(this,e).delay=t}}function wn(e,t){return function(){ot(this,e).duration=+t.apply(this,arguments)}}function xn(e,t){return t=+t,function(){ot(this,e).duration=t}}function Cn(e,t){if("function"!=typeof t)throw new Error;return function(){ot(this,e).ease=t}}function kn(e,t,n){var a,r,i=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?it:ot;return function(){var o=i(this,e),s=o.on;s!==a&&(r=(a=s).copy()).on(t,n),o.on=r}}var $n=Fe.prototype.constructor;function En(e){return function(){this.style.removeProperty(e)}}function Sn(e,t,n){return function(a){this.style.setProperty(e,t.call(this,a),n)}}function Fn(e,t,n){var a,r;function i(){var i=t.apply(this,arguments);return i!==r&&(a=(r=i)&&Sn(e,i,n)),a}return i._value=t,i}function Tn(e){return function(t){this.textContent=e.call(this,t)}}function Mn(e){var t,n;function a(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Tn(a)),t}return a._value=e,a}var An=0;function On(e,t,n,a){this._groups=e,this._parents=t,this._name=n,this._id=a}function Nn(){return++An}var Dn=Fe.prototype;On.prototype=function(e){return Fe().transition(e)}.prototype={constructor:On,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=b(e));for(var a=this._groups,r=a.length,i=new Array(r),o=0;o<r;++o)for(var s,l,u=a[o],c=u.length,d=i[o]=new Array(c),h=0;h<c;++h)(s=u[h])&&(l=e.call(s,s.__data__,h,u))&&("__data__"in s&&(l.__data__=s.__data__),d[h]=l,rt(d[h],t,n,h,d,st(s,n)));return new On(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=w(e));for(var a=this._groups,r=a.length,i=[],o=[],s=0;s<r;++s)for(var l,u=a[s],c=u.length,d=0;d<c;++d)if(l=u[d]){for(var h,f=e.call(l,l.__data__,d,u),p=st(l,n),m=0,v=f.length;m<v;++m)(h=f[m])&&rt(h,t,n,m,f,p);i.push(f),o.push(l)}return new On(i,o,t,n)},filter:function(e){"function"!=typeof e&&(e=x(e));for(var t=this._groups,n=t.length,a=new Array(n),r=0;r<n;++r)for(var i,o=t[r],s=o.length,l=a[r]=[],u=0;u<s;++u)(i=o[u])&&e.call(i,i.__data__,u,o)&&l.push(i);return new On(a,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,a=t.length,r=n.length,i=Math.min(a,r),o=new Array(a),s=0;s<i;++s)for(var l,u=t[s],c=n[s],d=u.length,h=o[s]=new Array(d),f=0;f<d;++f)(l=u[f]||c[f])&&(h[f]=l);for(;s<a;++s)o[s]=t[s];return new On(o,this._parents,this._name,this._id)},selection:function(){return new $n(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Nn(),a=this._groups,r=a.length,i=0;i<r;++i)for(var o,s=a[i],l=s.length,u=0;u<l;++u)if(o=s[u]){var c=st(o,t);rt(o,e,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new On(a,this._parents,e,n)},call:Dn.call,nodes:Dn.nodes,node:Dn.node,size:Dn.size,empty:Dn.empty,each:Dn.each,on:function(e,t){var n=this._id;return arguments.length<2?st(this.node(),n).on.on(e):this.each(kn(n,e,t))},attr:function(e,t){var n=M(e),a="transform"===n?yt:ln;return this.attrTween(e,"function"==typeof t?(n.local?pn:fn)(n,a,wt(this,"attr."+e,t)):null==t?(n.local?cn:un)(n):(n.local?hn:dn)(n,a,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var a=M(e);return this.tween(n,(a.local?gn:yn)(a,t))},style:function(e,t,n){var a="transform"==(e+="")?gt:ln;return null==t?this.styleTween(e,function(e,t){var n,a,r;return function(){var i=L(this,e),o=(this.style.removeProperty(e),L(this,e));return i===o?null:i===n&&o===a?r:r=t(n=i,a=o)}}(e,a)).on("end.style."+e,En(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var a,r,i;return function(){var o=L(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=L(this,e)),o===l?null:o===a&&l===r?i:(r=l,i=t(a=o,s))}}(e,a,wt(this,"style."+e,t))).each(function(e,t){var n,a,r,i,o="style."+t,s="end."+o;return function(){var l=ot(this,e),u=l.on,c=null==l.value[o]?i||(i=En(t)):void 0;u===n&&r===c||(a=(n=u).copy()).on(s,r=c),l.on=a}}(this._id,e)):this.styleTween(e,function(e,t,n){var a,r,i=n+"";return function(){var o=L(this,e);return o===i?null:o===a?r:r=t(a=o,n)}}(e,a,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var a="style."+(e+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(null==t)return this.tween(a,null);if("function"!=typeof t)throw new Error;return this.tween(a,Fn(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(wt(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,Mn(e))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var a,r=st(this.node(),n).tween,i=0,o=r.length;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((null==t?bt:_t)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?bn:_n)(t,e)):st(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?wn:xn)(t,e)):st(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(Cn(t,e)):st(this.node(),t).ease},end:function(){var e,t,n=this,a=n._id,r=n.size();return new Promise((function(i,o){var s={value:o},l={value:function(){0==--r&&i()}};n.each((function(){var n=ot(this,a),r=n.on;r!==e&&((t=(e=r).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t}))}))}};var Rn={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function In(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))return Rn.time=Ye(),Rn;return n}Fe.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,a,r,i=e.__transition,o=!0;if(i){for(r in t=null==t?null:t+"",i)(n=i[r]).name===t?(a=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[r]):o=!1;o&&delete e.__transition}}(this,e)}))},Fe.prototype.transition=function(e){var t,n;e instanceof On?(t=e._id,e=e._name):(t=Nn(),(n=Rn).time=Ye(),e=null==e?null:e+"");for(var a=this._groups,r=a.length,i=0;i<r;++i)for(var o,s=a[i],l=s.length,u=0;u<l;++u)(o=s[u])&&rt(o,e,t,u,s,n||In(o,t));return new On(a,this._parents,e,t)};var Hn=function(){for(var e,t=me;e=t.sourceEvent;)t=e;return t},jn=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var a=n.createSVGPoint();return a.x=t.clientX,a.y=t.clientY,[(a=a.matrixTransform(e.getScreenCTM().inverse())).x,a.y]}var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]},zn=function(e){var t=Hn();return t.changedTouches&&(t=t.changedTouches[0]),jn(e,t)},Bn=function(e,t,n){arguments.length<3&&(n=t,t=Hn().changedTouches);for(var a,r=0,i=t?t.length:0;r<i;++r)if((a=t[r]).identifier===n)return jn(e,a);return null};function Ln(){me.stopImmediatePropagation()}var Vn=function(){me.preventDefault(),me.stopImmediatePropagation()},Pn=function(e){var t=e.document.documentElement,n=Te(e).on("dragstart.drag",Vn,!0);"onselectstart"in t?n.on("selectstart.drag",Vn,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")};var qn=function(e){return function(){return e}};function Un(e,t,n,a,r,i,o,s,l,u){this.target=e,this.type=t,this.subject=n,this.identifier=a,this.active=r,this.x=i,this.y=o,this.dx=s,this.dy=l,this._=u}function Xn(){return!me.ctrlKey&&!me.button}function Gn(){return this.parentNode}function Yn(e){return null==e?{x:me.x,y:me.y}:e}function Jn(){return navigator.maxTouchPoints||"ontouchstart"in this}Un.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Wn=function(){var e,t,n,a,r=Xn,i=Gn,o=Yn,s=Jn,l={},u=ze("start","drag","end"),c=0,d=0;function h(e){e.on("mousedown.drag",f).filter(s).on("touchstart.drag",v).on("touchmove.drag",g).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){if(!a&&r.apply(this,arguments)){var o=b("mouse",i.apply(this,arguments),zn,this,arguments);o&&(Te(me.view).on("mousemove.drag",p,!0).on("mouseup.drag",m,!0),Pn(me.view),Ln(),n=!1,e=me.clientX,t=me.clientY,o("start"))}}function p(){if(Vn(),!n){var a=me.clientX-e,r=me.clientY-t;n=a*a+r*r>d}l.mouse("drag")}function m(){var e,t,a,r;Te(me.view).on("mousemove.drag mouseup.drag",null),e=me.view,t=n,a=e.document.documentElement,r=Te(e).on("dragstart.drag",null),t&&(r.on("click.drag",Vn,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in a?r.on("selectstart.drag",null):(a.style.MozUserSelect=a.__noselect,delete a.__noselect),Vn(),l.mouse("end")}function v(){if(r.apply(this,arguments)){var e,t,n=me.changedTouches,a=i.apply(this,arguments),o=n.length;for(e=0;e<o;++e)(t=b(n[e].identifier,a,Bn,this,arguments))&&(Ln(),t("start"))}}function g(){var e,t,n=me.changedTouches,a=n.length;for(e=0;e<a;++e)(t=l[n[e].identifier])&&(Vn(),t("drag"))}function y(){var e,t,n=me.changedTouches,r=n.length;for(a&&clearTimeout(a),a=setTimeout((function(){a=null}),500),e=0;e<r;++e)(t=l[n[e].identifier])&&(Ln(),t("end"))}function b(e,t,n,a,r){var i,s,d,f=n(t,e),p=u.copy();if(we(new Un(h,"beforestart",i,e,c,f[0],f[1],0,0,p),(function(){return null!=(me.subject=i=o.apply(a,r))&&(s=i.x-f[0]||0,d=i.y-f[1]||0,!0)})))return function o(u){var m,v=f;switch(u){case"start":l[e]=o,m=c++;break;case"end":delete l[e],--c;case"drag":f=n(t,e),m=c}we(new Un(h,u,i,e,m,f[0]+s,f[1]+d,f[0]-v[0],f[1]-v[1],p),p.apply,p,[u,a,r])}}return h.filter=function(e){return arguments.length?(r="function"==typeof e?e:qn(!!e),h):r},h.container=function(e){return arguments.length?(i="function"==typeof e?e:qn(e),h):i},h.subject=function(e){return arguments.length?(o="function"==typeof e?e:qn(e),h):o},h.touchable=function(e){return arguments.length?(s="function"==typeof e?e:qn(!!e),h):s},h.on=function(){var e=u.on.apply(u,arguments);return e===u?h:e},h.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,h):Math.sqrt(d)},h};const Zn={traditional:n(8),looker:n(10),contemporary:n(12),fixed:n(14),auto:n(16)},Kn=["https://fonts.googleapis.com/css?family=Noto+Sans+SC","https://fonts.googleapis.com/css?family=Noto+Sans+TC"],Qn=function(e){const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t)},ea=function(e,t,n,a){var r=null;const i=a.getBoundingClientRect(),o=i.x+i.width/2,s=i.y+i.height/2;(async function(){const e=document.getElementsByTagName("link");for(;e[0];)e[0].parentNode.removeChild(e[0]);Object.keys(Zn).forEach(async e=>await Zn[e].unuse())})().then(()=>{void 0!==e.customTheme&&e.customTheme&&"custom"===e.theme?Qn(e.customTheme):void 0!==Zn[e.theme]&&Zn[e.theme].use(),void 0!==Zn[e.layout]&&Zn[e.layout].use()});(async function(){const a=function(t,n=""){var r=(a.canvas||(a.canvas=document.createElement("canvas"))).getContext("2d");return r.font=n||e.bodyFontSize+"pt arial",r.measureText(t).width};var i=Te("#visContainer").append("table").attr("id","reportTable").attr("class","reportTable").style("opacity",0),l=Wn().on("start",(e,n)=>{if(!t.has_pivots&&1===e.colspan){var a=parseFloat(me.x),r=parseFloat(me.y),i=e.column.getHeaderCellLabelByType("field");Te("#tooltip").style("left",a+"px").style("top",r+"px").html(i),Te("#tooltip").classed("hidden",!1)}}).on("drag",(e,n)=>{t.has_pivots||Te("#tooltip").style("left",me.x+"px").style("top",me.y+"px")}).on("end",(e,a)=>{if(!t.has_pivots){Te("#tooltip").classed("hidden",!0);var i=e.column,o=r.column,s=10*Math.floor(i.pos/10),l=10*Math.floor(o.pos/10);t.moveColumns(s,l,n)}});if(t.minWidthForIndexColumns){var u={};t.transposeTable?t.headers.forEach(n=>{var r="bold "+e.bodyFontSize+"pt arial",i=t.transposed_data.map(e=>e.data[n.type].rendered).reduce((e,t)=>Math.max(a(e,r),a(t,r)));u[n.type]=Math.ceil(i)}):t.column_series.filter(e=>!e.column.hide).filter(e=>"dimension"===e.column.modelField.type).forEach(e=>{var n=e.series.values.reduce((e,t)=>Math.max(a(e),a(t))),r=e.column.modelField.name;t.useIndexColumn&&(r="$$$_index_$$$",n+=15),u[r]=Math.ceil(n)})}i.selectAll("colgroup").data(t.getTableColumnGroups()).enter().append("colgroup").selectAll("col").data(e=>e).enter().append("col").attr("id",e=>["col",e.id].join("").replace(".","")).attr("span",1).style("width",e=>t.minWidthForIndexColumns&&"index"===e.type&&void 0!==u[e.id]?u[e.id]+"px":""),i.append("thead").selectAll("tr").data(t.getHeaderTiers()).enter().append("tr").selectAll("th").data((e,n)=>t.getTableHeaderCells(n).map(e=>e.levels[n])).enter().append("th").text(e=>e.label).attr("id",e=>e.id).attr("colspan",e=>e.colspan).attr("rowspan",e=>e.rowspan).attr("class",e=>{var t=["reportTable"];return void 0!==e.cell_style&&(t=t.concat(e.cell_style)),t.join(" ")}).style("text-align",e=>e.align).style("font-size",e.headerFontSize+"px").attr("draggable",!0).call(l).on("mouseover",e=>r=e).on("mouseout",()=>r=null),i.append("tbody").selectAll("tr").data(t.getDataRows()).enter().append("tr").on("mouseover",(function(){t.showHighlight&&this.classList.toggle("hover")})).on("mouseout",(function(){t.showHighlight&&this.classList.toggle("hover")})).selectAll("td").data(e=>t.getTableRowColumns(e).map(t=>e.data[t.id])).enter().append("td").text(e=>{var t="";if(Array.isArray(e.value))t=null!==e.rendered?e.rendered:e.value.join(" ");else if("object"==typeof e.value&&null!==e.value&&void 0!==e.value.series)t=null;else if(e.html){t=(new DOMParser).parseFromString(e.html,"text/html").documentElement.textContent}else t=e.rendered||""===e.rendered?e.rendered:e.value;return(t=String(t))?t.replace("-","‑"):t}).attr("rowspan",e=>e.rowspan).attr("colspan",e=>e.colspan).style("text-align",e=>e.align).style("font-size",e.bodyFontSize+"px").attr("class",e=>{var t=["reportTable"];return"object"==typeof e.value&&t.push("cellSeries"),void 0!==e.align&&t.push(e.align),void 0!==e.cell_style&&(t=t.concat(e.cell_style)),t.join(" ")}).on("mouseover",e=>{if(t.showHighlight){if(t.transposeTable)n=["col",e.rowid].join("").replace(".","");else var n=["col",e.colid].join("").replace(".","");document.getElementById(n).classList.toggle("hover")}if(t.showTooltip&&e.cell_style.includes("measure")){var a=me.clientX,r=me.clientY,i=t.getCellToolTip(e.rowid,e.colid);Te("#tooltip").style("left",a+"px").style("top",r+"px").html(i),Te("#tooltip").classed("hidden",!1)}}).on("mousemove",e=>{if(t.showTooltip&&e.cell_style.includes("measure")){var n=Te("#tooltip"),a=me.clientX<o?me.pageX+10:me.pageX-n.node().getBoundingClientRect().width-10,r=me.clientY<s?me.pageY+10:me.pageY-n.node().getBoundingClientRect().height-10;n.style("left",a+"px").style("top",r+"px")}}).on("mouseout",e=>{if(t.showHighlight){if(t.transposeTable)n=["col",e.rowid].join("").replace(".","");else var n=["col",e.colid].join("").replace(".","");document.getElementById(n).classList.toggle("hover")}t.showTooltip&&e.cell_style.includes("measure")&&Te("#tooltip").classed("hidden",!0)}).on("click",e=>{LookerCharts.Utils.openDrillMenu({links:e.links,event:me})})})().then(()=>{document.getElementById("reportTable").classList.add("reveal"),"animate"===e.customTheme?(document.getElementById("visSvg").classList.remove("hidden"),async function(){var t=document.getElementById("reportTable").clientWidth,n=document.getElementById("reportTable").clientHeight,a=[];Me("th").select((function(t,n){if(void 0!==t){var r=this.getBoundingClientRect();a.push({index:n,data:t,x:r.x-10,y:r.y-10,width:r.width,height:r.height,html:this.innerHTML,class:this.className+" rectElem animated",fontSize:e.headerFontSize,align:this.style.textAlign})}})),Me("td").select((function(t,n){if(void 0!==t){var r=this.getBoundingClientRect();a.push({index:n,data:t,x:r.x-10,y:r.y-10,width:r.width,height:r.height,html:this.innerHTML,class:this.className+" rectElem animated",fontSize:e.bodyFontSize,align:this.style.textAlign})}}));Te("#visSvg").attr("width",t).attr("height",n).selectAll(".rectElem").data(a,e=>e.data.id).join(e=>e.append("div").attr("class",e=>e.class).style("opacity",.2).style("position","absolute").style("left",e=>e.x+"px").style("top",e=>-2e3).style("width",e=>e.width+"px").style("height",e=>e.height+"px").style("font-size",e=>e.fontSize+"px").style("text-align",e=>e.align).text(e=>e.html).call(e=>e.transition().duration(1e3).style("opacity",1).style("top",e=>e.y+"px")),e=>e.call(e=>e.transition().duration(1e3).attr("class",e=>e.class).style("opacity",1).style("left",e=>e.x+"px").style("top",e=>e.y+"px").style("width",e=>e.width+"px").style("height",e=>e.height+"px").style("font-size",e=>e.fontSize+"px").style("text-align",e=>e.align).text(e=>e.html)),e=>e.call(e=>e.transition().duration(500).style("opacity",0).remove()))}()):(document.getElementById("visSvg").classList.add("hidden"),document.getElementById("reportTable").style.opacity=1)})};looker.plugins.visualizations.add({options:function(){let e=g.getCoreConfigOptions();return e.theme.values.pop(),delete e.customTheme,e}(),create:function(e,t){this.svgContainer=Te(e).append("div").attr("id","visSvg").attr("width",e.clientWidth).attr("height",e.clientHeight),this.tooltip=Te(e).append("div").attr("id","tooltip").attr("class","hidden")},updateAsync:function(e,t,n,a,r,i){if(this.clearErrors(),a.fields.pivots.length>2)this.addError({title:"Max Two Pivots",message:"This visualization accepts no more than 2 pivot fields."});else{console.log("queryResponse",a);try{var o=document.querySelector("#visContainer");o.parentNode.removeChild(o)}catch(e){}this.container=Te(t).append("div").attr("id","visContainer"),void 0===n.columnOrder&&this.trigger("updateConfig",[{columnOrder:{}}]);var s=new g(e,a,n);this.trigger("registerOptions",s.getConfigOptions()),ea(n,s,e=>{this.trigger("updateConfig",[{columnOrder:e}])},t),r.print&&Kn.forEach(e=>Qn(e)),console.log("dataTable",s),i()}}})}]);
//# sourceMappingURL=report_table.js.map